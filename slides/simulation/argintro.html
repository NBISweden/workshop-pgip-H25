<!DOCTYPE html>
<html lang="en"><head>
<link href="../../assets/logos/nbislogo-green.svg" rel="icon" type="image/svg+xml">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-541d1840fe0299ec4c9bf9ceaf6b9fb6.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/quarto-contrib/reveal-logo-1.0.0/reveal-logo.js" defer="true"></script>
<link href="../../site_libs/quarto-contrib/reveal-logo-1.0.0/reveal-logo.css" rel="stylesheet">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.33">

  <meta name="author" content="Per Unneberg">
  <title>Population Genomics in Practice 2025 – Ancestral recombination graph inference</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-dd75e976e0414ec343b1912506d158bc.css">
  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
  
  <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Ancestral recombination graph inference</h1>
  <p class="subtitle">Inferring tree sequences for population genomics</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Per Unneberg 
</div>
</div>
</div>

</section>
<section id="what-are-ancestral-recombination-graphs" class="slide level2 ultitle">
<h2>What are Ancestral Recombination Graphs?</h2>
<div style="text-align: center;">
<div class="three_column_grid">
<div>
<p><a href="../../slides/simulation/assets/images/darwin_I_think.webp" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img data-src="../../slides/simulation/assets/images/darwin_I_think.webp" height="450"></a></p>
</div>
<div>
<p><a href="../../slides/simulation/assets/images/haeckel_tree.webp" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img data-src="../../slides/simulation/assets/images/haeckel_tree.webp" height="450"></a></p>
</div>
<div>
<p><a href="../../slides/simulation/assets/images/halanych_2004.webp" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img data-src="../../slides/simulation/assets/images/halanych_2004.webp" height="370"></a></p>
<div class="flushright smallest">
<p><span class="citation" data-cites="halanych_NewViewAnimal_2004">Halanych (<a href="#/bibliography" role="doc-biblioref" onclick="">2004</a>)</span></p>
</div>
</div>
</div>
<p>Trees are everywhere in biology…</p>
<div class="fragment">
<p>… an ARG (recombinant genealogy) is a generalisation of an evolutionary tree</p>
</div>
</div>
<aside class="notes">
<p>Metazoa figure: Halanych (2004): The new view of animal phylogeny</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="the-coalescent-with-recombination" class="slide level2 ultitle">
<h2>The coalescent with recombination</h2>
<div class="columns">
<div class="column" style="width:50%;">
<h4 id="no-recombination">No recombination</h4>
<p><img data-src="../../slides/simulation/assets/images/norecomb.svg" class="quarto-figure quarto-figure-center" height="400" alt="No recombination"><br>
</p>
</div><div class="column" style="width:50%;">
<h4 id="with-recombination">With recombination</h4>
<p><img data-src="../../slides/simulation/assets/images/recomb.svg" class="quarto-figure quarto-figure-center" height="400" alt="With recombination"><br>
</p>
</div></div>
<p>To the left, an ARG without recombination. To the right, recombination splits lineage 1 going backwards in time, where <span class="math inline">L_1</span> takes the left path, and <span class="math inline">R_1</span> the right. Consequently, <span class="math inline">L_1</span> and <span class="math inline">R_1</span> have <em>different</em> MRCAs!</p>
</section>
<section id="arg-visualization" class="slide level2 ultitle">
<h2>ARG visualization</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div id="cell-python-draw-arg-and-save" class="cell" data-execution_count="1">
<div id="python-draw-arg-and-save" class="cell-output cell-output-display">
<style>.d3arg {
    position: relative;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    background-color: white;
    padding: 20px 20px 60px 20px;
}

.d3arg:hover .dashboard {
    visibility: visible;
}

.d3arg .dashboard {
    display: flex;
    visibility: hidden;
}

.d3arg .dashboard .dashbutton {
    position: relative;
    font-size: 30px;
    border: 0px;
    background-color: white;
    width: 30px;
    height: 30px;
}

.d3arg .dashboard .dashbutton .tip {
    width: 150px;
    font-size: 12px;
    background-color: lightgrey;
    color: #053e4e;
    text-align: center;
    padding: 5px 0px;
    position: absolute;
    z-index: 1;
    top: 100%;
    left: 50%; 
    margin-left: -60px;
    visibility: hidden;
}

.d3arg .dashboard .dashbutton:hover .desc {
    visibility: visible;
}

.d3arg .dashboard path {
    fill: grey;
}

.d3arg .dashboard .dashbutton:hover path {
    fill: #053e4e;
}

.d3arg .dashboard .activecolor:active path {
    fill: #1eebb1;
}

.d3arg .savemethods, .d3arg .labelmethods {
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: row;
    flex-wrap: wrap;
}

.d3arg .savemethods button, .d3arg .labelmethods button {
    background-color: lightgrey;
    color: #053e4e;
    font-size: 12px;
    width: auto;
    border: none;
}

.d3arg .savemethods button:hover, .d3arg .labelmethods button:hover {
    color: #1eebb1;
}

.d3arg .labelmethods button.node-labels-default {
    text-decoration: underline;
}

.d3arg .yaxis path {
    stroke: #053e4e;
    stroke-width: 3px;
}

.d3arg .yaxis line {
    stroke: #053e4e;
    stroke-width: 3px;
}

.d3arg .yaxis text {
    fill: #053e4e;
    stroke: 1px;
}

.d3arg .hiddennode {
    fill: lightgrey;
    stroke: lightgrey;
    stroke-width: 4px;
}

.d3arg .underlink {
    stroke: #ffffff;
    stroke-width: 12px;
    fill: none;
}

.d3arg .link {
    stroke-width: 4px;
    fill: none;
}

.d3arg .hiddenlink {
    stroke: lightgrey;
    stroke-width: 4px;
    fill: none;
}

.d3arg .labels {
    text-anchor: middle;
}

.d3arg .label {
    fill: #053e4e;
    font-family: Arial;
    font-size: 12px;
}

.d3arg .label.start {
    text-anchor: start;
}

.d3arg .label.stop {
    text-anchor: end;
}

.d3arg .hiddenlabel {
    fill: lightgrey;
    font-family: Arial;
    font-size: 12px;
}

.d3arg svg {
    display: block;
}

.d3arg button {
    display: block;
    cursor: pointer;
}

.d3arg .saving {
    display: flex;
    flex-direction: row;
}

.d3arg .saving .message {
    display: none;
}

.d3arg .tooltip {
    position: absolute;
    max-width: 500px;
    padding: 10px;
    background-color: white;
    color: black;
    text-align: center;
    z-index: 9999;
}

.d3arg .sites text {
    text-anchor: middle;
}</style><div id="arg_9319831765" class="d3arg" style="min-width:480.0px; min-height:555.0px;"></div><script>function ensureRequire() {
    // Needed e.g. in Jupyter notebooks: if require is already available, return resolved promise
    if (typeof require !== 'undefined') {
        return Promise.resolve(require);
    }

    // Otherwise, dynamically load require.js
    return new Promise((resolve, reject) => {
        const script = document.createElement('script');
        script.src = 'https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js';
        script.onload = () => resolve(require);
        script.onerror = reject;
        document.head.appendChild(script);
    });
};

function main_visualizer(
    d3,
    divnum,
    graph,
    width,
    height,
    y_axis,
    edge_styles,
    condense_mutations,
    label_mutations,
    tree_highlighting,
    title,
    rotate_tip_labels,
    plot_type,
    preamble,
    source
) {
    /*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */
    
    function download (url, name, opts) {
        var xhr = new XMLHttpRequest()
        xhr.open('GET', url)
        xhr.responseType = 'blob'
        xhr.onload = function () {
            saveAs(xhr.response, name, opts)
        }
        xhr.onerror = function () {
            console.error('could not download file')
        }
        xhr.send()
    }
    
    function corsEnabled (url) {
        var xhr = new XMLHttpRequest()
        // use sync to avoid popup blocker
        xhr.open('HEAD', url, false)
        try {
            xhr.send()
        } catch (e) {}
        return xhr.status >= 200 && xhr.status <= 299
    }
    
    // 'a.click()' doesn't work for all browsers (#465)
    function click (node) {
        try {
            node.dispatchEvent(new MouseEvent('click'))
        } catch (e) {
            var evt = document.createEvent('MouseEvents')
            evt.initMouseEvent('click', true, true, window, 0, 0, 0, 80,
                                20, false, false, false, false, 0, null)
            node.dispatchEvent(evt)
        }
    }
    
    function saveAs (blob, name, opts) {
        var URL = URL || webkitURL
        // Namespace is used to prevent conflict w/ Chrome Poper Blocker extension (Issue #561)
        var a = document.createElementNS('http://www.w3.org/1999/xhtml', 'a')
        name = name || blob.name || 'download'

        a.download = name
        a.rel = 'noopener' // tabnabbing

        // TODO: detect chrome extensions & packaged apps
        // a.target = '_blank'

        if (typeof blob === 'string') {
            // Support regular links
            a.href = blob
            if (a.origin !== location.origin) {
            corsEnabled(a.href)
                ? download(blob, name, opts)
                : click(a, a.target = '_blank')
            } else {
            click(a)
            }
        } else {
            // Support blobs
            a.href = URL.createObjectURL(blob)
            setTimeout(function () { URL.revokeObjectURL(a.href) }, 4E4) // 40s
            setTimeout(function () { click(a) }, 0)
        }
    }

    const NODE_IS_SAMPLE = 1;
    const NODE_IS_RE_EVENT = 131072;
    var line = d3.line();
    var step = d3.line().curve(d3.curveStep);
    var stepAfter = d3.line().curve(d3.curveStepAfter);
    var stepBefore = d3.line().curve(d3.curveStepBefore);


    // https://gist.github.com/Rokotyan/0556f8facbaf344507cdc45dc3622177
    // Below are the functions that handle actual exporting:
    // getSVGString ( svgNode ) and svgString2Image( svgString, width, height, format, callback )
    function getSVGString( svgNode ) {
        svgNode.setAttribute('xlink', 'http://www.w3.org/1999/xlink');
        var cssStyleText = getCSSStyles();
        appendCSS( cssStyleText, svgNode );
        var serializer = new XMLSerializer();
        var svgString = serializer.serializeToString(svgNode);
        svgString = svgString.replace(/(\w+)?:?xlink=/g, 'xmlns:xlink='); // Fix root xlink without namespace
        svgString = svgString.replace(/NS\d+:href/g, 'xlink:href'); // Safari NS namespace fix
        return svgString;

        function getCSSStyles() {
            // Extract CSS Rules
            var extractedCSSText = "";
            for (var i = 0; i < document.styleSheets.length; i++) { // this could be improved as it loops through all stylings on page
                var s = document.styleSheets[i];
                try {
                    if(!s.cssRules) continue;
                } catch( e ) {
                    if(e.name !== 'SecurityError') throw e; // for Firefox
                    continue;
                }
                var cssRules = s.cssRules;
                for (var r = 0; r < cssRules.length; r++) {
                    extractedCSSText += cssRules[r].cssText.replace(".d3arg ", ""); // removing reference to d3arg
                }
            }
            return extractedCSSText;

        }

        function appendCSS( cssText, element ) {
            var styleElement = document.createElement("style");
            styleElement.setAttribute("type","text/css"); 
            styleElement.innerHTML = cssText;
            var refNode = element.hasChildNodes() ? element.children[0] : null;
            element.insertBefore( styleElement, refNode );
        }
    }


    function svgString2Image( svgString, width, height, format, callback ) {
        var format = format ? format : 'png';
        var imgsrc = 'data:image/svg+xml;base64,'+ btoa( unescape( encodeURIComponent( svgString ) ) ); // Convert SVG string to data URL
        var canvas = document.createElement("canvas");
        var context = canvas.getContext("2d");
        canvas.width = width;
        canvas.height = height;
        var image = new Image();
        image.onload = function() {
            context.clearRect ( 0, 0, width, height);
            context.drawImage(image, 0, 0, width, height);
            canvas.toBlob( function(blob) {
                var filesize = Math.round( blob.length/1024 ) + ' KB';
                if ( callback ) callback( blob, filesize );
            });
        };
        image.src = imgsrc;
    }

    function draw_force_diagram() {
        var evenly_distributed_positions = graph.evenly_distributed_positions;
        var div_selector = "#arg_" + String(divnum);
        if (preamble) {
            d3.select(div_selector).html(preamble);
        }
        var tip = d3.select(div_selector).append("div")
            .attr("class", "tooltip")
            .style("display", "none");

        var dashboard = d3.select(div_selector).append("div").attr("class", "dashboard");
        
        var saving = dashboard.append("button").attr("class", "dashbutton");
        saving.append("svg") //<!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. -->
            .attr("xmlns", "http://www.w3.org/2000/svg")
            .attr("viewBox", "0 0 512 512")
            .append("path")
            .attr("d", "M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32V274.7l-73.4-73.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l128 128c12.5 12.5 32.8 12.5 45.3 0l128-128c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L288 274.7V32zM64 352c-35.3 0-64 28.7-64 64v32c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V416c0-35.3-28.7-64-64-64H346.5l-45.3 45.3c-25 25-65.5 25-90.5 0L165.5 352H64zm368 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48z");
        var saving_methods = saving.append("span").attr("class", "tip desc");
        var methods = saving_methods.append("div").text("Download As:").append("div").attr("class", "savemethods")

        methods.append("button").text("JSON")
            .on("click", function() {
                d3.selectAll(div_selector + " .node").classed("fix", function(d) {
                    d.fx = d.x;
                });
                src = JSON.parse(source);
                src.data.nodes = graph.nodes;
                var textBlob = new Blob([JSON.stringify(src)], {type: "text/plain"});
                saveAs(textBlob, "tskit_arg_visualizer.json");
            });
        methods.append("button").text("SVG")
            .on('click', function(){
                var svgString = getSVGString(svg.node());
                var svgBlob = new Blob([svgString], {type:"image/svg+xml;charset=utf-8"});
                saveAs(svgBlob, "tskit_arg_visualizer");
            });
        methods.append("button").text("PNG")
            .on('click', function(){
                var svgString = getSVGString(svg.node());
                svgString2Image(svgString, 2*width, 2*height, 'png', save); // passes Blob and filesize String to the callback
            
                function save(dataBlob){
                    saveAs(dataBlob, "tskit_arg_visualizer"); // FileSaver.js function
                }
            });
        
        /*
        methods.append("button").text("HTML")
            .on("click", function(){
                d3.selectAll(div_selector + " .node").classed("fix", function(d) {
                    d.fx = d.x;
                });
                var html = document.querySelector("html").outerHTML;
                var arg_div = document.getElementById(div_selector).innerHTML;
                console.log(arg_div);
                html = html.replace(arg_div, "");
                html = html.replace(source.match(/'nodes': .*'links'/), "'nodes': " + JSON.stringify(graph.nodes) + ", 'links'")
                saveAs(new Blob([html], {type:"text/plain;charset=utf-8"}), "tskit_arg_visualizer.html");
            })
        */

        var reheat = dashboard.append("button").attr("class", "dashbutton activecolor")
            .on("click", function(event) {
                if (!event.active) simulation.alphaTarget(0.3).restart();       
                var order = d3.selectAll(div_selector + " .sample").data().sort((a, b) => d3.ascending(a.x, b.x)).map(a => a.id);;
                d3.selectAll(div_selector + " .node").classed("unfix", function(d) {
                    if ((d.ts_flags & NODE_IS_SAMPLE) & (d.x_pos_reference == -1)) {
                        delete d.fx;
                    } else {
                        d.fx = evenly_distributed_positions[order.indexOf(d.id)];
                    }
                });
            });
        reheat.append("svg") //<!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. -->
            .attr("xmlns", "http://www.w3.org/2000/svg")
            .attr("viewBox", "0 0 384 512")
            .append("path")
            .attr("d", "M153.6 29.9l16-21.3C173.6 3.2 180 0 186.7 0C198.4 0 208 9.6 208 21.3V43.5c0 13.1 5.4 25.7 14.9 34.7L307.6 159C356.4 205.6 384 270.2 384 337.7C384 434 306 512 209.7 512H192C86 512 0 426 0 320v-3.8c0-48.8 19.4-95.6 53.9-130.1l3.5-3.5c4.2-4.2 10-6.6 16-6.6C85.9 176 96 186.1 96 198.6V288c0 35.3 28.7 64 64 64s64-28.7 64-64v-3.9c0-18-7.2-35.3-19.9-48l-38.6-38.6c-24-24-37.5-56.7-37.5-90.7c0-27.7 9-54.8 25.6-76.9z");
        reheat.append("span").attr("class", "tip desc").text("Reheat Simulation");
        
        if (plot_type == "full") {
            var evenly_distribute = dashboard.append("button").attr("class", "dashbutton activecolor")
                .on("click", function() {
                    var order = d3.selectAll(div_selector + " .sample").data().sort((a, b) => d3.ascending(a.x, b.x)).map(a => a.id);;
                    d3.selectAll(div_selector + " .sample").classed("distribute", function(d) {
                        d.fx = evenly_distributed_positions[order.indexOf(d.id)];
                    });
                });
            evenly_distribute.append("svg") //<!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. -->
                .attr("xmlns", "http://www.w3.org/2000/svg")
                .attr("viewBox", "0 0 512 512")
                .append("path")
                .attr("d", "M504.3 273.6c4.9-4.5 7.7-10.9 7.7-17.6s-2.8-13-7.7-17.6l-112-104c-7-6.5-17.2-8.2-25.9-4.4s-14.4 12.5-14.4 22l0 56-192 0 0-56c0-9.5-5.7-18.2-14.4-22s-18.9-2.1-25.9 4.4l-112 104C2.8 243 0 249.3 0 256s2.8 13 7.7 17.6l112 104c7 6.5 17.2 8.2 25.9 4.4s14.4-12.5 14.4-22l0-56 192 0 0 56c0 9.5 5.7 18.2 14.4 22s18.9 2.1 25.9-4.4l112-104z")
            evenly_distribute.append("span").attr("class", "tip desc").text("Space Samples");
        }

        var labelling = dashboard.append("button").attr("class", "dashbutton");
        labelling.append("svg") //<!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. -->
            .attr("xmlns", "http://www.w3.org/2000/svg")
            .attr("viewBox", "0 0 512 512")
            .append("path")
            .attr("d", "M0 80L0 229.5c0 17 6.7 33.3 18.7 45.3l176 176c25 25 65.5 25 90.5 0L418.7 317.3c25-25 25-65.5 0-90.5l-176-176c-12-12-28.3-18.7-45.3-18.7L48 32C21.5 32 0 53.5 0 80zm112 32a32 32 0 1 1 0 64 32 32 0 1 1 0-64z");
        var labelling_methods = labelling.append("span").attr("class", "tip desc");
        var methods = labelling_methods.append("div").text("Node Labels:").append("div").attr("class", "labelmethods")
        
        function switch_node_label(selected) {
            label_text.each(function(d) {
                d3.select(this).selectAll("*").remove();
                if (selected == "default") {
                    multi_line_text.call(this, d.label, (d.parent_of.length == 0));
                } else if (selected == "id") {
                    multi_line_text.call(this, "#" + String(d.id));
                } else {
                    multi_line_text.call(this, "");
                }
            })
        }
        
        methods.append("button").attr("class", "node-labels-default").text("DEFAULT")
            .on("click", function() {
                switch_node_label("default");
                // Underline the current selection (could use different highlighting method here)
                d3.selectAll(div_selector + " .labelmethods button").style("text-decoration", "none");
                d3.select(this).style("text-decoration", "underline");
            });
        methods.append("button").attr("class", "node-labels-id").text("#ID")
            .on('click', function(){
                switch_node_label("id");
                // Underline the current selection (could use different highlighting method here)
                d3.selectAll(div_selector + " .labelmethods button").style("text-decoration", "none");
                d3.select(this).style("text-decoration", "underline");
            });
        methods.append("button").attr("class", "node-labels-none").text("NONE")
            .on('click', function(){
                switch_node_label("none");
                // Underline the current selection (could use different highlighting method here)
                d3.selectAll(div_selector + " .labelmethods button").style("text-decoration", "none");
                d3.select(this).style("text-decoration", "underline");
            });


        var svg = d3.select(div_selector).append("svg")
            .attr("width", width)
            .attr("height", height)
            .style("background-color", "white");

        var result = y_axis.ticks.map(function (x) { 
            return parseInt(x, 10); 
        });

        if (eval(y_axis.include_labels)) {
            var bottom = height - 50;
            if (tree_highlighting) {
                bottom = height - 125;
            }
            var top = 50;
            if (title != "None") {
                top = 100
            }
            var yscale = d3.scaleLinear() 
                .domain([y_axis.max_min[0], y_axis.max_min[1]]) 
                .range([y_axis.max_min[0], y_axis.max_min[1]]); 

            var y_axis_text = y_axis.text;

            var d3_y_axis = d3.axisRight().scale(yscale)
                .tickValues(result)
                .tickFormat((d, i) => y_axis_text[i]); 

            var y_axis_labels = svg
                .append("g")
                .attr("class", "yaxis")
                .attr("transform", "translate(5,0)")
                .call(d3_y_axis);
        }

        var simulation = d3
            .forceSimulation(graph.nodes)
            .force("link", d3.forceLink()
                .id(d => d.id)
                .links(graph.links)
            )
            //.force("center", d3.forceCenter(275,250).strength(-10))
            .force("charge", d3.forceManyBody().strength(-100))
            .on("tick", ticked);

        var link_container = svg
            .append("g")
            .attr("class", "links")
            .selectAll("path")
            .data(graph.links)
            .enter()
            .append("g")
            .attr("bounds", d => d.bounds);

        if ((edge_styles.type == "ortho") & eval(edge_styles.include_underlink)) {
            var underlink = link_container
                .append("path")
                .attr("class", "underlink");
        }

        var link = link_container
            .append("path")
            .attr("class", "link")
            .attr("stroke", d => d.stroke);
        
        if (eval(edge_styles.variable_width)) {
            link
                .style("stroke-width", d => d.region_fraction * 7 + 1);
        }

        if (tree_highlighting) {
            d3.selectAll(div_selector + " .link")
                .on('mouseover', function (event, d) {
                    if (!d3.select(div_selector + ">svg").classed("no-hover")) {
                        d3.select(this)
                            .style('stroke', '#1eebb1')
                            .style("cursor", "pointer");
                        d3.selectAll(div_selector + " .sites .e" + d.id).style("display", "block");
                        d3.selectAll(div_selector + " .endpoints")
                            .style('display', 'none'); /* hide other labels to avoid clashes */
                        const bars = d3.select(div_selector + " .breakpoints").selectAll(".included");
                        bars /* colour in all bars covered by these bounds */
                            .filter(function(j) {
                                return d.bounds.split(" ").some(function(region) {
                                    region = region.split("-");
                                    return (parseFloat(region[0]) <= j.start) & (parseFloat(region[1]) >= j.stop)
                                });
                            })
                            .selectAll("rect").style('fill', '#1eebb1');
                        bars /* show the leftmost position label */
                            .filter(function(j) {
                                return d.bounds.split(" ").some(function(region) {
                                    region = region.split("-");
                                    return (parseFloat(region[0]) == j.start)
                                });
                            })
                            .selectAll("text.start").style('display', 'block');
                        bars /* show the rightmost position label */
                            .filter(function(j) {
                                return d.bounds.split(" ").some(function(region) {
                                    region = region.split("-");
                                    return (parseFloat(region[1]) == j.stop)
                                });
                            })
                            .selectAll("text.stop").style('display', 'block');
                    }
                })
                .on('mouseout', function (event, d) {
                    if (!d3.select(div_selector + ">svg").classed("no-hover")) {
                        d3.select(this)
                            .style('stroke', d.stroke)
                            .style("cursor", "default");
                        const bars = d3.select(div_selector + " .breakpoints").selectAll(".included");
                        bars.selectAll("rect").style("fill", d.fill);
                        bars.selectAll("text").style("display", "none");
                        d3.selectAll(div_selector + " .endpoints")
                            .style('display', 'block');
                        d3.selectAll(div_selector + " .sites .e" + d.id).style("display", "none");
                    }
                });
        }

        var node_group = svg
            .append("g")
            .attr("class", "nodes")
            .selectAll("circle")
            .data(graph.nodes)
            .enter()
            .append("g");

        var missing_edges = node_group
            .filter(d => (d.not_included_parents>0) | (d.not_included_children>0))
            .append("g")
            .attr("class", "missing");

        var missing_parents = missing_edges
            .filter(d => d.not_included_parents>0)
            .append("g")
            .attr("class", "parents")
            .append("g");
        var missing_parents_paths = missing_parents.append("path");
        var missing_parents_texts = missing_parents
            .append("text")
                .attr("class", "label")
                .style("fill", "gray")
                .text(d => d.not_included_parents);

        var missing_children = missing_edges
            .filter(d => d.not_included_children>0)
            .append("g")
            .attr("class", "children")
            .append("g");
        var missing_children_paths = missing_children.append("path");
        var missing_children_texts = missing_children
            .append("text")
                .attr("class", "label")
                .style("fill", "gray")
                .text(d => d.not_included_children);

        function multi_line_text(text, top_align) {
            if (text != null) {
                // Split label text onto separate lines by newline characters, if they exist
                const lines = text.split("\n");
                const parentX = d3.select(this).attr("x") || "0";  // Get parent text's x position
                const initialDy = top_align ? "0em" : (-1 * (lines.length - 1)) + "em";

                d3.select(this).text(null); // clear existing text
                d3.select(this).selectAll('tspan')
                    .data(lines)
                    .enter()
                    .append('tspan')
                    .text(d => d)
                    .attr('x', parentX)  // Use parent's x position
                    .attr('dy', (d, i) => ((i === 0) ? initialDy : "1em"));
            }
        }
        var node = node_group
            .append("path")
            .attr("transform", d => "translate(" + d.x + "," + d.y + ")")
            .attr("d", d3.symbol().type(d => eval(d.symbol)).size(d => d.size))
            .attr("fill", d => d.fill)
            .attr("stroke", d => d.stroke)
            .attr("stroke-width", d => d.stroke_width)
            .attr("id", d => String(divnum) + "_node" + d.id)
            .attr("class", d => "node flag" + d.ts_flags + (d.ts_flags & NODE_IS_SAMPLE ? " sample" : ""))
            .attr("parents", d => d.child_of.toString().replace(",", " "))
            .attr("children", d => d.parent_of.toString().replace(",", " "))
            .call(
                d3
                    .drag()
                    .on("start", dragstarted)
                    .on("drag", dragged)
                    .on("end", dragended)
            )
            .on('mouseover', function (d, i) {
                d3.select(this)
                    .style("cursor", "pointer")
            });

        function highlight_mut(mutation_id, site_id, fill) {
            /* other mutations at the same site on the tree */
            d3.selectAll(div_selector + " .mutations .s" + site_id + " rect").style("stroke", fill);
            /* highlight only this mutation in the bar */
            d3.select(div_selector + " .sites .m" + mutation_id).style("display", "block");
        }

        function dehighlight_mut(mutation_id, site_id) {
            d3.selectAll(div_selector + " .mutations .s" + site_id + " rect")
                .each(function(d) {
                    d3.select(this)
                        .style("stroke", d.stroke)
                        .style("fill", d.fill);
                    });
            d3.select(div_selector + " .sites .m" + mutation_id).style("display", "none");
        }

        function highlight_mut(mutation_id, site_id, fill) {
            /* other mutations at the same site on the tree */
            d3.selectAll(div_selector + " .mutations .s" + site_id + " rect").style("stroke", fill);
            /* highlight only this mutation in the bar */
            d3.select(div_selector + " .sites .m" + mutation_id).style("display", "block");
        }

        function dehighlight_mut(mutation_id, site_id) {
            d3.selectAll(div_selector + " .mutations .s" + site_id + " rect")
                .each(function(d) {
                    d3.select(this)
                        .style("stroke", d.stroke)
                        .style("fill", d.fill);
                    });
            d3.select(div_selector + " .sites .m" + mutation_id).style("display", "none");
        }

        var mut_symbol = svg
            .append("g")
            .attr("class", "mutations")
            .selectAll("rect")
            .data(graph.mutations)
            .enter()
            .append("g")
            .attr("class", d => {
                if (condense_mutations) {
                    return (
                        d.site_id.map(id => "s" + id).join(" ") + " " +
                        d.mutation_id.map(id => "m" + id).join(" ")
                    )
                } else {
                    return "s" + d.site_id + " " + "m" + d.mutation_id;
                }}
            )
            .attr("class", d => {
                if (condense_mutations) {
                    return (
                        d.site_id.map(id => "s" + id).join(" ") + " " +
                        d.mutation_id.map(id => "m" + id).join(" ")
                    )
                } else {
                    return "s" + d.site_id + " " + "m" + d.mutation_id;
                }}
            )
            .style("transform-box", "fill-box")
            .style("transform-origin", "center")
            .on("mouseover", function(event, d) {
                if (!d3.select(div_selector + ">svg").classed("no-hover")) {
                    d3.select(this).style("cursor", "pointer");
                    /* highlight all mutations at the same site (easy to spot reversions etc) */
                    if (condense_mutations) {
                        d.mutation_id.forEach((id, i) => highlight_mut(id, d.site_id[i], d.fill));
                    } else {
                        highlight_mut(d.mutation_id, d.site_id, d.fill)
                    }
                    if (condense_mutations) {
                        d.mutation_id.forEach((id, i) => highlight_mut(id, d.site_id[i], d.fill));
                    } else {
                        highlight_mut(d.mutation_id, d.site_id, d.fill)
                    }
                    /* Show a tooltip with the mutation information */
                    var rect = d3.select(div_selector).node().getBoundingClientRect();
                    tip
                        .style("display", "block")
                        .html("<p style='margin: 0px;'>" + d.content + "</p>")
                        .style("border", d.fill + " solid 2px")
                        .style("left", (event.pageX - rect.x) + "px")
                        .style("top", (event.pageY - rect.y + 25) + "px")
                        .style("transform", "translateX(-50%)");
                }
            })
            .on("mouseout", function(event, d) {
                if (!d3.select(div_selector + ">svg").classed("no-hover")) {
                    if (!eval(d.active)) {
                        d3.select(this).style("cursor", "default");
                        if (condense_mutations) {
                            d.mutation_id.forEach((id, i) => dehighlight_mut(id, d.site_id[i]));
                        } else {
                            dehighlight_mut(d.mutation_id, d.site_id);
                        }
                    }
                    if (!eval(d.active)) {
                        d3.select(this).style("cursor", "default");
                        if (condense_mutations) {
                            d.mutation_id.forEach((id, i) => dehighlight_mut(id, d.site_id[i]));
                        } else {
                            dehighlight_mut(d.mutation_id, d.site_id);
                        } 
                        tip.style("display", "none");
                    }
                }
            });


        var mut_symbol_rect = mut_symbol
            .append("rect")
            .attr("class", "symbol")
            .attr("fill", d => d.fill)
            .attr("stroke", d => d.stroke)
            .attr("stroke-width", 2);

        if (label_mutations) {
            var mut_symbol_label = mut_symbol
                .append("text")
                .attr("class", "label")
                .style("font-size", d => (d.size * 2 + "px"))
                .attr("text-anchor", "middle")
                .attr("alignment-baseline", "middle")
                .text(d => d.label)
                .each(function(d) {
                    // Store the text width on the data object
                    d.textWidth = this.getComputedTextLength();
                });
            }

        function rotate_tip(d) {
            /* NB: why is there an "eval" here? */
            if ((d.parent_of.length == 0) & (eval(rotate_tip_labels))) {
                return "translate(-4, 0) rotate(90)"
            }
            return null
        }

        var label = svg
            .append("g")
            .attr("class", "node-labels")
            .selectAll("text")
            .data(graph.nodes)
            .enter()
            //.filter(d => eval(d.include_label))
            .append("g");

        var label_text = label
            .attr("class", d => "label n" + d.id)
            .append("text")
            .each(function(d) {
                multi_line_text.call(this, d.label, (d.parent_of.length == 0));
            })
            //.each(d => multi_line_text.call(this, d.label, (d.parent_of.length == 0)))
            .attr("transform", rotate_tip);

        function determine_path_type(d) {
            path_type = ""
            var start_position_x = d.source.x;
            var start_position_y = d.source.y;
            var stop_position_x = d.target.x;
            var stop_position_y = d.target.y;
            var vnub = Math.min((stop_position_y-start_position_y)/2, 20);
            if ("y_axis.scale" == "time" | "y_axis.scale" == "log_time") {
                vnub = 0;
            }
            var alt_child = document.getElementById(String(divnum) + "_node" + d.alt_child);
            if (alt_child != null) {
                var alt_child_x = alt_child.getAttribute("cx");
                var alt_child_y = alt_child.getAttribute("cy");
            }
            if (d.source.ts_flags & NODE_IS_RE_EVENT) {
                path_type += "r0";
                start_position_y = d.source.y + vnub;
            } else {
                if (d.target.y < alt_child_y) {
                    if (d.target.x < d.source.x) {
                        if (d.target.x < d.source.x - 40) {
                            path_type += "tL";
                        } else {
                            path_type += "fL";
                        }
                        start_position_x = d.source.x - 20;
                    } else {
                        if (d.target.x > d.source.x + 40) {
                            path_type += "tR";
                        } else {
                            path_type += "fR";
                        }
                        start_position_x = d.source.x + 20;
                    }
                } else if (d.target.y > alt_child_y) {
                    if (alt_child_x < d.source.x) {
                        if (d.target.x < d.source.x + 40) {
                            path_type += "fR";
                        } else {
                            path_type += "tR";
                        }
                        start_position_x = d.source.x + 20;
                    } else {
                        if (d.target.x > d.source.x - 40) {
                            path_type += "fL";
                        } else {
                            path_type += "tL";
                        }
                        start_position_x = d.source.x - 20;
                    }
                } else {
                    if (d.target.x < alt_child_x) {
                        if (d.target.x < d.source.x - 40) {
                            path_type += "tL";
                        } else {
                            path_type += "fL";
                        }
                        start_position_x = d.source.x - 20;
                    } else if (d.target.x > alt_child_x) {
                        if (d.target.x > d.source.x + 40) {
                            path_type += "tR";
                        } else {
                            path_type += "fR";
                        }
                        start_position_x = d.source.x + 20;
                    } else {
                        if (d.index % 2 == 0) {
                            path_type += "fL";
                            start_position_x = d.source.x - 20;
                        } else {
                            path_type += "fR";
                            start_position_x = d.source.x + 20;
                        }
                    }
                }
            }
            var alt_parent = document.getElementById(String(divnum) + "_node" + d.alt_parent);
            if (alt_parent != null) {
                var alt_parent_x = alt_parent.getAttribute("cx");
                var alt_parent_y = alt_parent.getAttribute("cy");
            }
            if (d.target.ts_flags & NODE_IS_RE_EVENT) {
                if (d.source.y < alt_parent_y) {
                    if (alt_parent_x < d.target.x) {
                        if (d.source.x < d.target.x + 40) {
                            path_type += "fR";
                        } else {
                            path_type += "tR";
                        }
                        stop_position_x = d.target.x + 20;
                    } else {
                        if (d.source.x > d.target.x - 40) {
                            path_type += "fL";
                        } else {
                            path_type += "tL";
                        }
                        stop_position_x = d.target.x - 20;
                    }
                } else if (d.source.y > alt_parent_y) {
                    if (d.source.x < d.target.x) {
                        if (d.source.x < d.target.x - 40) {
                            path_type += "tL";
                        } else {
                            path_type += "fL";
                        }
                        stop_position_x = d.target.x - 20;
                    } else {
                        if (d.source.x > d.target.x + 40) {
                            path_type += "tR";
                        } else {
                            path_type += "fR";
                        }
                        stop_position_x = d.target.x + 20;
                    }
                } else {
                    if (d.index % 2 == 0) {
                        path_type += "fL";
                        stop_position_x = d.target.x - 20;
                    } else {
                        path_type += "fR";
                        stop_position_x = d.target.x + 20;
                    }
                }
            } else {
                path_type += "b0";
                stop_position_y = d.target.y - vnub;
            }
            if (path_type == "fLb0" ) {
                if (start_position_x >= stop_position_x) {
                    path_type = "tLb0";
                }
            } else if (path_type == "fRb0") {
                if (start_position_x <= stop_position_x) {
                    path_type = "tRb0";
                }
            } else if (path_type == "r0fL") {
                if (start_position_x <= stop_position_x) {
                    path_type = "r0tL";
                }
            } else if (path_type == "r0fR") {
                if (start_position_x >= stop_position_x) {
                    path_type = "r0tR";
                }
            } else if (path_type == "fLfL") {
                if (start_position_x <= stop_position_x) {
                    path_type = "fLtL";
                } else {
                    path_type = "tLfL";
                }
            } else if (path_type == "fRfR") {
                if (start_position_x >= stop_position_x) {
                    path_type = "fRtR";
                } else {
                    path_type = "tRfR";
                }
            }
            return [path_type, start_position_x, start_position_y, stop_position_x, stop_position_y];
        }

        function ortho_pathing(d, path_info, underlink=false) {      
            const path_type = path_info[0];
            const simple_path_type = Array.from(path_type)[0] + Array.from(path_type)[2];
            const start_position_x = path_info[1];
            const start_position_y = path_info[2];
            const stop_position_x = path_info[3];
            const stop_position_y = path_info[4];

            const after_paths = ["rf", "tb", "tf"];
            const before_paths = ["rt", "fb", "ft"];
            const step_paths = ["tt"];
            const mid_paths = ["rb", "ff"];

            if (underlink) {
                if (after_paths.includes(simple_path_type)) {
                    return stepAfter([[start_position_x, start_position_y],[stop_position_x, stop_position_y]]);
                } else if (before_paths.includes(simple_path_type)) {
                    return stepBefore([[start_position_x, start_position_y],[stop_position_x, stop_position_y]]);
                } else if (step_paths.includes(simple_path_type)) {
                    return step([[start_position_x, start_position_y],[stop_position_x, stop_position_y]]);
                } else if (mid_paths.includes(simple_path_type)) {
                    return line([[start_position_x, start_position_y],[start_position_x, start_position_y + (stop_position_y - start_position_y)/2]]) + line([[start_position_x, start_position_y + (stop_position_y - start_position_y)/2],[stop_position_x, start_position_y + (stop_position_y - start_position_y)/2]]) + line([[stop_position_x, start_position_y + (stop_position_y - start_position_y)/2], [stop_position_x, stop_position_y]]);
                }
            } else {
                if (after_paths.includes(simple_path_type)) {
                    return line([[d.source.x, d.source.y],[start_position_x, start_position_y]]) + stepAfter([[start_position_x, start_position_y],[stop_position_x, stop_position_y]]) + line([[stop_position_x, stop_position_y], [d.target.x, d.target.y]]);
                } else if (before_paths.includes(simple_path_type)) {
                    return line([[d.source.x, d.source.y],[start_position_x, start_position_y]]) + stepBefore([[start_position_x, start_position_y],[stop_position_x, stop_position_y]]) + line([[stop_position_x, stop_position_y], [d.target.x, d.target.y]]);
                } else if (step_paths.includes(simple_path_type)) {
                    return line([[d.source.x, d.source.y],[start_position_x, start_position_y]]) + step([[start_position_x, start_position_y],[stop_position_x, stop_position_y]]) + line([[stop_position_x, stop_position_y], [d.target.x, d.target.y]]);
                } else if (mid_paths.includes(simple_path_type)) {
                    return line([[d.source.x, d.source.y],[start_position_x, start_position_y]]) + line([[start_position_x, start_position_y],[start_position_x, start_position_y + (stop_position_y - start_position_y)/2]]) + line([[start_position_x, start_position_y + (stop_position_y - start_position_y)/2],[stop_position_x, start_position_y + (stop_position_y - start_position_y)/2]]) + line([[stop_position_x, start_position_y + (stop_position_y - start_position_y)/2], [stop_position_x, stop_position_y]]) + line([[stop_position_x, stop_position_y], [d.target.x, d.target.y]]);
                }
            }
        }

        function ticked() {
            node
                .attr("transform", function(d) {
                    if (eval(y_axis.include_labels)) {
                        return "translate(" + Math.max(100, Math.min(width-50, d.x)) + "," + d.y + ")";
                    } else {
                        return "translate(" + Math.max(50, Math.min(width-50, d.x)) + "," + d.y + ")";
                    }
                })
                .attr("cx", function(d) {
                    if ((edge_styles.type == "ortho") & (d.x_pos_reference != -1)) {
                        var ref = document.getElementById(String(divnum) + "_node" + d.x_pos_reference);
                        if (ref != null) {
                            d.fx = ref.getAttribute("cx");
                        }
                    }
                    if (eval(y_axis.include_labels)) {
                        return d.x = Math.max(100, Math.min(width-50, d.x));
                    } else {
                        return d.x = Math.max(50, Math.min(width-50, d.x));
                    }
                })
                .attr("cy", d => d.y);
            
            link_container.each(function(d) {
                var path_info = determine_path_type(d);
                var path = "";
                if (edge_styles.type == "ortho") {
                    path = ortho_pathing(d, path_info);
                    underlink_path = ortho_pathing(d, path_info, underlink=true);
                } else if (d.source.id == d.alt_parent) {
                    var leftOrRight = 20;
                    if (d.index % 2 == 0) {
                        leftOrRight = -20;
                    }
                    path = "M " + d.source.x + " " + d.source.y + " C " + (d.source.x + leftOrRight).toString() + " " +  (d.source.y - 10).toString() + ", " + (d.target.x + leftOrRight).toString() + " " + (d.target.y + 10).toString() + ", " + d.target.x + " " + d.target.y;
                } else {
                    path = line([[d.source.x, d.source.y], [d.target.x, d.target.y]]);
                }
                if ((edge_styles.type == "ortho") & eval(edge_styles.include_underlink)) {
                    var u = d3.select(this).select(".underlink");
                    u.attr("d", underlink_path);
                }
                var l = d3.select(this).select(".link");
                l.attr("path_type", path_info[0]);
                l.attr("d", path);
            });

            mut_symbol
                .attr("transform", function(d) {
                    var parent = document.getElementById(String(divnum) + "_node" + d.source);
                    if (parent != null) {
                        var parent_x = parseFloat(parent.getAttribute("cx"));
                        var parent_y = parseFloat(parent.getAttribute("cy"));
                        var child = document.getElementById(String(divnum) + "_node" + d.target);
                        if (child != null) {
                            var child_x = parseFloat(child.getAttribute("cx"));
                            var child_y = parseFloat(child.getAttribute("cy"));
                            var slope = (parent_y - child_y) / (parent_x - child_x);
                            var intercept = parent_y - slope * parent_x;
                            return "rotate(" + String(-Math.atan((child_x-parent_x)/(child_y-parent_y))*180/Math.PI) + ")";
                        } else {
                            return "rotate(0)";
                        }
                    } else {
                        return "rotate(0)";
                    }
                });

            mut_symbol_rect
            // Set the rect width / height based on the calculated text width
                .attr("width", function(d) {
                    if (label_mutations && d.textWidth) {
                        d.computedWidth = d.textWidth + 6; // Add left/right padding
                    } else {
                        d.computedWidth = d.size * 3; // aspect ratio is 3 (3 times wider than tall)
                    }
                    return d.computedWidth;  
                })
                .attr("height", function(d) {
                    if (label_mutations) {
                        d.computedHeight = (d.size * 2) + 4; // Font size + top/bottom padding
                    }
                    else {
                        d.computedHeight = d.size;
                    }
                    return d.computedHeight;
                })
                .attr("x", function(d) {
                    var parent = document.getElementById(String(divnum) + "_node" + d.source);
                    if (parent != null) {
                        var parent_x = parseFloat(parent.getAttribute("cx"));
                        var parent_y = parseFloat(parent.getAttribute("cy"));
                        var child = document.getElementById(String(divnum) + "_node" + d.target);
                        if (child != null) {
                            var child_x = parseFloat(child.getAttribute("cx"));
                            var child_y = parseFloat(child.getAttribute("cy"));
                            if (parent_x - child_x == 0) {
                                return parent_x - d.computedWidth/2;
                            } else {
                                var slope = (parent_y - child_y) / (parent_x - child_x);
                                var intercept = parent_y - slope * parent_x;
                                return ((d.y - intercept) / slope) - d.computedWidth/2;
                            }
                        } else {
                            return 0;
                        }
                    } else {
                        return 0;
                    }
                })
                .attr("y", d => d.y - d.computedHeight/2);
            
            if (label_mutations) {
                mut_symbol_label
                    .attr("transform", function(d) {
                        var y = d.y + 1;
                        var x = 0;
                        var parent = document.getElementById(String(divnum) + "_node" + d.source);
                        if (parent != null) {
                            var parent_x = parseFloat(parent.getAttribute("cx"));
                            var parent_y = parseFloat(parent.getAttribute("cy"));
                            var child = document.getElementById(String(divnum) + "_node" + d.target);
                            if (child != null) {
                                var child_x = parseFloat(child.getAttribute("cx"));
                                var child_y = parseFloat(child.getAttribute("cy"));
                                if (parent_x - child_x == 0) {
                                    x = parent_x;
                                } else {
                                    var slope = (parent_y - child_y) / (parent_x - child_x);
                                    var intercept = parent_y - slope * parent_x;
                                    x = ((d.y - intercept) / slope);
                                }
                            } else {
                                x = 0;
                            }
                        } else {
                            x = 0;
                        }
                        return "translate(" + String(x) + "," + String(y) + ")";
                    });
            }

            function determine_label_positioning(d) {
                if (d.ts_flags & NODE_IS_RE_EVENT || d.parent_of.length == 0 || d.child_of.length == 0) {
                    return "c";
                } else if (d.child_of.length == 1) {
                    var parent = document.getElementById(String(divnum) + "_node" + d.child_of[0])
                    if (parent != null) {
                        var parent_x = parent.getAttribute("cx");
                        if (parent_x > d.x+1) {
                            return "l";
                        } else {
                            return "r";
                        }
                    } else {
                        return "r";
                    }
                } else {
                    return "r";
                }
            };

            label
                .each(function(d) {
                    var l = d3.select(this);
                    var positioning = determine_label_positioning(d);
                    var x = d.x;
                    var anchor = "middle";
                    // Find offsets from CSS
                    const cstyle = getComputedStyle(this)
                    const symbolSize = Math.sqrt(d.size);
                    const cssOffset = cstyle.getPropertyValue('--offset');
                    // default should depend on the symbol size (which is square pixels) and the font size
                    const offset = cssOffset ? parseInt(cssOffset) : symbolSize/2 + parseFloat(cstyle.fontSize)/2;
                    const cssTipoffset = cstyle.getPropertyValue('--tipoffset');
                    // default of 25 if not set: perhaps should be related to the tip symbol size?
                    const tipoffset = cssTipoffset ? parseInt(cssTipoffset) : symbolSize/2 + parseFloat(cstyle.fontSize);
                    if (positioning == "l") {
                        x = d.x - offset;
                        anchor = "end";
                    } else if (positioning == "r") {
                        x = d.x + offset;
                        anchor = "start";
                    }
                    l.attr("text-anchor", anchor);
                    l.attr("transform", function(d) {
                        // adding slightly more spacing in the y-axis when positioning is middle (c)
                        var y = d.y - offset;
                        if (positioning == "c") {
                            y = y - 3;
                        }
                        if (d.parent_of.length == 0) {
                            y = d.y + tipoffset;
                            if (positioning == "c") {
                                y = y + 3;
                            }
                        }
                        // only bother showing up to 4 d.p.
                        return "translate(" + parseFloat(x.toFixed(4)) + "," + parseFloat(y.toFixed(4)) + ")";
                    })
                });

            missing_parents_paths
                .each(function(d) {
                    var l = d3.select(this);
                    l.style("stroke-width", "4px");
                    l.style("stroke-dasharray", "5");
                    l.style("stroke", "gray");
                    l.attr("d", line([[d.x, d.y], [d.x, d.y-30]]));
                });
            
            missing_parents_texts
                .each(function(d) {
                    var l = d3.select(this);
                    l.attr("text-anchor", "middle");
                    l.attr("x", d.x);
                    l.attr("y", d.y-30);
                });

            missing_children_paths
                .each(function(d) {
                    var l = d3.select(this);
                    l.style("stroke-width", "4px");
                    l.style("stroke-dasharray", "5");
                    l.style("stroke", "gray");
                    l.attr("d", line([[d.x, d.y], [d.x, d.y+30]]));
                });
            
            missing_children_texts
                .each(function(d) {
                    var l = d3.select(this);
                    l.attr("text-anchor", "middle");
                    l.attr("x", d.x);
                    l.attr("y", d.y+40);
                });
        }

        function dragstarted(event, d) {
            if (!event.active) simulation.alphaTarget(0.3).restart();
            d.fx = d.x;
            d3.selectAll(div_selector + " .node").classed("ref", function(j) {
                if ((edge_styles.type == "ortho") & (j.id == d.x_pos_reference)) {
                    j.fx = d.x;
                }
            });
            svg.attr("class", "no-hover");
        }

        function dragged(event, d) {
            d.fx = event.x;
            d3.selectAll(div_selector + " .node").classed("ref", function(j) {
                if ((edge_styles.type == "ortho") & (j.id == d.x_pos_reference)) {
                    j.fx = event.x;
                }
            });
        }

        function dragended(event, d) {
            svg.attr("class", null);
        }

        if (tree_highlighting) {
            
            var th_group = svg.append("g").attr("class", "tree_highlighting");
            
            var breakpoint_regions = th_group
                .append("g")
                .attr("class", "breakpoints")
                .selectAll("g")
                .data(graph.breakpoints)
                .enter()
                .append("g")
                .attr("class", d => eval(d.included) ? "included" : null)
                .attr("start", d => d.start)
                .attr("stop", d => d.stop);

            breakpoint_regions
                .append("rect")
                .attr("x", d => d.x_pos)
                .attr("y", height-60)
                .attr("width", d => d.width)
                .attr("height", 40)
                .attr("stroke", "#FFFFFF")
                .attr("stroke-width", 1)
                .attr("fill", d => eval(d.included) ? d.fill : "gray");

            breakpoint_regions
                .append("text")
                .attr("x", d => d.x_pos)
                .attr("y", height-5)
                .attr("class", "label start")
                .style("display", "none")
                .text(d => String(d.start));

            breakpoint_regions
                .append("text")
                .attr("x", d => d.x_pos + d.width)
                .attr("y", height-5)
                .attr("class", "label stop")
                .style("display", "none")
                .text(d => String(d.stop));

            breakpoint_regions
                .on('mouseover', function (event, d) {
                    if (!d3.select(div_selector + ">svg").classed("no-hover")) {
                        if (eval(d.included)) {
                            d3.select(this).selectAll("rect")
                                .style('fill', '#1eebb1')
                                .style("cursor", "pointer");
                            d3.select(this).selectAll("text")
                                .style('display', 'block');
                            d3.selectAll(div_selector + " .endpoints")
                                .style('display', 'none'); /* hide other labels to avoid clashes */
                            var highlight_links = d3.select(div_selector + " .links")
                                .selectAll("g")
                                    .filter(function(j) {
                                        return j.bounds.split(" ").some(function(region) {
                                            region = region.split("-");
                                            return (parseFloat(region[1]) > d.start) & (parseFloat(region[0]) < d.stop)
                                        });
                                    });
                            highlight_links.raise();
                            highlight_links
                                .select(".link")
                                .style("stroke", "#1eebb1");
                        }
                    }
                })
                .on('mouseout', function (event, d) {
                    if (!d3.select(div_selector + ">svg").classed("no-hover")) {
                        if (eval(d.included)) {
                            d3.select(this).selectAll("rect")
                                .style('fill', d.fill)
                                .style("cursor", "default");
                            d3.select(this).selectAll("text")
                                .style('display', 'none');
                            d3.selectAll(div_selector + " .endpoints")
                                .style('display', 'block');
                            d3.selectAll(div_selector + " .link")
                                .style("stroke", d => d.stroke);
                        }
                    }
                });
            
            var endpoints = th_group.append("g").attr("class", "endpoints");
            
            endpoints
                .append("text")
                    .attr("class", "label")
                    .style("text-anchor", "start")
                    .text(graph.breakpoints[0].start)
                    .attr("x", graph.breakpoints[0].x_pos)
                    .attr("y", height-5);
            
            endpoints
                .append("text")
                    .attr("class", "label")
                    .style("text-anchor", "end")
                    .text(graph.breakpoints[graph.breakpoints.length-1].stop)
                    .attr("x", width)
                    .attr("y", height-5);

            var mutation_data = graph.mutations;
            if (condense_mutations) { /* explode the graph.mutations df into one row per mut */
                mutation_data = [];
                graph.mutations.forEach(function(d) {
                    d.mutation_id.forEach(function(x, i) {
                        mutation_data.push({
                            mutation_id: x,
                            site_id: d.site_id[i],
                            edge: d.edge,
                            fill: d.fill,
                            x_pos: d.x_pos[i], 
                            position: d.position[i]
                        });
                    });
                });
            };

            var mutation_data = graph.mutations;
            if (condense_mutations) { /* explode the graph.mutations df into one row per mut */
                mutation_data = [];
                graph.mutations.forEach(function(d) {
                    d.mutation_id.forEach(function(x, i) {
                        mutation_data.push({
                            mutation_id: x,
                            site_id: d.site_id[i],
                            edge: d.edge,
                            fill: d.fill,
                            x_pos: d.x_pos[i], 
                            position: d.position[i]
                        });
                    });
                });
            };

            var site_pos = th_group
                .append("g")
                .attr("class", "sites")
                .selectAll("line")
                .data(mutation_data)  /* NB: one per mutation to allow different line colors */
                .data(mutation_data)  /* NB: one per mutation to allow different line colors */
                .enter()
                .append("g")
                .attr("class", d => "s" + d.site_id + " " + "e" + d.edge + " " + "m" + d.mutation_id)
                .attr("class", d => "s" + d.site_id + " " + "e" + d.edge + " " + "m" + d.mutation_id)
                .attr("transform", d => "translate(" + d.x_pos + "," + (height-60) + ")")
                .style("display", "none");

            function createSiteLine(selection) {
                return selection
                    .append("line")
                    .attr("y1", -5)
                    .attr("y2", 40+5)
                    .style("stroke-width", 3)
                    .style("fill", "none");
            }
                  
            function createSiteText(selection) {
                return selection
                    .append("text")
                    .attr("y", -8)  /* above the tick */
                    .attr("class", "label");
            }
            
            site_pos
                .each(function(d) {
                    const select = d3.select(this);
                    createSiteLine(select)
                        .style("stroke", d.fill);
                    createSiteText(select)
                        .text(String(d.position));
                });
            
            /*
            var mut_text = mut_pos
                .append("text")
                .attr("text-anchor", function(d) {
                    if (d.x_pos > (width*9/10)) {
                        return "end";
                    } else if (d.x_pos < width*1/10) {
                        return "start";
                    } else {
                        return "middle";
                    }
                })
                .style("font-size", "10px")
                .style("font-family", "Arial")
                .attr("fill", d => d.fill)
                .attr("transform", d => "translate(" + String(d.x_pos) + "," + String(height-60-10) + ")");
        
            mut_text
                .text(function(d) {
                    if (label_mutations) {
                        return String(d.site_id) + ":" + String(d.position);
                    } else {
                        return d.label;
                    }
                });
            */
        }

        if (title != "None") {
            svg.append("text")
                .style("font-size", "20px")
                .attr("x", width / 2)
                .attr("text-anchor", "middle")
                .attr("y", 30)
                .each(function() { 
                    multi_line_text.call(this, title, true); 
                });
        }
    }

    draw_force_diagram()
}

/* NB: the code below fires up the visualizer: templates in this call
    can be used to pass in the appropriate data
*/

ensureRequire()
    .then(require => {
        require.config({ paths: {d3: 'https://d3js.org/d3.v7.min'}});
        require(["d3"], function(d3) {
            main_visualizer(d3, 9319831765, {"nodes": [{"size": 150, "symbol": "d3.symbolCircle", "fill": "#1eebb1", "stroke": "#053e4e", "stroke_width": 4, "id": 0, "ts_flags": 1, "time": 0.0, "child_of": [8], "parent_of": [], "x_pos_reference": -1, "label": "0", "fx": 99.0, "fy": 350.0, "y": 350.0}, {"size": 150, "symbol": "d3.symbolCircle", "fill": "#1eebb1", "stroke": "#053e4e", "stroke_width": 4, "id": 1, "ts_flags": 1, "time": 0.0, "child_of": [20], "parent_of": [], "x_pos_reference": -1, "label": "1", "fx": 50.0, "fy": 350.0, "y": 350.0}, {"size": 150, "symbol": "d3.symbolCircle", "fill": "#1eebb1", "stroke": "#053e4e", "stroke_width": 4, "id": 2, "ts_flags": 1, "time": 0.0, "child_of": [12], "parent_of": [], "x_pos_reference": -1, "label": "2", "fx": 196.0, "fy": 350.0, "y": 350.0}, {"size": 150, "symbol": "d3.symbolCircle", "fill": "#1eebb1", "stroke": "#053e4e", "stroke_width": 4, "id": 3, "ts_flags": 1, "time": 0.0, "child_of": [12], "parent_of": [], "x_pos_reference": -1, "label": "3", "fx": 244.0, "fy": 350.0, "y": 350.0}, {"size": 150, "symbol": "d3.symbolCircle", "fill": "#1eebb1", "stroke": "#053e4e", "stroke_width": 4, "id": 4, "ts_flags": 1, "time": 0.0, "child_of": [9], "parent_of": [], "x_pos_reference": -1, "label": "4", "fx": 341.0, "fy": 350.0, "y": 350.0}, {"size": 150, "symbol": "d3.symbolCircle", "fill": "#1eebb1", "stroke": "#053e4e", "stroke_width": 4, "id": 5, "ts_flags": 1, "time": 0.0, "child_of": [11], "parent_of": [], "x_pos_reference": -1, "label": "5", "fx": 390.0, "fy": 350.0, "y": 350.0}, {"size": 150, "symbol": "d3.symbolCircle", "fill": "#1eebb1", "stroke": "#053e4e", "stroke_width": 4, "id": 6, "ts_flags": 1, "time": 0.0, "child_of": [13], "parent_of": [], "x_pos_reference": -1, "label": "6", "fx": 293.0, "fy": 350.0, "y": 350.0}, {"size": 150, "symbol": "d3.symbolCircle", "fill": "#1eebb1", "stroke": "#053e4e", "stroke_width": 4, "id": 7, "ts_flags": 1, "time": 0.0, "child_of": [8], "parent_of": [], "x_pos_reference": -1, "label": "7", "fx": 147.0, "fy": 350.0, "y": 350.0}, {"size": 150, "symbol": "d3.symbolCircle", "fill": "#1eebb1", "stroke": "#053e4e", "stroke_width": 4, "id": 8, "ts_flags": 0, "time": 1.4619134591171952, "child_of": [17], "parent_of": [0, 7], "x_pos_reference": -1, "label": "8", "x": 220.0, "fy": 335.7142857142857, "y": 335.7142857142857}, {"size": 150, "symbol": "d3.symbolCircle", "fill": "#1eebb1", "stroke": "#053e4e", "stroke_width": 4, "id": 9, "ts_flags": 131072, "time": 12.859594997274943, "child_of": [11, 19], "parent_of": [4], "x_pos_reference": 4, "label": "9/10", "x": 220.0, "fy": 321.42857142857144, "y": 321.42857142857144}, {"size": 150, "symbol": "d3.symbolCircle", "fill": "#1eebb1", "stroke": "#053e4e", "stroke_width": 4, "id": 11, "ts_flags": 0, "time": 16.755034405974484, "child_of": [21], "parent_of": [5, 9], "x_pos_reference": -1, "label": "11", "x": 220.0, "fy": 307.14285714285717, "y": 307.14285714285717}, {"size": 150, "symbol": "d3.symbolCircle", "fill": "#1eebb1", "stroke": "#053e4e", "stroke_width": 4, "id": 12, "ts_flags": 0, "time": 18.935713403423676, "child_of": [15], "parent_of": [2, 3], "x_pos_reference": -1, "label": "12", "x": 220.0, "fy": 292.8571428571429, "y": 292.8571428571429}, {"size": 150, "symbol": "d3.symbolCircle", "fill": "#1eebb1", "stroke": "#053e4e", "stroke_width": 4, "id": 13, "ts_flags": 131072, "time": 21.082471235545125, "child_of": [18], "parent_of": [6], "x_pos_reference": 6, "label": "13/14", "x": 220.0, "fy": 278.57142857142856, "y": 278.57142857142856}, {"size": 150, "symbol": "d3.symbolCircle", "fill": "#1eebb1", "stroke": "#053e4e", "stroke_width": 4, "id": 15, "ts_flags": 131072, "time": 26.2970875934254, "child_of": [17, 22], "parent_of": [12], "x_pos_reference": 12, "label": "15/16", "x": 220.0, "fy": 264.2857142857143, "y": 264.2857142857143}, {"size": 150, "symbol": "d3.symbolCircle", "fill": "#1eebb1", "stroke": "#053e4e", "stroke_width": 4, "id": 17, "ts_flags": 0, "time": 31.677079797067897, "child_of": [20], "parent_of": [8, 15], "x_pos_reference": -1, "label": "17", "x": 220.0, "fy": 250.00000000000003, "y": 250.00000000000003}, {"size": 150, "symbol": "d3.symbolCircle", "fill": "#1eebb1", "stroke": "#053e4e", "stroke_width": 4, "id": 18, "ts_flags": 262144, "time": 38.54068895247778, "child_of": [19], "parent_of": [13], "x_pos_reference": 13, "label": "18", "x": 220.0, "fy": 235.71428571428572, "y": 235.71428571428572}, {"size": 150, "symbol": "d3.symbolCircle", "fill": "#1eebb1", "stroke": "#053e4e", "stroke_width": 4, "id": 19, "ts_flags": 0, "time": 59.05638618933358, "child_of": [21], "parent_of": [9, 18], "x_pos_reference": -1, "label": "19", "x": 220.0, "fy": 221.42857142857142, "y": 221.42857142857142}, {"size": 150, "symbol": "d3.symbolCircle", "fill": "#1eebb1", "stroke": "#053e4e", "stroke_width": 4, "id": 20, "ts_flags": 0, "time": 72.69012185541608, "child_of": [22], "parent_of": [1, 17], "x_pos_reference": -1, "label": "20", "x": 220.0, "fy": 207.14285714285714, "y": 207.14285714285714}, {"size": 150, "symbol": "d3.symbolCircle", "fill": "#1eebb1", "stroke": "#053e4e", "stroke_width": 4, "id": 21, "ts_flags": 0, "time": 75.45666603894928, "child_of": [25], "parent_of": [11, 19], "x_pos_reference": -1, "label": "21", "x": 220.0, "fy": 192.8571428571429, "y": 192.8571428571429}, {"size": 150, "symbol": "d3.symbolCircle", "fill": "#1eebb1", "stroke": "#053e4e", "stroke_width": 4, "id": 22, "ts_flags": 0, "time": 79.95768054923687, "child_of": [23], "parent_of": [15, 20], "x_pos_reference": -1, "label": "22", "x": 220.0, "fy": 178.57142857142858, "y": 178.57142857142858}, {"size": 150, "symbol": "d3.symbolCircle", "fill": "#1eebb1", "stroke": "#053e4e", "stroke_width": 4, "id": 23, "ts_flags": 131072, "time": 86.13414475042057, "child_of": [27], "parent_of": [22], "x_pos_reference": 22, "label": "23/24", "x": 220.0, "fy": 164.28571428571428, "y": 164.28571428571428}, {"size": 150, "symbol": "d3.symbolCircle", "fill": "#1eebb1", "stroke": "#053e4e", "stroke_width": 4, "id": 25, "ts_flags": 131072, "time": 92.9353141071501, "child_of": [28, 31], "parent_of": [21], "x_pos_reference": 21, "label": "25/26", "x": 220.0, "fy": 150.0, "y": 150.0}, {"size": 150, "symbol": "d3.symbolCircle", "fill": "#1eebb1", "stroke": "#053e4e", "stroke_width": 4, "id": 27, "ts_flags": 262144, "time": 101.47527788876874, "child_of": [28], "parent_of": [23], "x_pos_reference": 23, "label": "27", "x": 220.0, "fy": 135.71428571428572, "y": 135.71428571428572}, {"size": 150, "symbol": "d3.symbolCircle", "fill": "#1eebb1", "stroke": "#053e4e", "stroke_width": 4, "id": 28, "ts_flags": 0, "time": 118.0655451224718, "child_of": [29], "parent_of": [25, 27], "x_pos_reference": -1, "label": "28", "x": 220.0, "fy": 121.42857142857144, "y": 121.42857142857144}, {"size": 150, "symbol": "d3.symbolCircle", "fill": "#1eebb1", "stroke": "#053e4e", "stroke_width": 4, "id": 29, "ts_flags": 131072, "time": 165.53595810629864, "child_of": [31, 35], "parent_of": [28], "x_pos_reference": 28, "label": "29/30", "x": 220.0, "fy": 107.14285714285714, "y": 107.14285714285714}, {"size": 150, "symbol": "d3.symbolCircle", "fill": "#1eebb1", "stroke": "#053e4e", "stroke_width": 4, "id": 31, "ts_flags": 0, "time": 207.6945397219493, "child_of": [32], "parent_of": [25, 29], "x_pos_reference": -1, "label": "31", "x": 220.0, "fy": 92.85714285714286, "y": 92.85714285714286}, {"size": 150, "symbol": "d3.symbolCircle", "fill": "#1eebb1", "stroke": "#053e4e", "stroke_width": 4, "id": 32, "ts_flags": 131072, "time": 439.70842321599537, "child_of": [34], "parent_of": [31], "x_pos_reference": 31, "label": "32/33", "x": 220.0, "fy": 78.57142857142861, "y": 78.57142857142861}, {"size": 150, "symbol": "d3.symbolCircle", "fill": "#1eebb1", "stroke": "#053e4e", "stroke_width": 4, "id": 34, "ts_flags": 262144, "time": 472.32277233996615, "child_of": [35], "parent_of": [32], "x_pos_reference": 32, "label": "34", "x": 220.0, "fy": 64.2857142857143, "y": 64.2857142857143}, {"size": 150, "symbol": "d3.symbolCircle", "fill": "#1eebb1", "stroke": "#053e4e", "stroke_width": 4, "id": 35, "ts_flags": 0, "time": 645.824877737029, "child_of": [], "parent_of": [29, 34], "x_pos_reference": -1, "label": "35", "x": 220.0, "fy": 50.0, "y": 50.0}], "links": [{"id": 0, "source": 8, "source_time": 1.4619134591171952, "target": 0, "target_time": 0.0, "bounds": "0.0-10000.0", "alt_parent": -1, "alt_child": 7, "region_fraction": 1.0, "stroke": "#053e4e"}, {"id": 1, "source": 8, "source_time": 1.4619134591171952, "target": 7, "target_time": 0.0, "bounds": "0.0-10000.0", "alt_parent": -1, "alt_child": 0, "region_fraction": 1.0, "stroke": "#053e4e"}, {"id": 2, "source": 9, "source_time": 12.859594997274943, "target": 4, "target_time": 0.0, "bounds": "0.0-473.0 473.0-10000.0", "alt_parent": -1, "alt_child": -1, "region_fraction": 1.0, "stroke": "#053e4e"}, {"id": 3, "source": 11, "source_time": 16.755034405974484, "target": 5, "target_time": 0.0, "bounds": "0.0-10000.0", "alt_parent": -1, "alt_child": 9, "region_fraction": 1.0, "stroke": "#053e4e"}, {"id": 4, "source": 11, "source_time": 16.755034405974484, "target": 9, "target_time": 12.859594997274943, "bounds": "0.0-473.0", "alt_parent": 19, "alt_child": 5, "region_fraction": 0.0473, "stroke": "#053e4e"}, {"id": 5, "source": 12, "source_time": 18.935713403423676, "target": 2, "target_time": 0.0, "bounds": "0.0-10000.0", "alt_parent": -1, "alt_child": 3, "region_fraction": 1.0, "stroke": "#053e4e"}, {"id": 6, "source": 12, "source_time": 18.935713403423676, "target": 3, "target_time": 0.0, "bounds": "0.0-10000.0", "alt_parent": -1, "alt_child": 2, "region_fraction": 1.0, "stroke": "#053e4e"}, {"id": 7, "source": 13, "source_time": 21.082471235545125, "target": 6, "target_time": 0.0, "bounds": "0.0-8881.0 8881.0-10000.0", "alt_parent": -1, "alt_child": -1, "region_fraction": 1.0, "stroke": "#053e4e"}, {"id": 8, "source": 15, "source_time": 26.2970875934254, "target": 12, "target_time": 18.935713403423676, "bounds": "0.0-8092.0 8092.0-10000.0", "alt_parent": -1, "alt_child": -1, "region_fraction": 1.0, "stroke": "#053e4e"}, {"id": 9, "source": 17, "source_time": 31.677079797067897, "target": 8, "target_time": 1.4619134591171952, "bounds": "0.0-10000.0", "alt_parent": -1, "alt_child": 15, "region_fraction": 1.0, "stroke": "#053e4e"}, {"id": 10, "source": 17, "source_time": 31.677079797067897, "target": 15, "target_time": 26.2970875934254, "bounds": "8092.0-10000.0", "alt_parent": 22, "alt_child": 8, "region_fraction": 0.1908, "stroke": "#053e4e"}, {"id": 11, "source": 18, "source_time": 38.54068895247778, "target": 13, "target_time": 21.082471235545125, "bounds": "0.0-8881.0", "alt_parent": 18, "alt_child": 13, "region_fraction": 0.8881, "stroke": "#053e4e"}, {"id": 12, "source": 18, "source_time": 38.54068895247778, "target": 13, "target_time": 21.082471235545125, "bounds": "8881.0-10000.0", "alt_parent": 18, "alt_child": 13, "region_fraction": 0.1119, "stroke": "#053e4e"}, {"id": 13, "source": 19, "source_time": 59.05638618933358, "target": 9, "target_time": 12.859594997274943, "bounds": "473.0-10000.0", "alt_parent": 11, "alt_child": 18, "region_fraction": 0.9527, "stroke": "#053e4e"}, {"id": 14, "source": 19, "source_time": 59.05638618933358, "target": 18, "target_time": 38.54068895247778, "bounds": "0.0-10000.0", "alt_parent": -1, "alt_child": 9, "region_fraction": 1.0, "stroke": "#053e4e"}, {"id": 15, "source": 20, "source_time": 72.69012185541608, "target": 1, "target_time": 0.0, "bounds": "0.0-10000.0", "alt_parent": -1, "alt_child": 17, "region_fraction": 1.0, "stroke": "#053e4e"}, {"id": 16, "source": 20, "source_time": 72.69012185541608, "target": 17, "target_time": 31.677079797067897, "bounds": "0.0-10000.0", "alt_parent": -1, "alt_child": 1, "region_fraction": 1.0, "stroke": "#053e4e"}, {"id": 17, "source": 21, "source_time": 75.45666603894928, "target": 11, "target_time": 16.755034405974484, "bounds": "0.0-10000.0", "alt_parent": -1, "alt_child": 19, "region_fraction": 1.0, "stroke": "#053e4e"}, {"id": 18, "source": 21, "source_time": 75.45666603894928, "target": 19, "target_time": 59.05638618933358, "bounds": "0.0-10000.0", "alt_parent": -1, "alt_child": 11, "region_fraction": 1.0, "stroke": "#053e4e"}, {"id": 19, "source": 22, "source_time": 79.95768054923687, "target": 15, "target_time": 26.2970875934254, "bounds": "0.0-8092.0", "alt_parent": 17, "alt_child": 20, "region_fraction": 0.8092, "stroke": "#053e4e"}, {"id": 20, "source": 22, "source_time": 79.95768054923687, "target": 20, "target_time": 72.69012185541608, "bounds": "0.0-10000.0", "alt_parent": -1, "alt_child": 15, "region_fraction": 1.0, "stroke": "#053e4e"}, {"id": 21, "source": 23, "source_time": 86.13414475042057, "target": 22, "target_time": 79.95768054923687, "bounds": "0.0-3635.0 3635.0-10000.0", "alt_parent": -1, "alt_child": -1, "region_fraction": 1.0, "stroke": "#053e4e"}, {"id": 22, "source": 25, "source_time": 92.9353141071501, "target": 21, "target_time": 75.45666603894928, "bounds": "0.0-1936.0 1936.0-10000.0", "alt_parent": -1, "alt_child": -1, "region_fraction": 1.0, "stroke": "#053e4e"}, {"id": 23, "source": 27, "source_time": 101.47527788876874, "target": 23, "target_time": 86.13414475042057, "bounds": "0.0-3635.0", "alt_parent": 27, "alt_child": 23, "region_fraction": 0.3635, "stroke": "#053e4e"}, {"id": 24, "source": 27, "source_time": 101.47527788876874, "target": 23, "target_time": 86.13414475042057, "bounds": "3635.0-10000.0", "alt_parent": 27, "alt_child": 23, "region_fraction": 0.6365, "stroke": "#053e4e"}, {"id": 25, "source": 28, "source_time": 118.0655451224718, "target": 25, "target_time": 92.9353141071501, "bounds": "1936.0-10000.0", "alt_parent": 31, "alt_child": 27, "region_fraction": 0.8064, "stroke": "#053e4e"}, {"id": 26, "source": 28, "source_time": 118.0655451224718, "target": 27, "target_time": 101.47527788876874, "bounds": "0.0-10000.0", "alt_parent": -1, "alt_child": 25, "region_fraction": 1.0, "stroke": "#053e4e"}, {"id": 27, "source": 29, "source_time": 165.53595810629864, "target": 28, "target_time": 118.0655451224718, "bounds": "0.0-1423.0 1423.0-1936.0", "alt_parent": -1, "alt_child": -1, "region_fraction": 0.1936, "stroke": "#053e4e"}, {"id": 28, "source": 31, "source_time": 207.6945397219493, "target": 25, "target_time": 92.9353141071501, "bounds": "0.0-1936.0", "alt_parent": 28, "alt_child": 29, "region_fraction": 0.1936, "stroke": "#053e4e"}, {"id": 29, "source": 31, "source_time": 207.6945397219493, "target": 29, "target_time": 165.53595810629864, "bounds": "1423.0-1936.0", "alt_parent": 35, "alt_child": 25, "region_fraction": 0.0513, "stroke": "#053e4e"}, {"id": 30, "source": 32, "source_time": 439.70842321599537, "target": 31, "target_time": 207.6945397219493, "bounds": "0.0-15.0 15.0-1423.0", "alt_parent": -1, "alt_child": -1, "region_fraction": 0.1423, "stroke": "#053e4e"}, {"id": 31, "source": 34, "source_time": 472.32277233996615, "target": 32, "target_time": 439.70842321599537, "bounds": "0.0-15.0", "alt_parent": 34, "alt_child": 32, "region_fraction": 0.0015, "stroke": "#053e4e"}, {"id": 32, "source": 34, "source_time": 472.32277233996615, "target": 32, "target_time": 439.70842321599537, "bounds": "15.0-1423.0", "alt_parent": 34, "alt_child": 32, "region_fraction": 0.1408, "stroke": "#053e4e"}, {"id": 33, "source": 35, "source_time": 645.824877737029, "target": 29, "target_time": 165.53595810629864, "bounds": "0.0-1423.0", "alt_parent": 31, "alt_child": 34, "region_fraction": 0.1423, "stroke": "#053e4e"}, {"id": 34, "source": 35, "source_time": 645.824877737029, "target": 34, "target_time": 472.32277233996615, "bounds": "0.0-1423.0", "alt_parent": -1, "alt_child": 29, "region_fraction": 0.1423, "stroke": "#053e4e"}], "mutations": [], "breakpoints": [{"id": 0, "start": 0.0, "stop": 15.0, "x_pos_01": 0.0, "width_01": 0.0015, "fill": "#053e4e", "x_pos": 0.0, "width": 0.66, "included": "true"}, {"id": 1, "start": 15.0, "stop": 473.0, "x_pos_01": 0.0015, "width_01": 0.0458, "fill": "#053e4e", "x_pos": 0.66, "width": 20.152, "included": "true"}, {"id": 2, "start": 473.0, "stop": 1423.0, "x_pos_01": 0.0473, "width_01": 0.095, "fill": "#053e4e", "x_pos": 20.812, "width": 41.8, "included": "true"}, {"id": 3, "start": 1423.0, "stop": 1936.0, "x_pos_01": 0.1423, "width_01": 0.0513, "fill": "#053e4e", "x_pos": 62.612, "width": 22.572, "included": "true"}, {"id": 4, "start": 1936.0, "stop": 3635.0, "x_pos_01": 0.1936, "width_01": 0.1699, "fill": "#053e4e", "x_pos": 85.184, "width": 74.756, "included": "true"}, {"id": 5, "start": 3635.0, "stop": 8092.0, "x_pos_01": 0.3635, "width_01": 0.4457, "fill": "#053e4e", "x_pos": 159.94, "width": 196.108, "included": "true"}, {"id": 6, "start": 8092.0, "stop": 8881.0, "x_pos_01": 0.8092, "width_01": 0.0789, "fill": "#053e4e", "x_pos": 356.048, "width": 34.716, "included": "true"}, {"id": 7, "start": 8881.0, "stop": 10000.0, "x_pos_01": 0.8881, "width_01": 0.1119, "fill": "#053e4e", "x_pos": 390.764, "width": 49.236, "included": "true"}], "evenly_distributed_positions": [50.0, 99.0, 147.0, 196.0, 244.0, 293.0, 341.0, 390.0]}, 440, 475, {"include_labels": "false", "ticks": [350.0, 335.7142857142857, 321.42857142857144, 307.14285714285717, 292.8571428571429, 278.57142857142856, 264.2857142857143, 250.00000000000003, 235.71428571428572, 221.42857142857142, 207.14285714285714, 192.8571428571429, 178.57142857142858, 164.28571428571428, 150.0, 135.71428571428572, 121.42857142857144, 107.14285714285714, 92.85714285714286, 78.57142857142861, 64.2857142857143, 50.0], "text": [0, 1, 13, 17, 19, 21, 26, 32, 39, 59, 73, 75, 80, 86, 93, 101, 118, 166, 208, 440, 472, 646], "max_min": [350.0, 50.0], "scale": "rank"}, {"type": "ortho", "variable_width": false, "include_underlink": true}, false, false, true, null, false, "full", null, "{\"data\": {\"nodes\": [{\"size\": 150, \"symbol\": \"d3.symbolCircle\", \"fill\": \"#1eebb1\", \"stroke\": \"#053e4e\", \"stroke_width\": 4, \"id\": 0, \"ts_flags\": 1, \"time\": 0.0, \"child_of\": [8], \"parent_of\": [], \"x_pos_reference\": -1, \"label\": \"0\", \"fx\": 99.0, \"fy\": 350.0, \"y\": 350.0}, {\"size\": 150, \"symbol\": \"d3.symbolCircle\", \"fill\": \"#1eebb1\", \"stroke\": \"#053e4e\", \"stroke_width\": 4, \"id\": 1, \"ts_flags\": 1, \"time\": 0.0, \"child_of\": [20], \"parent_of\": [], \"x_pos_reference\": -1, \"label\": \"1\", \"fx\": 50.0, \"fy\": 350.0, \"y\": 350.0}, {\"size\": 150, \"symbol\": \"d3.symbolCircle\", \"fill\": \"#1eebb1\", \"stroke\": \"#053e4e\", \"stroke_width\": 4, \"id\": 2, \"ts_flags\": 1, \"time\": 0.0, \"child_of\": [12], \"parent_of\": [], \"x_pos_reference\": -1, \"label\": \"2\", \"fx\": 196.0, \"fy\": 350.0, \"y\": 350.0}, {\"size\": 150, \"symbol\": \"d3.symbolCircle\", \"fill\": \"#1eebb1\", \"stroke\": \"#053e4e\", \"stroke_width\": 4, \"id\": 3, \"ts_flags\": 1, \"time\": 0.0, \"child_of\": [12], \"parent_of\": [], \"x_pos_reference\": -1, \"label\": \"3\", \"fx\": 244.0, \"fy\": 350.0, \"y\": 350.0}, {\"size\": 150, \"symbol\": \"d3.symbolCircle\", \"fill\": \"#1eebb1\", \"stroke\": \"#053e4e\", \"stroke_width\": 4, \"id\": 4, \"ts_flags\": 1, \"time\": 0.0, \"child_of\": [9], \"parent_of\": [], \"x_pos_reference\": -1, \"label\": \"4\", \"fx\": 341.0, \"fy\": 350.0, \"y\": 350.0}, {\"size\": 150, \"symbol\": \"d3.symbolCircle\", \"fill\": \"#1eebb1\", \"stroke\": \"#053e4e\", \"stroke_width\": 4, \"id\": 5, \"ts_flags\": 1, \"time\": 0.0, \"child_of\": [11], \"parent_of\": [], \"x_pos_reference\": -1, \"label\": \"5\", \"fx\": 390.0, \"fy\": 350.0, \"y\": 350.0}, {\"size\": 150, \"symbol\": \"d3.symbolCircle\", \"fill\": \"#1eebb1\", \"stroke\": \"#053e4e\", \"stroke_width\": 4, \"id\": 6, \"ts_flags\": 1, \"time\": 0.0, \"child_of\": [13], \"parent_of\": [], \"x_pos_reference\": -1, \"label\": \"6\", \"fx\": 293.0, \"fy\": 350.0, \"y\": 350.0}, {\"size\": 150, \"symbol\": \"d3.symbolCircle\", \"fill\": \"#1eebb1\", \"stroke\": \"#053e4e\", \"stroke_width\": 4, \"id\": 7, \"ts_flags\": 1, \"time\": 0.0, \"child_of\": [8], \"parent_of\": [], \"x_pos_reference\": -1, \"label\": \"7\", \"fx\": 147.0, \"fy\": 350.0, \"y\": 350.0}, {\"size\": 150, \"symbol\": \"d3.symbolCircle\", \"fill\": \"#1eebb1\", \"stroke\": \"#053e4e\", \"stroke_width\": 4, \"id\": 8, \"ts_flags\": 0, \"time\": 1.4619134591171952, \"child_of\": [17], \"parent_of\": [0, 7], \"x_pos_reference\": -1, \"label\": \"8\", \"x\": 220.0, \"fy\": 335.7142857142857, \"y\": 335.7142857142857}, {\"size\": 150, \"symbol\": \"d3.symbolCircle\", \"fill\": \"#1eebb1\", \"stroke\": \"#053e4e\", \"stroke_width\": 4, \"id\": 9, \"ts_flags\": 131072, \"time\": 12.859594997274943, \"child_of\": [11, 19], \"parent_of\": [4], \"x_pos_reference\": 4, \"label\": \"9/10\", \"x\": 220.0, \"fy\": 321.42857142857144, \"y\": 321.42857142857144}, {\"size\": 150, \"symbol\": \"d3.symbolCircle\", \"fill\": \"#1eebb1\", \"stroke\": \"#053e4e\", \"stroke_width\": 4, \"id\": 11, \"ts_flags\": 0, \"time\": 16.755034405974484, \"child_of\": [21], \"parent_of\": [5, 9], \"x_pos_reference\": -1, \"label\": \"11\", \"x\": 220.0, \"fy\": 307.14285714285717, \"y\": 307.14285714285717}, {\"size\": 150, \"symbol\": \"d3.symbolCircle\", \"fill\": \"#1eebb1\", \"stroke\": \"#053e4e\", \"stroke_width\": 4, \"id\": 12, \"ts_flags\": 0, \"time\": 18.935713403423676, \"child_of\": [15], \"parent_of\": [2, 3], \"x_pos_reference\": -1, \"label\": \"12\", \"x\": 220.0, \"fy\": 292.8571428571429, \"y\": 292.8571428571429}, {\"size\": 150, \"symbol\": \"d3.symbolCircle\", \"fill\": \"#1eebb1\", \"stroke\": \"#053e4e\", \"stroke_width\": 4, \"id\": 13, \"ts_flags\": 131072, \"time\": 21.082471235545125, \"child_of\": [18], \"parent_of\": [6], \"x_pos_reference\": 6, \"label\": \"13/14\", \"x\": 220.0, \"fy\": 278.57142857142856, \"y\": 278.57142857142856}, {\"size\": 150, \"symbol\": \"d3.symbolCircle\", \"fill\": \"#1eebb1\", \"stroke\": \"#053e4e\", \"stroke_width\": 4, \"id\": 15, \"ts_flags\": 131072, \"time\": 26.2970875934254, \"child_of\": [17, 22], \"parent_of\": [12], \"x_pos_reference\": 12, \"label\": \"15/16\", \"x\": 220.0, \"fy\": 264.2857142857143, \"y\": 264.2857142857143}, {\"size\": 150, \"symbol\": \"d3.symbolCircle\", \"fill\": \"#1eebb1\", \"stroke\": \"#053e4e\", \"stroke_width\": 4, \"id\": 17, \"ts_flags\": 0, \"time\": 31.677079797067897, \"child_of\": [20], \"parent_of\": [8, 15], \"x_pos_reference\": -1, \"label\": \"17\", \"x\": 220.0, \"fy\": 250.00000000000003, \"y\": 250.00000000000003}, {\"size\": 150, \"symbol\": \"d3.symbolCircle\", \"fill\": \"#1eebb1\", \"stroke\": \"#053e4e\", \"stroke_width\": 4, \"id\": 18, \"ts_flags\": 262144, \"time\": 38.54068895247778, \"child_of\": [19], \"parent_of\": [13], \"x_pos_reference\": 13, \"label\": \"18\", \"x\": 220.0, \"fy\": 235.71428571428572, \"y\": 235.71428571428572}, {\"size\": 150, \"symbol\": \"d3.symbolCircle\", \"fill\": \"#1eebb1\", \"stroke\": \"#053e4e\", \"stroke_width\": 4, \"id\": 19, \"ts_flags\": 0, \"time\": 59.05638618933358, \"child_of\": [21], \"parent_of\": [9, 18], \"x_pos_reference\": -1, \"label\": \"19\", \"x\": 220.0, \"fy\": 221.42857142857142, \"y\": 221.42857142857142}, {\"size\": 150, \"symbol\": \"d3.symbolCircle\", \"fill\": \"#1eebb1\", \"stroke\": \"#053e4e\", \"stroke_width\": 4, \"id\": 20, \"ts_flags\": 0, \"time\": 72.69012185541608, \"child_of\": [22], \"parent_of\": [1, 17], \"x_pos_reference\": -1, \"label\": \"20\", \"x\": 220.0, \"fy\": 207.14285714285714, \"y\": 207.14285714285714}, {\"size\": 150, \"symbol\": \"d3.symbolCircle\", \"fill\": \"#1eebb1\", \"stroke\": \"#053e4e\", \"stroke_width\": 4, \"id\": 21, \"ts_flags\": 0, \"time\": 75.45666603894928, \"child_of\": [25], \"parent_of\": [11, 19], \"x_pos_reference\": -1, \"label\": \"21\", \"x\": 220.0, \"fy\": 192.8571428571429, \"y\": 192.8571428571429}, {\"size\": 150, \"symbol\": \"d3.symbolCircle\", \"fill\": \"#1eebb1\", \"stroke\": \"#053e4e\", \"stroke_width\": 4, \"id\": 22, \"ts_flags\": 0, \"time\": 79.95768054923687, \"child_of\": [23], \"parent_of\": [15, 20], \"x_pos_reference\": -1, \"label\": \"22\", \"x\": 220.0, \"fy\": 178.57142857142858, \"y\": 178.57142857142858}, {\"size\": 150, \"symbol\": \"d3.symbolCircle\", \"fill\": \"#1eebb1\", \"stroke\": \"#053e4e\", \"stroke_width\": 4, \"id\": 23, \"ts_flags\": 131072, \"time\": 86.13414475042057, \"child_of\": [27], \"parent_of\": [22], \"x_pos_reference\": 22, \"label\": \"23/24\", \"x\": 220.0, \"fy\": 164.28571428571428, \"y\": 164.28571428571428}, {\"size\": 150, \"symbol\": \"d3.symbolCircle\", \"fill\": \"#1eebb1\", \"stroke\": \"#053e4e\", \"stroke_width\": 4, \"id\": 25, \"ts_flags\": 131072, \"time\": 92.9353141071501, \"child_of\": [28, 31], \"parent_of\": [21], \"x_pos_reference\": 21, \"label\": \"25/26\", \"x\": 220.0, \"fy\": 150.0, \"y\": 150.0}, {\"size\": 150, \"symbol\": \"d3.symbolCircle\", \"fill\": \"#1eebb1\", \"stroke\": \"#053e4e\", \"stroke_width\": 4, \"id\": 27, \"ts_flags\": 262144, \"time\": 101.47527788876874, \"child_of\": [28], \"parent_of\": [23], \"x_pos_reference\": 23, \"label\": \"27\", \"x\": 220.0, \"fy\": 135.71428571428572, \"y\": 135.71428571428572}, {\"size\": 150, \"symbol\": \"d3.symbolCircle\", \"fill\": \"#1eebb1\", \"stroke\": \"#053e4e\", \"stroke_width\": 4, \"id\": 28, \"ts_flags\": 0, \"time\": 118.0655451224718, \"child_of\": [29], \"parent_of\": [25, 27], \"x_pos_reference\": -1, \"label\": \"28\", \"x\": 220.0, \"fy\": 121.42857142857144, \"y\": 121.42857142857144}, {\"size\": 150, \"symbol\": \"d3.symbolCircle\", \"fill\": \"#1eebb1\", \"stroke\": \"#053e4e\", \"stroke_width\": 4, \"id\": 29, \"ts_flags\": 131072, \"time\": 165.53595810629864, \"child_of\": [31, 35], \"parent_of\": [28], \"x_pos_reference\": 28, \"label\": \"29/30\", \"x\": 220.0, \"fy\": 107.14285714285714, \"y\": 107.14285714285714}, {\"size\": 150, \"symbol\": \"d3.symbolCircle\", \"fill\": \"#1eebb1\", \"stroke\": \"#053e4e\", \"stroke_width\": 4, \"id\": 31, \"ts_flags\": 0, \"time\": 207.6945397219493, \"child_of\": [32], \"parent_of\": [25, 29], \"x_pos_reference\": -1, \"label\": \"31\", \"x\": 220.0, \"fy\": 92.85714285714286, \"y\": 92.85714285714286}, {\"size\": 150, \"symbol\": \"d3.symbolCircle\", \"fill\": \"#1eebb1\", \"stroke\": \"#053e4e\", \"stroke_width\": 4, \"id\": 32, \"ts_flags\": 131072, \"time\": 439.70842321599537, \"child_of\": [34], \"parent_of\": [31], \"x_pos_reference\": 31, \"label\": \"32/33\", \"x\": 220.0, \"fy\": 78.57142857142861, \"y\": 78.57142857142861}, {\"size\": 150, \"symbol\": \"d3.symbolCircle\", \"fill\": \"#1eebb1\", \"stroke\": \"#053e4e\", \"stroke_width\": 4, \"id\": 34, \"ts_flags\": 262144, \"time\": 472.32277233996615, \"child_of\": [35], \"parent_of\": [32], \"x_pos_reference\": 32, \"label\": \"34\", \"x\": 220.0, \"fy\": 64.2857142857143, \"y\": 64.2857142857143}, {\"size\": 150, \"symbol\": \"d3.symbolCircle\", \"fill\": \"#1eebb1\", \"stroke\": \"#053e4e\", \"stroke_width\": 4, \"id\": 35, \"ts_flags\": 0, \"time\": 645.824877737029, \"child_of\": [], \"parent_of\": [29, 34], \"x_pos_reference\": -1, \"label\": \"35\", \"x\": 220.0, \"fy\": 50.0, \"y\": 50.0}], \"links\": [{\"id\": 0, \"source\": 8, \"source_time\": 1.4619134591171952, \"target\": 0, \"target_time\": 0.0, \"bounds\": \"0.0-10000.0\", \"alt_parent\": -1, \"alt_child\": 7, \"region_fraction\": 1.0, \"stroke\": \"#053e4e\"}, {\"id\": 1, \"source\": 8, \"source_time\": 1.4619134591171952, \"target\": 7, \"target_time\": 0.0, \"bounds\": \"0.0-10000.0\", \"alt_parent\": -1, \"alt_child\": 0, \"region_fraction\": 1.0, \"stroke\": \"#053e4e\"}, {\"id\": 2, \"source\": 9, \"source_time\": 12.859594997274943, \"target\": 4, \"target_time\": 0.0, \"bounds\": \"0.0-473.0 473.0-10000.0\", \"alt_parent\": -1, \"alt_child\": -1, \"region_fraction\": 1.0, \"stroke\": \"#053e4e\"}, {\"id\": 3, \"source\": 11, \"source_time\": 16.755034405974484, \"target\": 5, \"target_time\": 0.0, \"bounds\": \"0.0-10000.0\", \"alt_parent\": -1, \"alt_child\": 9, \"region_fraction\": 1.0, \"stroke\": \"#053e4e\"}, {\"id\": 4, \"source\": 11, \"source_time\": 16.755034405974484, \"target\": 9, \"target_time\": 12.859594997274943, \"bounds\": \"0.0-473.0\", \"alt_parent\": 19, \"alt_child\": 5, \"region_fraction\": 0.0473, \"stroke\": \"#053e4e\"}, {\"id\": 5, \"source\": 12, \"source_time\": 18.935713403423676, \"target\": 2, \"target_time\": 0.0, \"bounds\": \"0.0-10000.0\", \"alt_parent\": -1, \"alt_child\": 3, \"region_fraction\": 1.0, \"stroke\": \"#053e4e\"}, {\"id\": 6, \"source\": 12, \"source_time\": 18.935713403423676, \"target\": 3, \"target_time\": 0.0, \"bounds\": \"0.0-10000.0\", \"alt_parent\": -1, \"alt_child\": 2, \"region_fraction\": 1.0, \"stroke\": \"#053e4e\"}, {\"id\": 7, \"source\": 13, \"source_time\": 21.082471235545125, \"target\": 6, \"target_time\": 0.0, \"bounds\": \"0.0-8881.0 8881.0-10000.0\", \"alt_parent\": -1, \"alt_child\": -1, \"region_fraction\": 1.0, \"stroke\": \"#053e4e\"}, {\"id\": 8, \"source\": 15, \"source_time\": 26.2970875934254, \"target\": 12, \"target_time\": 18.935713403423676, \"bounds\": \"0.0-8092.0 8092.0-10000.0\", \"alt_parent\": -1, \"alt_child\": -1, \"region_fraction\": 1.0, \"stroke\": \"#053e4e\"}, {\"id\": 9, \"source\": 17, \"source_time\": 31.677079797067897, \"target\": 8, \"target_time\": 1.4619134591171952, \"bounds\": \"0.0-10000.0\", \"alt_parent\": -1, \"alt_child\": 15, \"region_fraction\": 1.0, \"stroke\": \"#053e4e\"}, {\"id\": 10, \"source\": 17, \"source_time\": 31.677079797067897, \"target\": 15, \"target_time\": 26.2970875934254, \"bounds\": \"8092.0-10000.0\", \"alt_parent\": 22, \"alt_child\": 8, \"region_fraction\": 0.1908, \"stroke\": \"#053e4e\"}, {\"id\": 11, \"source\": 18, \"source_time\": 38.54068895247778, \"target\": 13, \"target_time\": 21.082471235545125, \"bounds\": \"0.0-8881.0\", \"alt_parent\": 18, \"alt_child\": 13, \"region_fraction\": 0.8881, \"stroke\": \"#053e4e\"}, {\"id\": 12, \"source\": 18, \"source_time\": 38.54068895247778, \"target\": 13, \"target_time\": 21.082471235545125, \"bounds\": \"8881.0-10000.0\", \"alt_parent\": 18, \"alt_child\": 13, \"region_fraction\": 0.1119, \"stroke\": \"#053e4e\"}, {\"id\": 13, \"source\": 19, \"source_time\": 59.05638618933358, \"target\": 9, \"target_time\": 12.859594997274943, \"bounds\": \"473.0-10000.0\", \"alt_parent\": 11, \"alt_child\": 18, \"region_fraction\": 0.9527, \"stroke\": \"#053e4e\"}, {\"id\": 14, \"source\": 19, \"source_time\": 59.05638618933358, \"target\": 18, \"target_time\": 38.54068895247778, \"bounds\": \"0.0-10000.0\", \"alt_parent\": -1, \"alt_child\": 9, \"region_fraction\": 1.0, \"stroke\": \"#053e4e\"}, {\"id\": 15, \"source\": 20, \"source_time\": 72.69012185541608, \"target\": 1, \"target_time\": 0.0, \"bounds\": \"0.0-10000.0\", \"alt_parent\": -1, \"alt_child\": 17, \"region_fraction\": 1.0, \"stroke\": \"#053e4e\"}, {\"id\": 16, \"source\": 20, \"source_time\": 72.69012185541608, \"target\": 17, \"target_time\": 31.677079797067897, \"bounds\": \"0.0-10000.0\", \"alt_parent\": -1, \"alt_child\": 1, \"region_fraction\": 1.0, \"stroke\": \"#053e4e\"}, {\"id\": 17, \"source\": 21, \"source_time\": 75.45666603894928, \"target\": 11, \"target_time\": 16.755034405974484, \"bounds\": \"0.0-10000.0\", \"alt_parent\": -1, \"alt_child\": 19, \"region_fraction\": 1.0, \"stroke\": \"#053e4e\"}, {\"id\": 18, \"source\": 21, \"source_time\": 75.45666603894928, \"target\": 19, \"target_time\": 59.05638618933358, \"bounds\": \"0.0-10000.0\", \"alt_parent\": -1, \"alt_child\": 11, \"region_fraction\": 1.0, \"stroke\": \"#053e4e\"}, {\"id\": 19, \"source\": 22, \"source_time\": 79.95768054923687, \"target\": 15, \"target_time\": 26.2970875934254, \"bounds\": \"0.0-8092.0\", \"alt_parent\": 17, \"alt_child\": 20, \"region_fraction\": 0.8092, \"stroke\": \"#053e4e\"}, {\"id\": 20, \"source\": 22, \"source_time\": 79.95768054923687, \"target\": 20, \"target_time\": 72.69012185541608, \"bounds\": \"0.0-10000.0\", \"alt_parent\": -1, \"alt_child\": 15, \"region_fraction\": 1.0, \"stroke\": \"#053e4e\"}, {\"id\": 21, \"source\": 23, \"source_time\": 86.13414475042057, \"target\": 22, \"target_time\": 79.95768054923687, \"bounds\": \"0.0-3635.0 3635.0-10000.0\", \"alt_parent\": -1, \"alt_child\": -1, \"region_fraction\": 1.0, \"stroke\": \"#053e4e\"}, {\"id\": 22, \"source\": 25, \"source_time\": 92.9353141071501, \"target\": 21, \"target_time\": 75.45666603894928, \"bounds\": \"0.0-1936.0 1936.0-10000.0\", \"alt_parent\": -1, \"alt_child\": -1, \"region_fraction\": 1.0, \"stroke\": \"#053e4e\"}, {\"id\": 23, \"source\": 27, \"source_time\": 101.47527788876874, \"target\": 23, \"target_time\": 86.13414475042057, \"bounds\": \"0.0-3635.0\", \"alt_parent\": 27, \"alt_child\": 23, \"region_fraction\": 0.3635, \"stroke\": \"#053e4e\"}, {\"id\": 24, \"source\": 27, \"source_time\": 101.47527788876874, \"target\": 23, \"target_time\": 86.13414475042057, \"bounds\": \"3635.0-10000.0\", \"alt_parent\": 27, \"alt_child\": 23, \"region_fraction\": 0.6365, \"stroke\": \"#053e4e\"}, {\"id\": 25, \"source\": 28, \"source_time\": 118.0655451224718, \"target\": 25, \"target_time\": 92.9353141071501, \"bounds\": \"1936.0-10000.0\", \"alt_parent\": 31, \"alt_child\": 27, \"region_fraction\": 0.8064, \"stroke\": \"#053e4e\"}, {\"id\": 26, \"source\": 28, \"source_time\": 118.0655451224718, \"target\": 27, \"target_time\": 101.47527788876874, \"bounds\": \"0.0-10000.0\", \"alt_parent\": -1, \"alt_child\": 25, \"region_fraction\": 1.0, \"stroke\": \"#053e4e\"}, {\"id\": 27, \"source\": 29, \"source_time\": 165.53595810629864, \"target\": 28, \"target_time\": 118.0655451224718, \"bounds\": \"0.0-1423.0 1423.0-1936.0\", \"alt_parent\": -1, \"alt_child\": -1, \"region_fraction\": 0.1936, \"stroke\": \"#053e4e\"}, {\"id\": 28, \"source\": 31, \"source_time\": 207.6945397219493, \"target\": 25, \"target_time\": 92.9353141071501, \"bounds\": \"0.0-1936.0\", \"alt_parent\": 28, \"alt_child\": 29, \"region_fraction\": 0.1936, \"stroke\": \"#053e4e\"}, {\"id\": 29, \"source\": 31, \"source_time\": 207.6945397219493, \"target\": 29, \"target_time\": 165.53595810629864, \"bounds\": \"1423.0-1936.0\", \"alt_parent\": 35, \"alt_child\": 25, \"region_fraction\": 0.0513, \"stroke\": \"#053e4e\"}, {\"id\": 30, \"source\": 32, \"source_time\": 439.70842321599537, \"target\": 31, \"target_time\": 207.6945397219493, \"bounds\": \"0.0-15.0 15.0-1423.0\", \"alt_parent\": -1, \"alt_child\": -1, \"region_fraction\": 0.1423, \"stroke\": \"#053e4e\"}, {\"id\": 31, \"source\": 34, \"source_time\": 472.32277233996615, \"target\": 32, \"target_time\": 439.70842321599537, \"bounds\": \"0.0-15.0\", \"alt_parent\": 34, \"alt_child\": 32, \"region_fraction\": 0.0015, \"stroke\": \"#053e4e\"}, {\"id\": 32, \"source\": 34, \"source_time\": 472.32277233996615, \"target\": 32, \"target_time\": 439.70842321599537, \"bounds\": \"15.0-1423.0\", \"alt_parent\": 34, \"alt_child\": 32, \"region_fraction\": 0.1408, \"stroke\": \"#053e4e\"}, {\"id\": 33, \"source\": 35, \"source_time\": 645.824877737029, \"target\": 29, \"target_time\": 165.53595810629864, \"bounds\": \"0.0-1423.0\", \"alt_parent\": 31, \"alt_child\": 34, \"region_fraction\": 0.1423, \"stroke\": \"#053e4e\"}, {\"id\": 34, \"source\": 35, \"source_time\": 645.824877737029, \"target\": 34, \"target_time\": 472.32277233996615, \"bounds\": \"0.0-1423.0\", \"alt_parent\": -1, \"alt_child\": 29, \"region_fraction\": 0.1423, \"stroke\": \"#053e4e\"}], \"mutations\": [], \"breakpoints\": [{\"id\": 0, \"start\": 0.0, \"stop\": 15.0, \"x_pos_01\": 0.0, \"width_01\": 0.0015, \"fill\": \"#053e4e\", \"x_pos\": 0.0, \"width\": 0.66, \"included\": \"true\"}, {\"id\": 1, \"start\": 15.0, \"stop\": 473.0, \"x_pos_01\": 0.0015, \"width_01\": 0.0458, \"fill\": \"#053e4e\", \"x_pos\": 0.66, \"width\": 20.152, \"included\": \"true\"}, {\"id\": 2, \"start\": 473.0, \"stop\": 1423.0, \"x_pos_01\": 0.0473, \"width_01\": 0.095, \"fill\": \"#053e4e\", \"x_pos\": 20.812, \"width\": 41.8, \"included\": \"true\"}, {\"id\": 3, \"start\": 1423.0, \"stop\": 1936.0, \"x_pos_01\": 0.1423, \"width_01\": 0.0513, \"fill\": \"#053e4e\", \"x_pos\": 62.612, \"width\": 22.572, \"included\": \"true\"}, {\"id\": 4, \"start\": 1936.0, \"stop\": 3635.0, \"x_pos_01\": 0.1936, \"width_01\": 0.1699, \"fill\": \"#053e4e\", \"x_pos\": 85.184, \"width\": 74.756, \"included\": \"true\"}, {\"id\": 5, \"start\": 3635.0, \"stop\": 8092.0, \"x_pos_01\": 0.3635, \"width_01\": 0.4457, \"fill\": \"#053e4e\", \"x_pos\": 159.94, \"width\": 196.108, \"included\": \"true\"}, {\"id\": 6, \"start\": 8092.0, \"stop\": 8881.0, \"x_pos_01\": 0.8092, \"width_01\": 0.0789, \"fill\": \"#053e4e\", \"x_pos\": 356.048, \"width\": 34.716, \"included\": \"true\"}, {\"id\": 7, \"start\": 8881.0, \"stop\": 10000.0, \"x_pos_01\": 0.8881, \"width_01\": 0.1119, \"fill\": \"#053e4e\", \"x_pos\": 390.764, \"width\": 49.236, \"included\": \"true\"}], \"evenly_distributed_positions\": [50.0, 99.0, 147.0, 196.0, 244.0, 293.0, 341.0, 390.0]}, \"width\": 440, \"height\": 475, \"y_axis\": {\"include_labels\": \"false\", \"ticks\": [350.0, 335.7142857142857, 321.42857142857144, 307.14285714285717, 292.8571428571429, 278.57142857142856, 264.2857142857143, 250.00000000000003, 235.71428571428572, 221.42857142857142, 207.14285714285714, 192.8571428571429, 178.57142857142858, 164.28571428571428, 150.0, 135.71428571428572, 121.42857142857144, 107.14285714285714, 92.85714285714286, 78.57142857142861, 64.2857142857143, 50.0], \"text\": [0, 1, 13, 17, 19, 21, 26, 32, 39, 59, 73, 75, 80, 86, 93, 101, 118, 166, 208, 440, 472, 646], \"max_min\": [350.0, 50.0], \"scale\": \"rank\"}, \"edges\": {\"type\": \"ortho\", \"variable_width\": false, \"include_underlink\": true}, \"condense_mutations\": false, \"label_mutations\": false, \"tree_highlighting\": true, \"rotate_tip_labels\": false, \"plot_type\": \"full\", \"default_node_style\": {\"size\": 150, \"symbol\": \"d3.symbolCircle\", \"fill\": \"#1eebb1\", \"stroke\": \"#053e4e\", \"stroke_width\": 4}, \"title\": null, \"preamble\": null}")
        });
    })
    .catch(err => console.error('Failed to load require.js:', err));

</script>
</div>
</div>
</div><div class="column" style="width:50%;">
<div id="cell-draw-ts" class="cell" data-execution_count="2">
<div class="cell-output cell-output-display" data-execution_count="2">
<div>
<figure>
<p><a href="argintro_files/figure-revealjs/draw-ts-output-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img data-src="argintro_files/figure-revealjs/draw-ts-output-1.svg" id="draw-ts"></a></p>
</figure>
</div>
</div>
</div>
<div class="flushright">
<p><span class="smaller"><a href="https://github.com/kitchensjn/tskit_arg_visualizer" class="uri">https://github.com/kitchensjn/tskit_arg_visualizer</a> <span class="citation" data-cites="wong_GeneralEfficientRepresentation_2024">Wong et al. (<a href="#/bibliography" role="doc-biblioref" onclick="">2024</a>)</span></span></p>
</div>
</div></div>
</section>
<section id="why-args" class="slide level2 ultitle">
<h2>Why ARGs?</h2>
<div>
<p>Generalises an evolutionary “tree” to genome-wide inheritance</p>
<h4 id="understanding">Understanding</h4>
<ul>
<li>Describes the processes that generated genomic data</li>
<li>Helps to generate hypotheses</li>
</ul>
<h4 id="power">Power</h4>
<ul>
<li>“True” genealogy represents total DNA history</li>
</ul>
<h4 id="size-speed">Size &amp; Speed</h4>
<ul>
<li>Tree-like structures make algorithms fast</li>
<li>Can compress variant data: an “evolutionary encoding”</li>
</ul>
<h4 id="representation">Representation</h4>
<ul>
<li>Duality ARG - tree sequence along a genome, where a tree is defined over a non-recombining interval</li>
</ul>
<div class="flushright">
<p><em>But still early days…</em></p>
</div>
</div>
<aside class="notes">
<p>From Yan’s slides</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="of-genotype-matrices-and-genealogical-trees" class="slide level2 ultitle">
<h2>Of genotype matrices and genealogical trees</h2>
<p><a href="assets/images/ralph-2020-fig1.webp" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img data-src="assets/images/ralph-2020-fig1.webp"></a></p>
<div class="columns">
<div class="column" style="width:50%;">

</div><div class="column" style="width:50%;">
<div class="flushright">
<p><em>Efficiently Summarizing Relationships in Large Samples: A General Duality Between Statistics of Genealogies and Genomes.</em> <span class="citation" data-cites="ralph_EfficientlySummarizingRelationships_2020">Ralph et al. (<a href="#/bibliography" role="doc-biblioref" onclick="">2020</a>)</span>, Fig. 1</p>
</div>
</div></div>
<aside class="notes">
<p>Usually we summarize data in a table of genotypes (genotype matrix). The sequences are related to oneanother, a relationship that can be illustrated as a tree. By overlaying information on mutations on the tree, we can also regenerate the sequences, as shown here. Note also that the figure hints that a tree representation is a more <strong>efficient</strong> representation of the data, in addition to being more <strong>accurate</strong> and containing <strong>more information</strong> (demographic events, history, …)</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="trees-capture-biology" class="slide level2 ultitle">
<h2>Trees capture biology</h2>
<div style="display: grid; grid-template-columns: 300px 300px 300px 300px; grid-row-gap: 0px; grid-column-gap: 10px;">
<div>
<p><em>Neutral</em></p>
<div id="msprime-trees-neutral" class="cell" data-fig-format="svg" data-execution_count="3">
<svg baseprofile="full" height="500" id="neutral" version="1.1" width="300" xmlns="http://www.w3.org/2000/svg" xmlns:ev="http://www.w3.org/2001/xml-events" xlink="http://www.w3.org/1999/xlink">
<defs>
<style type="text/css">.background path {fill: #808080; fill-opacity: 0}.background path:nth-child(odd) {fill-opacity: .1}.x-regions rect {fill: yellow; stroke: black; opacity: 0.5}.axes {font-size: 14px}.x-axis .tick .lab {font-weight: bold; dominant-baseline: hanging}.axes, .tree {font-size: 14px; text-anchor: middle}.axes line, .edge {stroke: black; fill: none}.axes .ax-skip {stroke-dasharray: 4}.y-axis .grid {stroke: #FAFAFA}.node > .sym {fill: black; stroke: none}.site > .sym {stroke: black}.mut text {fill: red; font-style: italic}.mut.extra text {fill: hotpink}.mut line {fill: none; stroke: none}.mut .sym {fill: none; stroke: red}.mut.extra .sym {stroke: hotpink}.node .mut .sym {stroke-width: 1.5px}.tree text, .tree-sequence text {dominant-baseline: central}.plotbox .lab.lft {text-anchor: end}.plotbox .lab.rgt {text-anchor: start}.polytomy line {stroke: black; stroke-dasharray: 1px, 1px}.polytomy text {paint-order:stroke;stroke-width:0.3em;stroke:white}#neutral { .edge {stroke-width: 2px} }</style>
</defs><g class="tree-sequence"><g class="plotbox trees"><g class="tree t0" transform="translate(20 0)"><g class="plotbox"><g class="c2 node n38 p0 root" transform="translate(193.336 26.8)"><g class="a38 i5 leaf node n10 p0 sample" transform="translate(41.1641 431.4)"><path class="edge" d="M 0 0 V -431.4 H -41.1641"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a38 c2 node n37 p0" transform="translate(-41.1641 282.806)"><g class="a37 c2 node n35 p0" transform="translate(-53.7969 48.8946)"><g class="a35 i8 leaf node n16 p0 sample" transform="translate(26.125 99.6995)"><path class="edge" d="M 0 0 V -99.6995 H -26.125"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a35 c2 node n33 p0" transform="translate(-26.125 48.1187)"><g class="a33 c2 node n31 p0" transform="translate(-23.375 13.5573)"><g class="a31 i4 leaf node n9 p0 sample" transform="translate(9.625 38.0235)"><path class="edge" d="M 0 0 V -38.0235 H -9.625"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a31 c2 node n29 p0" transform="translate(-9.625 13.7624)"><g class="a29 i9 leaf node n18 p0 sample" transform="translate(8.25 24.2611)"><path class="edge" d="M 0 0 V -24.2611 H -8.25"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a29 c2 node n25 p0" transform="translate(-8.25 17.3827)"><g class="a25 i0 leaf node n0 p0 sample" transform="translate(-5.5 6.87839)"><path class="edge" d="M 0 0 V -6.87839 H 5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a25 i3 leaf node n6 p0 sample" transform="translate(5.5 6.87839)"><path class="edge" d="M 0 0 V -6.87839 H -5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -17.3827 H 8.25"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -13.7624 H 9.625"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -13.5573 H 23.375"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><g class="a33 c2 node n32 p0" transform="translate(23.375 4.84138)"><g class="a32 c2 node n28 p0" transform="translate(12.375 29.8754)"><g class="a28 i2 leaf node n5 p0 sample" transform="translate(-5.5 16.864)"><path class="edge" d="M 0 0 V -16.864 H 5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a28 i6 leaf node n12 p0 sample" transform="translate(5.5 16.864)"><path class="edge" d="M 0 0 V -16.864 H -5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -29.8754 H -12.375"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><g class="a32 c2 node n30 p0" transform="translate(-12.375 19.7455)"><g class="a30 i3 leaf node n7 p0 sample" transform="translate(8.25 26.9939)"><path class="edge" d="M 0 0 V -26.9939 H -8.25"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a30 c2 node n27 p0" transform="translate(-8.25 17.4322)"><g class="a27 i1 leaf node n2 p0 sample" transform="translate(-5.5 9.56172)"><path class="edge" d="M 0 0 V -9.56172 H 5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a27 i4 leaf node n8 p0 sample" transform="translate(5.5 9.56172)"><path class="edge" d="M 0 0 V -9.56172 H -5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -17.4322 H 8.25"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -19.7455 H 12.375"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -4.84138 H -23.375"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -48.1187 H 26.125"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -48.8946 H 53.7969"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><g class="a37 c2 node n36 p0" transform="translate(53.7969 38.5726)"><g class="a36 i1 leaf node n3 p0 sample" transform="translate(17.5312 110.022)"><path class="edge" d="M 0 0 V -110.022 H -17.5312"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a36 c2 node n34 p0" transform="translate(-17.5312 58.2067)"><g class="a34 c2 node n24 p0" transform="translate(-18.5625 45.0735)"><g class="a24 i7 leaf node n14 p0 sample" transform="translate(20.625 6.74142)"><path class="edge" d="M 0 0 V -6.74142 H -20.625"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a24 c2 node n23 p0" transform="translate(-20.625 3.21387)"><g class="a23 i0 leaf node n1 p0 sample" transform="translate(-13.75 3.52755)"><path class="edge" d="M 0 0 V -3.52755 H 13.75"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a23 c2 node n22 p0" transform="translate(13.75 0.52979)"><g class="a22 c2 node n20 p0" transform="translate(-11 2.85063)"><g class="a20 i2 leaf node n4 p0 sample" transform="translate(-5.5 0.147136)"><path class="edge" d="M 0 0 V -0.147136 H 5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a20 i5 leaf node n11 p0 sample" transform="translate(5.5 0.147136)"><path class="edge" d="M 0 0 V -0.147136 H -5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -2.85063 H 11"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><g class="a22 c2 node n21 p0" transform="translate(11 0.832688)"><g class="a21 i7 leaf node n15 p0 sample" transform="translate(-5.5 2.16507)"><path class="edge" d="M 0 0 V -2.16507 H 5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a21 i9 leaf node n19 p0 sample" transform="translate(5.5 2.16507)"><path class="edge" d="M 0 0 V -2.16507 H -5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -0.832688 H -11"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -0.52979 H -13.75"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -3.21387 H 20.625"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -45.0735 H 18.5625"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><g class="a34 c2 node n26 p0" transform="translate(18.5625 44.6657)"><g class="a26 i6 leaf node n13 p0 sample" transform="translate(-5.5 7.14918)"><path class="edge" d="M 0 0 V -7.14918 H 5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a26 i8 leaf node n17 p0 sample" transform="translate(5.5 7.14918)"><path class="edge" d="M 0 0 V -7.14918 H -5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -44.6657 H -18.5625"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -58.2067 H 17.5312"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -38.5726 H -53.7969"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -282.806 H 41.1641"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab" transform="translate(0 -14)"></text></g></g></g></g></g>
</svg>
</div>
</div>
<div>
<p><em>Expansion</em></p>
<div id="msprime-trees-expansion" class="cell" data-fig-format="svg" data-execution_count="4">
<svg baseprofile="full" height="500" id="expansion" version="1.1" width="300" xmlns="http://www.w3.org/2000/svg" xmlns:ev="http://www.w3.org/2001/xml-events" xlink="http://www.w3.org/1999/xlink">
<defs>
<style type="text/css">.background path {fill: #808080; fill-opacity: 0}.background path:nth-child(odd) {fill-opacity: .1}.x-regions rect {fill: yellow; stroke: black; opacity: 0.5}.axes {font-size: 14px}.x-axis .tick .lab {font-weight: bold; dominant-baseline: hanging}.axes, .tree {font-size: 14px; text-anchor: middle}.axes line, .edge {stroke: black; fill: none}.axes .ax-skip {stroke-dasharray: 4}.y-axis .grid {stroke: #FAFAFA}.node > .sym {fill: black; stroke: none}.site > .sym {stroke: black}.mut text {fill: red; font-style: italic}.mut.extra text {fill: hotpink}.mut line {fill: none; stroke: none}.mut .sym {fill: none; stroke: red}.mut.extra .sym {stroke: hotpink}.node .mut .sym {stroke-width: 1.5px}.tree text, .tree-sequence text {dominant-baseline: central}.plotbox .lab.lft {text-anchor: end}.plotbox .lab.rgt {text-anchor: start}.polytomy line {stroke: black; stroke-dasharray: 1px, 1px}.polytomy text {paint-order:stroke;stroke-width:0.3em;stroke:white}#expansion { .edge {stroke-width: 2px} }</style>
</defs><g class="tree-sequence"><g class="plotbox trees"><g class="tree t0" transform="translate(20 0)"><g class="plotbox"><g class="c2 node n38 p0 root" transform="translate(193.336 26.8)"><g class="a38 i5 leaf node n10 p0 sample" transform="translate(41.1641 431.4)"><path class="edge" d="M 0 0 V -431.4 H -41.1641"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a38 c2 node n37 p0" transform="translate(-41.1641 53.7565)"><g class="a37 c2 node n35 p0" transform="translate(-53.7969 20.1203)"><g class="a35 i8 leaf node n16 p0 sample" transform="translate(26.125 357.523)"><path class="edge" d="M 0 0 V -357.523 H -26.125"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a35 c2 node n33 p0" transform="translate(-26.125 33.2106)"><g class="a33 c2 node n31 p0" transform="translate(-23.375 15.3567)"><g class="a31 i4 leaf node n9 p0 sample" transform="translate(9.625 308.956)"><path class="edge" d="M 0 0 V -308.956 H -9.625"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a31 c2 node n29 p0" transform="translate(-9.625 22.6081)"><g class="a29 i9 leaf node n18 p0 sample" transform="translate(8.25 286.348)"><path class="edge" d="M 0 0 V -286.348 H -8.25"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a29 c2 node n25 p0" transform="translate(-8.25 63.1617)"><g class="a25 i0 leaf node n0 p0 sample" transform="translate(-5.5 223.186)"><path class="edge" d="M 0 0 V -223.186 H 5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a25 i3 leaf node n6 p0 sample" transform="translate(5.5 223.186)"><path class="edge" d="M 0 0 V -223.186 H -5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -63.1617 H 8.25"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -22.6081 H 9.625"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -15.3567 H 23.375"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><g class="a33 c2 node n32 p0" transform="translate(23.375 4.96442)"><g class="a32 c2 node n28 p0" transform="translate(12.375 51.2743)"><g class="a28 i2 leaf node n5 p0 sample" transform="translate(-5.5 268.074)"><path class="edge" d="M 0 0 V -268.074 H 5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a28 i6 leaf node n12 p0 sample" transform="translate(5.5 268.074)"><path class="edge" d="M 0 0 V -268.074 H -5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -51.2743 H -12.375"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><g class="a32 c2 node n30 p0" transform="translate(-12.375 27.6324)"><g class="a30 i3 leaf node n7 p0 sample" transform="translate(8.25 291.716)"><path class="edge" d="M 0 0 V -291.716 H -8.25"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a30 c2 node n27 p0" transform="translate(-8.25 52.0809)"><g class="a27 i1 leaf node n2 p0 sample" transform="translate(-5.5 239.635)"><path class="edge" d="M 0 0 V -239.635 H 5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a27 i4 leaf node n8 p0 sample" transform="translate(5.5 239.635)"><path class="edge" d="M 0 0 V -239.635 H -5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -52.0809 H 8.25"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -27.6324 H 12.375"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -4.96442 H -23.375"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -33.2106 H 26.125"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -20.1203 H 53.7969"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><g class="a37 c2 node n36 p0" transform="translate(53.7969 15.1537)"><g class="a36 i1 leaf node n3 p0 sample" transform="translate(17.5312 362.49)"><path class="edge" d="M 0 0 V -362.49 H -17.5312"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a36 c2 node n34 p0" transform="translate(-17.5312 37.9491)"><g class="a34 c2 node n24 p0" transform="translate(-18.5625 102.357)"><g class="a24 i7 leaf node n14 p0 sample" transform="translate(20.625 222.184)"><path class="edge" d="M 0 0 V -222.184 H -20.625"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a24 c2 node n23 p0" transform="translate(-20.625 32.1184)"><g class="a23 i0 leaf node n1 p0 sample" transform="translate(-13.75 190.065)"><path class="edge" d="M 0 0 V -190.065 H 13.75"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a23 c2 node n22 p0" transform="translate(13.75 8.00512)"><g class="a22 c2 node n20 p0" transform="translate(-11 130.793)"><g class="a20 i2 leaf node n4 p0 sample" transform="translate(-5.5 51.2667)"><path class="edge" d="M 0 0 V -51.2667 H 5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a20 i5 leaf node n11 p0 sample" transform="translate(5.5 51.2667)"><path class="edge" d="M 0 0 V -51.2667 H -5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -130.793 H 11"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><g class="a22 c2 node n21 p0" transform="translate(11 15.8954)"><g class="a21 i7 leaf node n15 p0 sample" transform="translate(-5.5 166.165)"><path class="edge" d="M 0 0 V -166.165 H 5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a21 i9 leaf node n19 p0 sample" transform="translate(5.5 166.165)"><path class="edge" d="M 0 0 V -166.165 H -5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -15.8954 H -11"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -8.00512 H -13.75"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -32.1184 H 20.625"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -102.357 H 18.5625"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><g class="a34 c2 node n26 p0" transform="translate(18.5625 99.4293)"><g class="a26 i6 leaf node n13 p0 sample" transform="translate(-5.5 225.111)"><path class="edge" d="M 0 0 V -225.111 H 5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a26 i8 leaf node n17 p0 sample" transform="translate(5.5 225.111)"><path class="edge" d="M 0 0 V -225.111 H -5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -99.4293 H -18.5625"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -37.9491 H 17.5312"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -15.1537 H -53.7969"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -53.7565 H 41.1641"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab" transform="translate(0 -14)"></text></g></g></g></g></g>
</svg>
</div>
</div>
<div>
<p><em>Bottleneck</em></p>
<div id="msprime-trees-bottleneck" class="cell" data-fig-format="svg" data-execution_count="5">
<svg baseprofile="full" height="500" id="bottleneck" version="1.1" width="300" xmlns="http://www.w3.org/2000/svg" xmlns:ev="http://www.w3.org/2001/xml-events" xlink="http://www.w3.org/1999/xlink">
<defs>
<style type="text/css">.background path {fill: #808080; fill-opacity: 0}.background path:nth-child(odd) {fill-opacity: .1}.x-regions rect {fill: yellow; stroke: black; opacity: 0.5}.axes {font-size: 14px}.x-axis .tick .lab {font-weight: bold; dominant-baseline: hanging}.axes, .tree {font-size: 14px; text-anchor: middle}.axes line, .edge {stroke: black; fill: none}.axes .ax-skip {stroke-dasharray: 4}.y-axis .grid {stroke: #FAFAFA}.node > .sym {fill: black; stroke: none}.site > .sym {stroke: black}.mut text {fill: red; font-style: italic}.mut.extra text {fill: hotpink}.mut line {fill: none; stroke: none}.mut .sym {fill: none; stroke: red}.mut.extra .sym {stroke: hotpink}.node .mut .sym {stroke-width: 1.5px}.tree text, .tree-sequence text {dominant-baseline: central}.plotbox .lab.lft {text-anchor: end}.plotbox .lab.rgt {text-anchor: start}.polytomy line {stroke: black; stroke-dasharray: 1px, 1px}.polytomy text {paint-order:stroke;stroke-width:0.3em;stroke:white}#bottleneck { .edge {stroke-width: 2px} }</style>
</defs><g class="tree-sequence"><g class="plotbox trees"><g class="tree t0" transform="translate(20 0)"><g class="plotbox"><g class="c2 node n33 p0 root" transform="translate(160.078 26.8)"><g class="a33 c4 node n27 p0" transform="translate(49.6719 398.363)"><g class="a27 i1 leaf node n2 p0 sample" transform="translate(-19.25 33.0366)"><path class="edge" d="M 0 0 V -33.0366 H 19.25"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a27 i3 leaf node n7 p0 sample" transform="translate(-8.25 33.0366)"><path class="edge" d="M 0 0 V -33.0366 H 8.25"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a27 i5 leaf node n10 p0 sample" transform="translate(2.75 33.0366)"><path class="edge" d="M 0 0 V -33.0366 H -2.75"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a27 c2 node n26 p0" transform="translate(19.25 4.74623)"><g class="a26 i6 leaf node n13 p0 sample" transform="translate(-5.5 28.2904)"><path class="edge" d="M 0 0 V -28.2904 H 5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a26 i8 leaf node n17 p0 sample" transform="translate(5.5 28.2904)"><path class="edge" d="M 0 0 V -28.2904 H -5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -4.74623 H -19.25"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -398.363 H -49.6719"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><g class="a33 c2 node n32 p0" transform="translate(-49.6719 225.91)"><g class="a32 c3 node n28 p0" transform="translate(47.7812 172.454)"><g class="a28 i4 leaf node n8 p0 sample" transform="translate(10.3125 33.0366)"><path class="edge" d="M 0 0 V -33.0366 H -10.3125"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a28 i6 leaf node n12 p0 sample" transform="translate(21.3125 33.0366)"><path class="edge" d="M 0 0 V -33.0366 H -21.3125"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a28 c2 node n24 p0" transform="translate(-21.3125 6.35979)"><g class="a24 i7 leaf node n14 p0 sample" transform="translate(20.625 26.6768)"><path class="edge" d="M 0 0 V -26.6768 H -20.625"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a24 c2 node n23 p0" transform="translate(-20.625 12.7178)"><g class="a23 i0 leaf node n1 p0 sample" transform="translate(-13.75 13.959)"><path class="edge" d="M 0 0 V -13.959 H 13.75"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a23 c2 node n22 p0" transform="translate(13.75 2.09646)"><g class="a22 c2 node n20 p0" transform="translate(-11 11.2803)"><g class="a20 i2 leaf node n4 p0 sample" transform="translate(-5.5 0.582238)"><path class="edge" d="M 0 0 V -0.582238 H 5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a20 i5 leaf node n11 p0 sample" transform="translate(5.5 0.582238)"><path class="edge" d="M 0 0 V -0.582238 H -5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -11.2803 H 11"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><g class="a22 c2 node n21 p0" transform="translate(11 3.29507)"><g class="a21 i7 leaf node n15 p0 sample" transform="translate(-5.5 8.56751)"><path class="edge" d="M 0 0 V -8.56751 H 5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a21 i9 leaf node n19 p0 sample" transform="translate(5.5 8.56751)"><path class="edge" d="M 0 0 V -8.56751 H -5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -3.29507 H -11"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -2.09646 H -13.75"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -12.7178 H 20.625"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -6.35979 H 21.3125"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -172.454 H -47.7812"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><g class="a32 c2 node n31 p0" transform="translate(-47.7812 49.8797)"><g class="a31 c3 node n29 p0" transform="translate(17.875 122.574)"><g class="a29 i1 leaf node n3 p0 sample" transform="translate(-11 33.0366)"><path class="edge" d="M 0 0 V -33.0366 H 11"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a29 i2 leaf node n5 p0 sample" transform="translate(0.0 33.0366)"><path class="edge" d="M 0 0 V -33.0366 H 0.0"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a29 i9 leaf node n18 p0 sample" transform="translate(11 33.0366)"><path class="edge" d="M 0 0 V -33.0366 H -11"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -122.574 H -17.875"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><g class="a31 c3 node n30 p0" transform="translate(-17.875 122.574)"><g class="a30 i4 leaf node n9 p0 sample" transform="translate(2.75 33.0366)"><path class="edge" d="M 0 0 V -33.0366 H -2.75"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a30 i8 leaf node n16 p0 sample" transform="translate(13.75 33.0366)"><path class="edge" d="M 0 0 V -33.0366 H -13.75"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a30 c2 node n25 p0" transform="translate(-13.75 5.8178)"><g class="a25 i0 leaf node n0 p0 sample" transform="translate(-5.5 27.2188)"><path class="edge" d="M 0 0 V -27.2188 H 5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a25 i3 leaf node n6 p0 sample" transform="translate(5.5 27.2188)"><path class="edge" d="M 0 0 V -27.2188 H -5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -5.8178 H 13.75"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -122.574 H 17.875"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -49.8797 H 47.7812"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -225.91 H 49.6719"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab" transform="translate(0 -14)"></text></g></g></g></g></g>
</svg>
</div>
</div>
<div>
<p><em>Selection</em></p>
<div id="msprime-trees-selection" class="cell" data-fig-format="svg" data-execution_count="6">
<svg baseprofile="full" height="500" id="selection" version="1.1" width="300" xmlns="http://www.w3.org/2000/svg" xmlns:ev="http://www.w3.org/2001/xml-events" xlink="http://www.w3.org/1999/xlink">
<defs>
<style type="text/css">.background path {fill: #808080; fill-opacity: 0}.background path:nth-child(odd) {fill-opacity: .1}.x-regions rect {fill: yellow; stroke: black; opacity: 0.5}.axes {font-size: 14px}.x-axis .tick .lab {font-weight: bold; dominant-baseline: hanging}.axes, .tree {font-size: 14px; text-anchor: middle}.axes line, .edge {stroke: black; fill: none}.axes .ax-skip {stroke-dasharray: 4}.y-axis .grid {stroke: #FAFAFA}.node > .sym {fill: black; stroke: none}.site > .sym {stroke: black}.mut text {fill: red; font-style: italic}.mut.extra text {fill: hotpink}.mut line {fill: none; stroke: none}.mut .sym {fill: none; stroke: red}.mut.extra .sym {stroke: hotpink}.node .mut .sym {stroke-width: 1.5px}.tree text, .tree-sequence text {dominant-baseline: central}.plotbox .lab.lft {text-anchor: end}.plotbox .lab.rgt {text-anchor: start}.polytomy line {stroke: black; stroke-dasharray: 1px, 1px}.polytomy text {paint-order:stroke;stroke-width:0.3em;stroke:white}#selection { .edge {stroke-width: 2px} }</style>
</defs><g class="tree-sequence"><g class="plotbox trees"><g class="tree t0" transform="translate(20 0)"><g class="plotbox"><g class="c2 node n38 p0 root" transform="translate(195.871 26.8)"><g class="a38 i3 leaf node n6 p0 sample" transform="translate(38.6289 431.4)"><path class="edge" d="M 0 0 V -431.4 H -38.6289"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a38 c2 node n37 p0" transform="translate(-38.6289 421.449)"><g class="a37 c2 node n35 p0" transform="translate(53.8828 0.826941)"><g class="a35 i5 leaf node n10 p0 sample" transform="translate(12.375 9.12414)"><path class="edge" d="M 0 0 V -9.12414 H -12.375"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a35 c2 node n32 p0" transform="translate(-12.375 0.541303)"><g class="a32 i4 leaf node n8 p0 sample" transform="translate(-8.25 8.58284)"><path class="edge" d="M 0 0 V -8.58284 H 8.25"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a32 c2 node n20 p0" transform="translate(8.25 8.32559)"><g class="a20 i6 leaf node n13 p0 sample" transform="translate(-5.5 0.257253)"><path class="edge" d="M 0 0 V -0.257253 H 5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a20 i8 leaf node n17 p0 sample" transform="translate(5.5 0.257253)"><path class="edge" d="M 0 0 V -0.257253 H -5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -8.32559 H -8.25"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -0.541303 H 12.375"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -0.826941 H -53.8828"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><g class="a37 c2 node n36 p0" transform="translate(-53.8828 0.122672)"><g class="a36 c2 node n33 p0" transform="translate(44.1719 1.19774)"><g class="a33 c2 node n30 p0" transform="translate(23.7188 0.276309)"><g class="a30 i3 leaf node n7 p0 sample" transform="translate(8.25 8.35437)"><path class="edge" d="M 0 0 V -8.35437 H -8.25"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a30 c2 node n24 p0" transform="translate(-8.25 1.28388)"><g class="a24 i1 leaf node n2 p0 sample" transform="translate(-5.5 7.07049)"><path class="edge" d="M 0 0 V -7.07049 H 5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a24 i9 leaf node n19 p0 sample" transform="translate(5.5 7.07049)"><path class="edge" d="M 0 0 V -7.07049 H -5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -1.28388 H 8.25"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -0.276309 H -23.7188"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><g class="a33 c2 node n31 p0" transform="translate(-23.7188 0.180236)"><g class="a31 c2 node n22 p0" transform="translate(17.1875 3.04575)"><g class="a22 i1 leaf node n3 p0 sample" transform="translate(-5.5 5.4047)"><path class="edge" d="M 0 0 V -5.4047 H 5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a22 i7 leaf node n15 p0 sample" transform="translate(5.5 5.4047)"><path class="edge" d="M 0 0 V -5.4047 H -5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -3.04575 H -17.1875"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><g class="a31 c2 node n29 p0" transform="translate(-17.1875 0.228868)"><g class="a29 c2 node n23 p0" transform="translate(12.375 1.40834)"><g class="a23 i2 leaf node n5 p0 sample" transform="translate(-5.5 6.81323)"><path class="edge" d="M 0 0 V -6.81323 H 5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a23 i4 leaf node n9 p0 sample" transform="translate(5.5 6.81323)"><path class="edge" d="M 0 0 V -6.81323 H -5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -1.40834 H -12.375"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><g class="a29 c2 node n25 p0" transform="translate(-12.375 1.13561)"><g class="a25 i9 leaf node n18 p0 sample" transform="translate(8.25 7.08597)"><path class="edge" d="M 0 0 V -7.08597 H -8.25"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a25 c2 node n21 p0" transform="translate(-8.25 4.67085)"><g class="a21 i0 leaf node n1 p0 sample" transform="translate(-5.5 2.41512)"><path class="edge" d="M 0 0 V -2.41512 H 5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a21 i6 leaf node n12 p0 sample" transform="translate(5.5 2.41512)"><path class="edge" d="M 0 0 V -2.41512 H -5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -4.67085 H 8.25"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -1.13561 H 12.375"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -0.228868 H 17.1875"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -0.180236 H 23.7188"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -1.19774 H -44.1719"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><g class="a36 c2 node n34 p0" transform="translate(-44.1719 0.705461)"><g class="a34 i2 leaf node n4 p0 sample" transform="translate(10.3125 9.12295)"><path class="edge" d="M 0 0 V -9.12295 H -10.3125"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a34 c2 node n28 p0" transform="translate(-10.3125 1.00678)"><g class="a28 i8 leaf node n16 p0 sample" transform="translate(9.625 8.11617)"><path class="edge" d="M 0 0 V -8.11617 H -9.625"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a28 c2 node n27 p0" transform="translate(-9.625 0.182022)"><g class="a27 i7 leaf node n14 p0 sample" transform="translate(8.25 7.93415)"><path class="edge" d="M 0 0 V -7.93415 H -8.25"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a27 c2 node n26 p0" transform="translate(-8.25 0.0131008)"><g class="a26 i0 leaf node n0 p0 sample" transform="translate(-5.5 7.92105)"><path class="edge" d="M 0 0 V -7.92105 H 5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a26 i5 leaf node n11 p0 sample" transform="translate(5.5 7.92105)"><path class="edge" d="M 0 0 V -7.92105 H -5.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -0.0131008 H 8.25"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -0.182022 H 9.625"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -1.00678 H 10.3125"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -0.705461 H 44.1719"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -0.122672 H 53.8828"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -421.449 H 38.6289"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab" transform="translate(0 -14)"></text></g></g></g></g></g>
</svg>
</div>
</div>
</div>
<aside class="notes">
<p>cf <a href="https://tskit.dev/tutorials/viz.html" class="uri">https://tskit.dev/tutorials/viz.html</a></p>
<p>segue: problem is that sequences recombine leading to</p>
<p>Segue: need to transition to ARGs somehow; trees are genealogies, but they change with recombination</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="msprime-stores-data-as-succinct-tree-sequences" class="slide level2 ultitle">
<h2>msprime stores data as succinct tree sequences</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="assets/images/baumdicker-2022-fig2.webp" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Tree sequences [@baumdicker_EfficientAncestryMutation_2022, Fig. 2]"><img data-src="assets/images/baumdicker-2022-fig2.webp" width="700" alt="Tree sequences (Baumdicker et al., 2022, Figure 2)"></a></p>
<figcaption>Tree sequences <span class="citation" data-cites="baumdicker_EfficientAncestryMutation_2022">(<a href="#/bibliography" role="doc-biblioref" onclick="">Baumdicker et al., 2022, Figure 2</a>)</span></figcaption>
</figure>
</div>
</section>
<section id="tree-sequences-compress-data-and-speedup-analyses" class="slide level2 ultitle">
<h2>Tree sequences compress data and speedup analyses</h2>
<div style="display: grid; grid-template-columns: 400px 140px 600px; 220:grid-row-gap: 0px; grid-column-gap: 10px;">
<div>
<ul>
<li>Compact storage (“domain specific compression”)</li>
<li>Fast, efficient analysis (a “succinct” structure)</li>
<li>Well tested, open source (active dev community)</li>
</ul>
</div>
<div class="smallr">
<p>Data compression</p>
</div>
<div>
<p><a href="assets/images/tskit-data-compression.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img data-src="assets/images/tskit-data-compression.svg" style="width:80.0%"></a></p>
</div>
<div>
<ul>
<li>Built-in functionality (well documented: <a href="http://tskit.dev" class="uri">http://tskit.dev</a>)</li>
</ul>
<div class="smallr">
<p>…but limited support for major genomic rearrangements (e.g. inversions, large indels): genomes should be (reasonably) aligned =&gt; current primary focus = <strong>population genetics</strong></p>
</div>
</div>
<div class="smallr">
<p>Speed</p>
</div>
<div>
<p><a href="assets/images/tskit-analysis-speed.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img data-src="assets/images/tskit-analysis-speed.svg" style="width:80.0%"></a></p>
</div>
<div>

</div>
<div>

</div>
<div class="smallest">
<div class="flushright">
<p>Source: <a href="https://tskit.dev/tutorials/what_is.html">What is a tree sequence? (https://tskit.dev/tutorials/what_is.html)</a></p>
</div>
</div>
</div>
</section>
<section id="tskit-terminology-the-basics" class="slide level2 ultitle">
<h2>tskit terminology: the basics</h2>
<div id="basic-tree-file" class="cell" data-fig-format="svg" data-execution_count="7">
<svg baseprofile="full" height="380" version="1.1" width="1200" xmlns="http://www.w3.org/2000/svg" xmlns:ev="http://www.w3.org/2001/xml-events" xlink="http://www.w3.org/1999/xlink">
<defs>
<style type="text/css">.background path {fill: #808080; fill-opacity: 0}.background path:nth-child(odd) {fill-opacity: .1}.x-regions rect {fill: yellow; stroke: black; opacity: 0.5}.axes {font-size: 14px}.x-axis .tick .lab {font-weight: bold; dominant-baseline: hanging}.axes, .tree {font-size: 14px; text-anchor: middle}.axes line, .edge {stroke: black; fill: none}.axes .ax-skip {stroke-dasharray: 4}.y-axis .grid {stroke: #FAFAFA}.node > .sym {fill: black; stroke: none}.site > .sym {stroke: black}.mut text {fill: red; font-style: italic}.mut.extra text {fill: hotpink}.mut line {fill: none; stroke: none}.mut .sym {fill: none; stroke: red}.mut.extra .sym {stroke: hotpink}.node .mut .sym {stroke-width: 1.5px}.tree text, .tree-sequence text {dominant-baseline: central}.plotbox .lab.lft {text-anchor: end}.plotbox .lab.rgt {text-anchor: start}.polytomy line {stroke: black; stroke-dasharray: 1px, 1px}.polytomy text {paint-order:stroke;stroke-width:0.3em;stroke:white}.node > .lab {font-size: 150%}.x-axis {font-size: 150%}.y-axis {font-size: 150%}</style>
</defs><g class="tree-sequence"><g class="background"><path d="M56.8,0 l374.4,0 l0,318.2 l-29.5776,25 l0,5 l-344.822,0 l0,-5 l0,-25 l0,-318.2z"></path><path d="M431.2,0 l374.4,0 l0,318.2 l-111.946,25 l0,5 l-292.032,0 l0,-5 l29.578,-25 l0,-318.2z"></path><path d="M805.6,0 l374.4,0 l0,318.2 l0,25 l0,5 l-486.346,0 l0,-5 l111.946,-25 l0,-318.2z"></path></g><g class="axes"><g class="x-axis"><g class="title" transform="translate(618.4 380)"><text class="lab" text-anchor="middle" transform="translate(0 -11)">Genome position</text></g><line class="ax-line" x1="56.8" x2="1180" y1="343.2" y2="343.2"></line><g class="ticks"><g class="tick" transform="translate(56.8 343.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">0</text></g></g><g class="tick" transform="translate(401.622 343.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">307</text></g></g><g class="tick" transform="translate(693.654 343.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">567</text></g></g><g class="tick" transform="translate(1180 343.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">1000</text></g></g></g></g><g class="y-axis"><g class="title" transform="translate(0 155.7)"><text class="lab" text-anchor="middle" transform="translate(11) rotate(-90)">Time ago (generations)</text></g><line class="ax-line" x1="56.8" x2="56.8" y1="301.4" y2="10"></line><g class="ticks"><g class="tick" transform="translate(56.8 301.4)"><line class="grid" x1="0" x2="1123.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">0</text></g></g><g class="tick" transform="translate(56.8 241.989)"><line class="grid" x1="0" x2="1123.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">3</text></g></g><g class="tick" transform="translate(56.8 198.635)"><line class="grid" x1="0" x2="1123.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">10</text></g></g><g class="tick" transform="translate(56.8 154.232)"><line class="grid" x1="0" x2="1123.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">30</text></g></g><g class="tick" transform="translate(56.8 103.613)"><line class="grid" x1="0" x2="1123.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">100</text></g></g><g class="tick" transform="translate(56.8 56.8149)"><line class="grid" x1="0" x2="1123.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">300</text></g></g><g class="tick" transform="translate(56.8 14.8693)"><line class="grid" x1="0" x2="1123.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">800</text></g></g></g></g></g><g class="plotbox trees"><g class="tree t0" transform="translate(56.8 0)"><g class="plotbox"><g class="c2 node n11 p0 root" transform="translate(204.617 26.8)"><g class="a11 c2 node n7 p0" transform="translate(94.05 114.459)"><g class="a7 i0 leaf node n1 p0 sample" transform="translate(-27.8667 160.141)"><path class="edge" d="M 0 0 V -160.141 H 27.8667"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">1</text></g><g class="a7 i2 leaf node n4 p0 sample" transform="translate(27.8667 160.141)"><path class="edge" d="M 0 0 V -160.141 H -27.8667"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">4</text></g><path class="edge" d="M 0 0 V -114.459 H -94.05"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">7</text></g><g class="a11 c2 node n10 p0" transform="translate(-94.05 24.6481)"><g class="a10 i0 leaf node n0 p0 sample" transform="translate(-62.7 249.952)"><path class="edge" d="M 0 0 V -249.952 H 62.7"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">0</text></g><g class="a10 c2 node n8 p0" transform="translate(62.7 65.7692)"><g class="a8 i1 leaf node n3 p0 sample" transform="translate(41.8 184.183)"><path class="edge" d="M 0 0 V -184.183 H -41.8"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">3</text></g><g class="a8 c2 node n6 p0" transform="translate(-41.8 66.1697)"><g class="a6 i1 leaf node n2 p0 sample" transform="translate(-27.8667 118.013)"><path class="edge" d="M 0 0 V -118.013 H 27.8667"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">2</text></g><g class="a6 i2 leaf node n5 p0 sample" transform="translate(27.8667 118.013)"><path class="edge" d="M 0 0 V -118.013 H -27.8667"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">5</text></g><path class="edge" d="M 0 0 V -66.1697 H 41.8"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">6</text></g><path class="edge" d="M 0 0 V -65.7692 H -62.7"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">8</text></g><path class="edge" d="M 0 0 V -24.6481 H 94.05"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">10</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab" transform="translate(0 -11)">11</text></g></g></g><g class="tree t1" transform="translate(431.2 0)"><g class="plotbox"><g class="c2 node n10 p0 root" transform="translate(187.2 51.4481)"><g class="a10 c2 node n8 p0" transform="translate(97.5333 65.7692)"><g class="a8 i1 leaf node n3 p0 sample" transform="translate(41.8 184.183)"><path class="edge" d="M 0 0 V -184.183 H -41.8"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">3</text></g><g class="a8 c2 node n6 p0" transform="translate(-41.8 66.1697)"><g class="a6 i1 leaf node n2 p0 sample" transform="translate(-27.8667 118.013)"><path class="edge" d="M 0 0 V -118.013 H 27.8667"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">2</text></g><g class="a6 i2 leaf node n5 p0 sample" transform="translate(27.8667 118.013)"><path class="edge" d="M 0 0 V -118.013 H -27.8667"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">5</text></g><path class="edge" d="M 0 0 V -66.1697 H 41.8"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">6</text></g><path class="edge" d="M 0 0 V -65.7692 H -97.5333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">8</text></g><g class="a10 c2 node n9 p0" transform="translate(-97.5333 5.76395)"><g class="a9 i0 leaf node n0 p0 sample" transform="translate(-41.8 244.188)"><path class="edge" d="M 0 0 V -244.188 H 41.8"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">0</text></g><g class="a9 c2 node n7 p0" transform="translate(41.8 84.047)"><g class="a7 i0 leaf node n1 p0 sample" transform="translate(-27.8667 160.141)"><path class="edge" d="M 0 0 V -160.141 H 27.8667"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">1</text></g><g class="a7 i2 leaf node n4 p0 sample" transform="translate(27.8667 160.141)"><path class="edge" d="M 0 0 V -160.141 H -27.8667"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">4</text></g><path class="edge" d="M 0 0 V -84.047 H -41.8"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">7</text></g><path class="edge" d="M 0 0 V -5.76395 H 97.5333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">9</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab" transform="translate(0 -11)">10</text></g></g></g><g class="tree t2" transform="translate(805.6 0)"><g class="plotbox"><g class="c2 node n11 p0 root" transform="translate(187.2 26.8)"><g class="a11 c2 node n8 p0" transform="translate(97.5333 90.4173)"><g class="a8 i1 leaf node n3 p0 sample" transform="translate(41.8 184.183)"><path class="edge" d="M 0 0 V -184.183 H -41.8"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">3</text></g><g class="a8 c2 node n6 p0" transform="translate(-41.8 66.1697)"><g class="a6 i1 leaf node n2 p0 sample" transform="translate(-27.8667 118.013)"><path class="edge" d="M 0 0 V -118.013 H 27.8667"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">2</text></g><g class="a6 i2 leaf node n5 p0 sample" transform="translate(27.8667 118.013)"><path class="edge" d="M 0 0 V -118.013 H -27.8667"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">5</text></g><path class="edge" d="M 0 0 V -66.1697 H 41.8"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">6</text></g><path class="edge" d="M 0 0 V -90.4173 H -97.5333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">8</text></g><g class="a11 c2 node n9 p0" transform="translate(-97.5333 30.4121)"><g class="a9 i0 leaf node n0 p0 sample" transform="translate(-41.8 244.188)"><path class="edge" d="M 0 0 V -244.188 H 41.8"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">0</text></g><g class="a9 c2 node n7 p0" transform="translate(41.8 84.047)"><g class="a7 i0 leaf node n1 p0 sample" transform="translate(-27.8667 160.141)"><path class="edge" d="M 0 0 V -160.141 H 27.8667"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">1</text></g><g class="a7 i2 leaf node n4 p0 sample" transform="translate(27.8667 160.141)"><path class="edge" d="M 0 0 V -160.141 H -27.8667"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">4</text></g><path class="edge" d="M 0 0 V -84.047 H -41.8"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">7</text></g><path class="edge" d="M 0 0 V -30.4121 H 97.5333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">9</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab" transform="translate(0 -11)">11</text></g></g></g></g></g>
</svg>
</div>
<div>
<ul>
<li>Multiple local trees exist along a genome of fixed length (by convention measured in base pairs)</li>
<li>Genomes exist at specific times, and arerepresented by nodes (the same node can persist across many local trees)</li>
<li>Some nodes are most recent common ancestors (MRCAs) of other nodes</li>
<li>Entities are zero-based: the rst node has id 0, the second id 1, …</li>
</ul>
</div>
<div class="flushright">
<p>Images from online tutorial “Terminology &amp; concepts” <a href="https://tskit.dev/tutorials/terminology_and_concepts.html" class="uri">https://tskit.dev/tutorials/terminology_and_concepts.html</a></p>
</div>
</section>
<section id="tskit-terminology-nodes-and-edges" class="slide level2 smallest ultitle">
<h2>tskit terminology: nodes and edges</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div id="tskit-nodes-and-edges" class="cell" data-fig-format="svg" data-execution_count="8">
<svg baseprofile="full" height="200" version="1.1" width="500" xmlns="http://www.w3.org/2000/svg" xmlns:ev="http://www.w3.org/2001/xml-events" xlink="http://www.w3.org/1999/xlink">
<defs>
<style type="text/css">.background path {fill: #808080; fill-opacity: 0}.background path:nth-child(odd) {fill-opacity: .1}.x-regions rect {fill: yellow; stroke: black; opacity: 0.5}.axes {font-size: 14px}.x-axis .tick .lab {font-weight: bold; dominant-baseline: hanging}.axes, .tree {font-size: 14px; text-anchor: middle}.axes line, .edge {stroke: black; fill: none}.axes .ax-skip {stroke-dasharray: 4}.y-axis .grid {stroke: #FAFAFA}.node > .sym {fill: black; stroke: none}.site > .sym {stroke: black}.mut text {fill: red; font-style: italic}.mut.extra text {fill: hotpink}.mut line {fill: none; stroke: none}.mut .sym {fill: none; stroke: red}.mut.extra .sym {stroke: hotpink}.node .mut .sym {stroke-width: 1.5px}.tree text, .tree-sequence text {dominant-baseline: central}.plotbox .lab.lft {text-anchor: end}.plotbox .lab.rgt {text-anchor: start}.polytomy line {stroke: black; stroke-dasharray: 1px, 1px}.polytomy text {paint-order:stroke;stroke-width:0.3em;stroke:white}.node > .lab {font-size: 75%}.x-axis {font-size: 75%}.y-axis {font-size: 75%}</style>
</defs><g class="tree-sequence"><g class="background"><path d="M56.8,0 l141.067,0 l0,138.2 l-11.1443,25 l0,5 l-129.922,0 l0,-5 l0,-25 l0,-138.2z"></path><path d="M197.867,0 l141.067,0 l0,138.2 l-42.1789,25 l0,5 l-110.032,0 l0,-5 l11.145,-25 l0,-138.2z"></path><path d="M338.933,0 l141.067,0 l0,138.2 l0,25 l0,5 l-183.246,0 l0,-5 l42.179,-25 l0,-138.2z"></path></g><g class="axes"><g class="x-axis"><g class="title" transform="translate(268.4 200)"><text class="lab" text-anchor="middle" transform="translate(0 -11)">Genome position</text></g><line class="ax-line" x1="56.8" x2="480" y1="163.2" y2="163.2"></line><g class="ticks"><g class="tick" transform="translate(56.8 163.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">0</text></g></g><g class="tick" transform="translate(186.722 163.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">307</text></g></g><g class="tick" transform="translate(296.754 163.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">567</text></g></g><g class="tick" transform="translate(480 163.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">1000</text></g></g></g></g><g class="y-axis"><g class="title" transform="translate(0 65.7)"><text class="lab" text-anchor="middle" transform="translate(11) rotate(-90)">Time ago (generations)</text></g><line class="ax-line" x1="56.8" x2="56.8" y1="121.4" y2="10"></line><g class="ticks"><g class="tick" transform="translate(56.8 121.4)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">0</text></g></g><g class="tick" transform="translate(56.8 100.933)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">3</text></g></g><g class="tick" transform="translate(56.8 85.9974)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">10</text></g></g><g class="tick" transform="translate(56.8 70.7006)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">30</text></g></g><g class="tick" transform="translate(56.8 53.2623)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">100</text></g></g><g class="tick" transform="translate(56.8 37.1402)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">300</text></g></g><g class="tick" transform="translate(56.8 19.3991)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">1000</text></g></g></g></g></g><g class="plotbox trees"><g class="tree t0" transform="translate(56.8 0)"><g class="plotbox"><g class="c2 node n11 p0 root" transform="translate(75.7972 26.8)"><g class="a11 c2 node n7 p0" transform="translate(28.425 39.4313)"><g class="a7 i0 leaf node n1 p0 sample" transform="translate(-8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">1</text></g><g class="a7 i2 leaf node n4 p0 sample" transform="translate(8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">4</text></g><path class="edge" d="M 0 0 V -39.4313 H -28.425"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">7</text></g><g class="a11 c2 node n10 p0" transform="translate(-28.425 8.49131)"><g class="a10 i0 leaf node n0 p0 sample" transform="translate(-18.95 86.1087)"><path class="edge" d="M 0 0 V -86.1087 H 18.95"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">0</text></g><g class="a10 c2 node n8 p0" transform="translate(18.95 22.6576)"><g class="a8 i1 leaf node n3 p0 sample" transform="translate(12.6333 63.4511)"><path class="edge" d="M 0 0 V -63.4511 H -12.6333"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">3</text></g><g class="a8 c2 node n6 p0" transform="translate(-12.6333 22.7955)"><g class="a6 i1 leaf node n2 p0 sample" transform="translate(-8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">2</text></g><g class="a6 i2 leaf node n5 p0 sample" transform="translate(8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">5</text></g><path class="edge" d="M 0 0 V -22.7955 H 12.6333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">6</text></g><path class="edge" d="M 0 0 V -22.6576 H -18.95"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">8</text></g><path class="edge" d="M 0 0 V -8.49131 H 28.425"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">10</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab" transform="translate(0 -11)">11</text></g></g></g><g class="tree t1" transform="translate(197.867 0)"><g class="plotbox"><g class="c2 node n10 p0 root" transform="translate(70.5333 35.2913)"><g class="a10 c2 node n8 p0" transform="translate(29.4778 22.6576)"><g class="a8 i1 leaf node n3 p0 sample" transform="translate(12.6333 63.4511)"><path class="edge" d="M 0 0 V -63.4511 H -12.6333"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">3</text></g><g class="a8 c2 node n6 p0" transform="translate(-12.6333 22.7955)"><g class="a6 i1 leaf node n2 p0 sample" transform="translate(-8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">2</text></g><g class="a6 i2 leaf node n5 p0 sample" transform="translate(8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">5</text></g><path class="edge" d="M 0 0 V -22.7955 H 12.6333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">6</text></g><path class="edge" d="M 0 0 V -22.6576 H -29.4778"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">8</text></g><g class="a10 c2 node n9 p0" transform="translate(-29.4778 1.98569)"><g class="a9 i0 leaf node n0 p0 sample" transform="translate(-12.6333 84.123)"><path class="edge" d="M 0 0 V -84.123 H 12.6333"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">0</text></g><g class="a9 c2 node n7 p0" transform="translate(12.6333 28.9543)"><g class="a7 i0 leaf node n1 p0 sample" transform="translate(-8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">1</text></g><g class="a7 i2 leaf node n4 p0 sample" transform="translate(8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">4</text></g><path class="edge" d="M 0 0 V -28.9543 H -12.6333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">7</text></g><path class="edge" d="M 0 0 V -1.98569 H 29.4778"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">9</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab" transform="translate(0 -11)">10</text></g></g></g><g class="tree t2" transform="translate(338.933 0)"><g class="plotbox"><g class="c2 node n11 p0 root" transform="translate(70.5333 26.8)"><g class="a11 c2 node n8 p0" transform="translate(29.4778 31.1489)"><g class="a8 i1 leaf node n3 p0 sample" transform="translate(12.6333 63.4511)"><path class="edge" d="M 0 0 V -63.4511 H -12.6333"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">3</text></g><g class="a8 c2 node n6 p0" transform="translate(-12.6333 22.7955)"><g class="a6 i1 leaf node n2 p0 sample" transform="translate(-8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">2</text></g><g class="a6 i2 leaf node n5 p0 sample" transform="translate(8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">5</text></g><path class="edge" d="M 0 0 V -22.7955 H 12.6333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">6</text></g><path class="edge" d="M 0 0 V -31.1489 H -29.4778"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">8</text></g><g class="a11 c2 node n9 p0" transform="translate(-29.4778 10.477)"><g class="a9 i0 leaf node n0 p0 sample" transform="translate(-12.6333 84.123)"><path class="edge" d="M 0 0 V -84.123 H 12.6333"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">0</text></g><g class="a9 c2 node n7 p0" transform="translate(12.6333 28.9543)"><g class="a7 i0 leaf node n1 p0 sample" transform="translate(-8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">1</text></g><g class="a7 i2 leaf node n4 p0 sample" transform="translate(8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">4</text></g><path class="edge" d="M 0 0 V -28.9543 H -12.6333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">7</text></g><path class="edge" d="M 0 0 V -10.477 H 29.4778"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">9</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab" transform="translate(0 -11)">11</text></g></g></g></g></g>
</svg>
</div>
<div class="fragment">
<p><strong>Nodes (=genomes)</strong></p>
<ul>
<li>exist at a specific <span class="cbppink heavy">time</span></li>
<li>can be <span class="cbpgreen heavy">flagged</span> as “samples”</li>
<li>can belong to “<span class="cbporange heavy">individuals</span>” (e.g., 2 nodes per individuals in humans) and, if useful, “<span class="cbptomato heavy">populations</span>”</li>
</ul>
<div class="small dna">
<!-- markdownlint-disable MD013 -->
<table class="caption-top">
<colgroup>
<col style="width: 19%">
<col style="width: 7%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 21%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">id</th>
<th style="text-align: right;">flags</th>
<th style="text-align: right;">population</th>
<th style="text-align: right;">individual</th>
<th style="text-align: right;"><span class="cbppink-bg">time</span></th>
<th style="text-align: right;">metadata</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00000000</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;"><span class="cbporange-bg">0</span></td>
<td style="text-align: right;">0.00000000</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;"><span class="cbporange-bg">1</span></td>
<td style="text-align: right;">0.00000000</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"><span class="cbptomato-bg">0</span></td>
<td style="text-align: right;"><span class="cbporange-bg">1</span></td>
<td style="text-align: right;">0.00000000</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"><span class="cbptomato-bg">0</span></td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.00000000</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="cbpgreen-bg">5</span></td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"><span class="cbptomato-bg">0</span></td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.00000000</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"><span class="cbpgreen-bg">6</span></td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">14.70054184</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">40.95936939</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">8</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">72.52965866</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">297.22307150</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">10</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">340.15496436</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">11</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">605.35907657</td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<!-- markdownlint-enable MD013 -->
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<p><strong>Edges</strong></p>
<ul>
<li>Connect a <span class="cbppink heavy">parent &amp; child</span></li>
<li>Have a <span class="cbpblue heavy">left &amp; right</span> genomic coordinate</li>
<li>Usually span multiple trees (e.g., edges connecting nodes 1+7 and 4+7)</li>
</ul>
<div class="small dna">
<!-- markdownlint-disable MD013-->
<table class="caption-top">
<colgroup>
<col style="width: 4%">
<col style="width: 18%">
<col style="width: 21%">
<col style="width: 23%">
<col style="width: 22%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">id</th>
<th style="text-align: right;">left</th>
<th style="text-align: right;">right</th>
<th style="text-align: right;"><span class="cbppink-bg">parent</span></th>
<th style="text-align: right;"><span class="cbppink-bg">child</span></th>
<th style="text-align: right;">metadata</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1000</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1000</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;"><span class="cbpblue-bg">0</span></td>
<td style="text-align: right;"><span class="cbpblue-bg">1000</span></td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;"><span class="cbpblue-bg">0</span></td>
<td style="text-align: right;"><span class="cbpblue-bg">1000</span></td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1000</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1000</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">307</td>
<td style="text-align: right;">1000</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: right;">307</td>
<td style="text-align: right;">1000</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">8</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">307</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">567</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">10</td>
<td style="text-align: right;">307</td>
<td style="text-align: right;">567</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">11</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">307</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">12</td>
<td style="text-align: right;">567</td>
<td style="text-align: right;">1000</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td style="text-align: right;">567</td>
<td style="text-align: right;">1000</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">14</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">307</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<!-- markdownlint-enable MD013 -->
</div>
</div>
</div></div>
</section>
<section id="tskit-terminology-sites-and-mutations" class="slide level2 ultitle">
<h2>tskit terminology: sites and mutations</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div id="tskit-sites-and-mutations-1" class="cell" data-fig-format="svg" data-execution_count="9">
<svg baseprofile="full" height="200" id="tsmut1" version="1.1" width="500" xmlns="http://www.w3.org/2000/svg" xmlns:ev="http://www.w3.org/2001/xml-events" xlink="http://www.w3.org/1999/xlink">
<defs>
<style type="text/css">.background path {fill: #808080; fill-opacity: 0}.background path:nth-child(odd) {fill-opacity: .1}.x-regions rect {fill: yellow; stroke: black; opacity: 0.5}.axes {font-size: 14px}.x-axis .tick .lab {font-weight: bold; dominant-baseline: hanging}.axes, .tree {font-size: 14px; text-anchor: middle}.axes line, .edge {stroke: black; fill: none}.axes .ax-skip {stroke-dasharray: 4}.y-axis .grid {stroke: #FAFAFA}.node > .sym {fill: black; stroke: none}.site > .sym {stroke: black}.mut text {fill: red; font-style: italic}.mut.extra text {fill: hotpink}.mut line {fill: none; stroke: none}.mut .sym {fill: none; stroke: red}.mut.extra .sym {stroke: hotpink}.node .mut .sym {stroke-width: 1.5px}.tree text, .tree-sequence text {dominant-baseline: central}.plotbox .lab.lft {text-anchor: end}.plotbox .lab.rgt {text-anchor: start}.polytomy line {stroke: black; stroke-dasharray: 1px, 1px}.polytomy text {paint-order:stroke;stroke-width:0.3em;stroke:white}#tsmut1 {.node > .lab {font-size: 75%} .x-axis {font-size: 75%} .y-axis {font-size: 75%} .mut .sym {stroke: none} .mut .lab {fill: none} .site  {stroke-width: 1px} }</style>
</defs><g class="tree-sequence"><g class="background"><path d="M56.8,0 l141.067,0 l0,138.2 l-11.1443,25 l0,5 l-129.922,0 l0,-5 l0,-25 l0,-138.2z"></path><path d="M197.867,0 l141.067,0 l0,138.2 l-42.1789,25 l0,5 l-110.032,0 l0,-5 l11.145,-25 l0,-138.2z"></path><path d="M338.933,0 l141.067,0 l0,138.2 l0,25 l0,5 l-183.246,0 l0,-5 l42.179,-25 l0,-138.2z"></path></g><g class="axes"><g class="x-axis"><g class="title" transform="translate(268.4 200)"><text class="lab" text-anchor="middle" transform="translate(0 -11)">Genome position</text></g><line class="ax-line" x1="56.8" x2="480" y1="163.2" y2="163.2"></line><g class="ticks"><g class="tick" transform="translate(56.8 163.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">0</text></g></g><g class="tick" transform="translate(186.722 163.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">307</text></g></g><g class="tick" transform="translate(296.754 163.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">567</text></g></g><g class="tick" transform="translate(480 163.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">1000</text></g></g></g><g class="site s0" transform="translate(78.8064 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m0"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s1" transform="translate(141.44 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m1"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s2" transform="translate(198.572 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m2"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s3" transform="translate(206.613 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m4"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g><g class="mut m3"><polyline class="sym" points="2.5,-10.5 0,-5.5 -2.5,-10.5"></polyline></g></g><g class="site s4" transform="translate(257.397 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m5"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s5" transform="translate(278.134 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m6"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s6" transform="translate(384.357 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m7"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s7" transform="translate(393.667 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m8"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s8" transform="translate(461.802 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m9"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g></g><g class="y-axis"><g class="title" transform="translate(0 65.7)"><text class="lab" text-anchor="middle" transform="translate(11) rotate(-90)">Time ago (generations)</text></g><line class="ax-line" x1="56.8" x2="56.8" y1="121.4" y2="10"></line><g class="ticks"><g class="tick" transform="translate(56.8 121.4)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">0</text></g></g><g class="tick" transform="translate(56.8 100.933)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">3</text></g></g><g class="tick" transform="translate(56.8 85.9974)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">10</text></g></g><g class="tick" transform="translate(56.8 70.7006)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">30</text></g></g><g class="tick" transform="translate(56.8 53.2623)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">100</text></g></g><g class="tick" transform="translate(56.8 37.1402)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">300</text></g></g><g class="tick" transform="translate(56.8 19.3991)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">1000</text></g></g></g></g></g><g class="plotbox trees"><g class="tree t0" transform="translate(56.8 0)"><g class="plotbox"><g class="c2 node n11 p0 root" transform="translate(75.7972 26.8)"><g class="a11 c2 node n7 p0" transform="translate(28.425 39.4313)"><g class="a7 i0 leaf node n1 p0 sample" transform="translate(-8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">1</text></g><g class="a7 i2 leaf node n4 p0 sample" transform="translate(8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">4</text></g><path class="edge" d="M 0 0 V -39.4313 H -28.425"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">7</text></g><g class="a11 c2 node n10 p0" transform="translate(-28.425 8.49131)"><g class="a10 i0 leaf m1 node n0 p0 s1 sample" transform="translate(-18.95 86.1087)"><path class="edge" d="M 0 0 V -86.1087 H 18.95"></path><g class="mut m1 s1" transform="translate(0 -75.8949)"><line x1="0" x2="0" y1="0" y2="75.8949"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab lft" transform="translate(-5 0)">1</text></g><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">0</text></g><g class="a10 c2 m0 node n8 p0 s0" transform="translate(18.95 22.6576)"><g class="a8 i1 leaf node n3 p0 sample" transform="translate(12.6333 63.4511)"><path class="edge" d="M 0 0 V -63.4511 H -12.6333"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">3</text></g><g class="a8 c2 node n6 p0" transform="translate(-12.6333 22.7955)"><g class="a6 i1 leaf node n2 p0 sample" transform="translate(-8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">2</text></g><g class="a6 i2 leaf node n5 p0 sample" transform="translate(8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">5</text></g><path class="edge" d="M 0 0 V -22.7955 H 12.6333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">6</text></g><path class="edge" d="M 0 0 V -22.6576 H -18.95"></path><g class="mut m0 s0" transform="translate(0 -18.0003)"><line x1="0" x2="0" y1="0" y2="18.0003"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">0</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">8</text></g><path class="edge" d="M 0 0 V -8.49131 H 28.425"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">10</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab" transform="translate(0 -11)">11</text></g></g></g><g class="tree t1" transform="translate(197.867 0)"><g class="plotbox"><g class="c2 node n10 p0 root" transform="translate(70.5333 35.2913)"><g class="a10 c2 node n8 p0" transform="translate(29.4778 22.6576)"><g class="a8 i1 leaf m2 m5 node n3 p0 s2 s4 sample" transform="translate(12.6333 63.4511)"><path class="edge" d="M 0 0 V -63.4511 H -12.6333"></path><g class="mut m5 s4" transform="translate(0 -55.7768)"><line x1="0" x2="0" y1="0" y2="55.7768"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">5</text></g><g class="mut m2 s2" transform="translate(0 -51.5519)"><line x1="0" x2="0" y1="0" y2="51.5519"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">2</text></g><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">3</text></g><g class="a8 c2 node n6 p0" transform="translate(-12.6333 22.7955)"><g class="a6 i1 leaf node n2 p0 sample" transform="translate(-8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">2</text></g><g class="a6 i2 leaf node n5 p0 sample" transform="translate(8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">5</text></g><path class="edge" d="M 0 0 V -22.7955 H 12.6333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">6</text></g><path class="edge" d="M 0 0 V -22.6576 H -29.4778"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">8</text></g><g class="a10 c2 m3 node n9 p0 s3" transform="translate(-29.4778 1.98569)"><g class="a9 i0 leaf node n0 p0 sample" transform="translate(-12.6333 84.123)"><path class="edge" d="M 0 0 V -84.123 H 12.6333"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">0</text></g><g class="a9 c2 m4 m6 node n7 p0 s3 s5" transform="translate(12.6333 28.9543)"><g class="a7 i0 leaf node n1 p0 sample" transform="translate(-8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">1</text></g><g class="a7 i2 leaf node n4 p0 sample" transform="translate(8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">4</text></g><path class="edge" d="M 0 0 V -28.9543 H -12.6333"></path><g class="mut m4 s3" transform="translate(0 -7.98068)"><line x1="0" x2="0" y1="0" y2="7.98068"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">4</text></g><g class="mut m6 s5" transform="translate(0 -4.3773)"><line x1="0" x2="0" y1="0" y2="4.3773"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">6</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">7</text></g><path class="edge" d="M 0 0 V -1.98569 H 29.4778"></path><g class="mut m3 s3" transform="translate(0 -1.37181)"><line x1="0" x2="0" y1="0" y2="1.37181"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab lft" transform="translate(-5 0)">3</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">9</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab" transform="translate(0 -11)">10</text></g></g></g><g class="tree t2" transform="translate(338.933 0)"><g class="plotbox"><g class="c2 node n11 p0 root" transform="translate(70.5333 26.8)"><g class="a11 c2 m8 node n8 p0 s7" transform="translate(29.4778 31.1489)"><g class="a8 i1 leaf node n3 p0 sample" transform="translate(12.6333 63.4511)"><path class="edge" d="M 0 0 V -63.4511 H -12.6333"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">3</text></g><g class="a8 c2 node n6 p0" transform="translate(-12.6333 22.7955)"><g class="a6 i1 leaf node n2 p0 sample" transform="translate(-8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">2</text></g><g class="a6 i2 leaf node n5 p0 sample" transform="translate(8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">5</text></g><path class="edge" d="M 0 0 V -22.7955 H 12.6333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">6</text></g><path class="edge" d="M 0 0 V -31.1489 H -29.4778"></path><g class="mut m8 s7" transform="translate(0 -12.4493)"><line x1="0" x2="0" y1="0" y2="12.4493"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">8</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">8</text></g><g class="a11 c2 node n9 p0" transform="translate(-29.4778 10.477)"><g class="a9 i0 leaf m7 m9 node n0 p0 s6 s8 sample" transform="translate(-12.6333 84.123)"><path class="edge" d="M 0 0 V -84.123 H 12.6333"></path><g class="mut m7 s6" transform="translate(0 -82.1448)"><line x1="0" x2="0" y1="0" y2="82.1448"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab lft" transform="translate(-5 0)">7</text></g><g class="mut m9 s8" transform="translate(0 -55.6922)"><line x1="0" x2="0" y1="0" y2="55.6922"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab lft" transform="translate(-5 0)">9</text></g><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">0</text></g><g class="a9 c2 node n7 p0" transform="translate(12.6333 28.9543)"><g class="a7 i0 leaf node n1 p0 sample" transform="translate(-8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">1</text></g><g class="a7 i2 leaf node n4 p0 sample" transform="translate(8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">4</text></g><path class="edge" d="M 0 0 V -28.9543 H -12.6333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">7</text></g><path class="edge" d="M 0 0 V -10.477 H 29.4778"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">9</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab" transform="translate(0 -11)">11</text></g></g></g></g></g>
</svg>
</div>
</div><div class="column" style="width:50%;">
<p>This is how we can encode genetic variation. Most genomic positions do not vary between genomes: usually we don’t bother tracking these.</p>
</div></div>
</section>
<section id="tskit-terminology-sites-and-mutations-1" class="slide level2 ultitle">
<h2>tskit terminology: sites and mutations</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div id="tskit-sites-and-mutations-2" class="cell" data-fig-format="svg" data-execution_count="10">
<svg baseprofile="full" height="200" id="tsmut2" version="1.1" width="500" xmlns="http://www.w3.org/2000/svg" xmlns:ev="http://www.w3.org/2001/xml-events" xlink="http://www.w3.org/1999/xlink">
<defs>
<style type="text/css">.background path {fill: #808080; fill-opacity: 0}.background path:nth-child(odd) {fill-opacity: .1}.x-regions rect {fill: yellow; stroke: black; opacity: 0.5}.axes {font-size: 14px}.x-axis .tick .lab {font-weight: bold; dominant-baseline: hanging}.axes, .tree {font-size: 14px; text-anchor: middle}.axes line, .edge {stroke: black; fill: none}.axes .ax-skip {stroke-dasharray: 4}.y-axis .grid {stroke: #FAFAFA}.node > .sym {fill: black; stroke: none}.site > .sym {stroke: black}.mut text {fill: red; font-style: italic}.mut.extra text {fill: hotpink}.mut line {fill: none; stroke: none}.mut .sym {fill: none; stroke: red}.mut.extra .sym {stroke: hotpink}.node .mut .sym {stroke-width: 1.5px}.tree text, .tree-sequence text {dominant-baseline: central}.plotbox .lab.lft {text-anchor: end}.plotbox .lab.rgt {text-anchor: start}.polytomy line {stroke: black; stroke-dasharray: 1px, 1px}.polytomy text {paint-order:stroke;stroke-width:0.3em;stroke:white}#tsmut2 {.node > .lab {font-size: 75%} .x-axis {font-size: 75%} .y-axis {font-size: 75%} .mut .sym {stroke: none} .mut .lab {fill: none} .site  {stroke-width: 1px} .site.s0 .sym {stroke: #D55E00; stroke-width: 3px} }</style>
</defs><g class="tree-sequence"><g class="background"><path d="M56.8,0 l141.067,0 l0,138.2 l-11.1443,25 l0,5 l-129.922,0 l0,-5 l0,-25 l0,-138.2z"></path><path d="M197.867,0 l141.067,0 l0,138.2 l-42.1789,25 l0,5 l-110.032,0 l0,-5 l11.145,-25 l0,-138.2z"></path><path d="M338.933,0 l141.067,0 l0,138.2 l0,25 l0,5 l-183.246,0 l0,-5 l42.179,-25 l0,-138.2z"></path></g><g class="axes"><g class="x-axis"><g class="title" transform="translate(268.4 200)"><text class="lab" text-anchor="middle" transform="translate(0 -11)">Genome position</text></g><line class="ax-line" x1="56.8" x2="480" y1="163.2" y2="163.2"></line><g class="ticks"><g class="tick" transform="translate(56.8 163.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">0</text></g></g><g class="tick" transform="translate(186.722 163.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">307</text></g></g><g class="tick" transform="translate(296.754 163.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">567</text></g></g><g class="tick" transform="translate(480 163.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">1000</text></g></g></g><g class="site s0" transform="translate(78.8064 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m0"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s1" transform="translate(141.44 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m1"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s2" transform="translate(198.572 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m2"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s3" transform="translate(206.613 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m4"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g><g class="mut m3"><polyline class="sym" points="2.5,-10.5 0,-5.5 -2.5,-10.5"></polyline></g></g><g class="site s4" transform="translate(257.397 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m5"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s5" transform="translate(278.134 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m6"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s6" transform="translate(384.357 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m7"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s7" transform="translate(393.667 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m8"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s8" transform="translate(461.802 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m9"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g></g><g class="y-axis"><g class="title" transform="translate(0 65.7)"><text class="lab" text-anchor="middle" transform="translate(11) rotate(-90)">Time ago (generations)</text></g><line class="ax-line" x1="56.8" x2="56.8" y1="121.4" y2="10"></line><g class="ticks"><g class="tick" transform="translate(56.8 121.4)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">0</text></g></g><g class="tick" transform="translate(56.8 100.933)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">3</text></g></g><g class="tick" transform="translate(56.8 85.9974)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">10</text></g></g><g class="tick" transform="translate(56.8 70.7006)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">30</text></g></g><g class="tick" transform="translate(56.8 53.2623)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">100</text></g></g><g class="tick" transform="translate(56.8 37.1402)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">300</text></g></g><g class="tick" transform="translate(56.8 19.3991)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">1000</text></g></g></g></g></g><g class="plotbox trees"><g class="tree t0" transform="translate(56.8 0)"><g class="plotbox"><g class="c2 node n11 p0 root" transform="translate(75.7972 26.8)"><g class="a11 c2 node n7 p0" transform="translate(28.425 39.4313)"><g class="a7 i0 leaf node n1 p0 sample" transform="translate(-8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">1</text></g><g class="a7 i2 leaf node n4 p0 sample" transform="translate(8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">4</text></g><path class="edge" d="M 0 0 V -39.4313 H -28.425"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">7</text></g><g class="a11 c2 node n10 p0" transform="translate(-28.425 8.49131)"><g class="a10 i0 leaf m1 node n0 p0 s1 sample" transform="translate(-18.95 86.1087)"><path class="edge" d="M 0 0 V -86.1087 H 18.95"></path><g class="mut m1 s1" transform="translate(0 -75.8949)"><line x1="0" x2="0" y1="0" y2="75.8949"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab lft" transform="translate(-5 0)">1</text></g><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">0</text></g><g class="a10 c2 m0 node n8 p0 s0" transform="translate(18.95 22.6576)"><g class="a8 i1 leaf node n3 p0 sample" transform="translate(12.6333 63.4511)"><path class="edge" d="M 0 0 V -63.4511 H -12.6333"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">3</text></g><g class="a8 c2 node n6 p0" transform="translate(-12.6333 22.7955)"><g class="a6 i1 leaf node n2 p0 sample" transform="translate(-8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">2</text></g><g class="a6 i2 leaf node n5 p0 sample" transform="translate(8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">5</text></g><path class="edge" d="M 0 0 V -22.7955 H 12.6333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">6</text></g><path class="edge" d="M 0 0 V -22.6576 H -18.95"></path><g class="mut m0 s0" transform="translate(0 -18.0003)"><line x1="0" x2="0" y1="0" y2="18.0003"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">0</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">8</text></g><path class="edge" d="M 0 0 V -8.49131 H 28.425"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">10</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab" transform="translate(0 -11)">11</text></g></g></g><g class="tree t1" transform="translate(197.867 0)"><g class="plotbox"><g class="c2 node n10 p0 root" transform="translate(70.5333 35.2913)"><g class="a10 c2 node n8 p0" transform="translate(29.4778 22.6576)"><g class="a8 i1 leaf m2 m5 node n3 p0 s2 s4 sample" transform="translate(12.6333 63.4511)"><path class="edge" d="M 0 0 V -63.4511 H -12.6333"></path><g class="mut m5 s4" transform="translate(0 -55.7768)"><line x1="0" x2="0" y1="0" y2="55.7768"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">5</text></g><g class="mut m2 s2" transform="translate(0 -51.5519)"><line x1="0" x2="0" y1="0" y2="51.5519"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">2</text></g><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">3</text></g><g class="a8 c2 node n6 p0" transform="translate(-12.6333 22.7955)"><g class="a6 i1 leaf node n2 p0 sample" transform="translate(-8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">2</text></g><g class="a6 i2 leaf node n5 p0 sample" transform="translate(8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">5</text></g><path class="edge" d="M 0 0 V -22.7955 H 12.6333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">6</text></g><path class="edge" d="M 0 0 V -22.6576 H -29.4778"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">8</text></g><g class="a10 c2 m3 node n9 p0 s3" transform="translate(-29.4778 1.98569)"><g class="a9 i0 leaf node n0 p0 sample" transform="translate(-12.6333 84.123)"><path class="edge" d="M 0 0 V -84.123 H 12.6333"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">0</text></g><g class="a9 c2 m4 m6 node n7 p0 s3 s5" transform="translate(12.6333 28.9543)"><g class="a7 i0 leaf node n1 p0 sample" transform="translate(-8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">1</text></g><g class="a7 i2 leaf node n4 p0 sample" transform="translate(8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">4</text></g><path class="edge" d="M 0 0 V -28.9543 H -12.6333"></path><g class="mut m4 s3" transform="translate(0 -7.98068)"><line x1="0" x2="0" y1="0" y2="7.98068"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">4</text></g><g class="mut m6 s5" transform="translate(0 -4.3773)"><line x1="0" x2="0" y1="0" y2="4.3773"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">6</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">7</text></g><path class="edge" d="M 0 0 V -1.98569 H 29.4778"></path><g class="mut m3 s3" transform="translate(0 -1.37181)"><line x1="0" x2="0" y1="0" y2="1.37181"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab lft" transform="translate(-5 0)">3</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">9</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab" transform="translate(0 -11)">10</text></g></g></g><g class="tree t2" transform="translate(338.933 0)"><g class="plotbox"><g class="c2 node n11 p0 root" transform="translate(70.5333 26.8)"><g class="a11 c2 m8 node n8 p0 s7" transform="translate(29.4778 31.1489)"><g class="a8 i1 leaf node n3 p0 sample" transform="translate(12.6333 63.4511)"><path class="edge" d="M 0 0 V -63.4511 H -12.6333"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">3</text></g><g class="a8 c2 node n6 p0" transform="translate(-12.6333 22.7955)"><g class="a6 i1 leaf node n2 p0 sample" transform="translate(-8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">2</text></g><g class="a6 i2 leaf node n5 p0 sample" transform="translate(8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">5</text></g><path class="edge" d="M 0 0 V -22.7955 H 12.6333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">6</text></g><path class="edge" d="M 0 0 V -31.1489 H -29.4778"></path><g class="mut m8 s7" transform="translate(0 -12.4493)"><line x1="0" x2="0" y1="0" y2="12.4493"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">8</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">8</text></g><g class="a11 c2 node n9 p0" transform="translate(-29.4778 10.477)"><g class="a9 i0 leaf m7 m9 node n0 p0 s6 s8 sample" transform="translate(-12.6333 84.123)"><path class="edge" d="M 0 0 V -84.123 H 12.6333"></path><g class="mut m7 s6" transform="translate(0 -82.1448)"><line x1="0" x2="0" y1="0" y2="82.1448"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab lft" transform="translate(-5 0)">7</text></g><g class="mut m9 s8" transform="translate(0 -55.6922)"><line x1="0" x2="0" y1="0" y2="55.6922"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab lft" transform="translate(-5 0)">9</text></g><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">0</text></g><g class="a9 c2 node n7 p0" transform="translate(12.6333 28.9543)"><g class="a7 i0 leaf node n1 p0 sample" transform="translate(-8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">1</text></g><g class="a7 i2 leaf node n4 p0 sample" transform="translate(8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">4</text></g><path class="edge" d="M 0 0 V -28.9543 H -12.6333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">7</text></g><path class="edge" d="M 0 0 V -10.477 H 29.4778"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">9</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab" transform="translate(0 -11)">11</text></g></g></g></g></g>
</svg>
</div>
<div>
<p>We can create a <span class="cbptomato heavy">site</span> at a given genomic <span class="cbpgreen heavy">position</span> with a fixed <span class="cbpblue heavy">ancestral state</span>.</p>
<div class="dna smallr">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: right;">id</th>
<th style="text-align: right;">position</th>
<th style="text-align: right;">ancestral_state</th>
<th style="text-align: right;">metadata</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;"><span class="cbpgreen-bg">52</span></td>
<td style="text-align: right;"><span class="cbpblue-bg">C</span></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">A</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">335</td>
<td style="text-align: right;">A</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">354</td>
<td style="text-align: right;">A</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">474</td>
<td style="text-align: right;">G</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">523</td>
<td style="text-align: right;">A</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">774</td>
<td style="text-align: right;">C</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: right;">796</td>
<td style="text-align: right;">C</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">8</td>
<td style="text-align: right;">957</td>
<td style="text-align: right;">A</td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>This is how we can encode genetic variation. Most genomic positions do not vary between genomes: usually we don’t bother tracking these.</p>
</div></div>
</section>
<section id="tskit-terminology-sites-and-mutations-2" class="slide level2 ultitle">
<h2>tskit terminology: sites and mutations</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div id="tskit-sites-and-mutations-3" class="cell" data-fig-format="svg" data-execution_count="11">
<svg baseprofile="full" height="200" id="tsmut3" version="1.1" width="500" xmlns="http://www.w3.org/2000/svg" xmlns:ev="http://www.w3.org/2001/xml-events" xlink="http://www.w3.org/1999/xlink">
<defs>
<style type="text/css">.background path {fill: #808080; fill-opacity: 0}.background path:nth-child(odd) {fill-opacity: .1}.x-regions rect {fill: yellow; stroke: black; opacity: 0.5}.axes {font-size: 14px}.x-axis .tick .lab {font-weight: bold; dominant-baseline: hanging}.axes, .tree {font-size: 14px; text-anchor: middle}.axes line, .edge {stroke: black; fill: none}.axes .ax-skip {stroke-dasharray: 4}.y-axis .grid {stroke: #FAFAFA}.node > .sym {fill: black; stroke: none}.site > .sym {stroke: black}.mut text {fill: red; font-style: italic}.mut.extra text {fill: hotpink}.mut line {fill: none; stroke: none}.mut .sym {fill: none; stroke: red}.mut.extra .sym {stroke: hotpink}.node .mut .sym {stroke-width: 1.5px}.tree text, .tree-sequence text {dominant-baseline: central}.plotbox .lab.lft {text-anchor: end}.plotbox .lab.rgt {text-anchor: start}.polytomy line {stroke: black; stroke-dasharray: 1px, 1px}.polytomy text {paint-order:stroke;stroke-width:0.3em;stroke:white}#tsmut3 {.node > .lab {font-size: 75%} .x-axis {font-size: 75%} .y-axis {font-size: 75%} .site  {stroke-width: 1px} .site.s0 .sym {stroke: #D55E00; stroke-width: 3px} }</style>
</defs><g class="tree-sequence"><g class="background"><path d="M56.8,0 l141.067,0 l0,138.2 l-11.1443,25 l0,5 l-129.922,0 l0,-5 l0,-25 l0,-138.2z"></path><path d="M197.867,0 l141.067,0 l0,138.2 l-42.1789,25 l0,5 l-110.032,0 l0,-5 l11.145,-25 l0,-138.2z"></path><path d="M338.933,0 l141.067,0 l0,138.2 l0,25 l0,5 l-183.246,0 l0,-5 l42.179,-25 l0,-138.2z"></path></g><g class="axes"><g class="x-axis"><g class="title" transform="translate(268.4 200)"><text class="lab" text-anchor="middle" transform="translate(0 -11)">Genome position</text></g><line class="ax-line" x1="56.8" x2="480" y1="163.2" y2="163.2"></line><g class="ticks"><g class="tick" transform="translate(56.8 163.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">0</text></g></g><g class="tick" transform="translate(186.722 163.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">307</text></g></g><g class="tick" transform="translate(296.754 163.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">567</text></g></g><g class="tick" transform="translate(480 163.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">1000</text></g></g></g><g class="site s0" transform="translate(78.8064 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m0"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s1" transform="translate(141.44 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m1"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s2" transform="translate(198.572 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m2"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s3" transform="translate(206.613 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m4"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g><g class="mut m3"><polyline class="sym" points="2.5,-10.5 0,-5.5 -2.5,-10.5"></polyline></g></g><g class="site s4" transform="translate(257.397 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m5"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s5" transform="translate(278.134 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m6"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s6" transform="translate(384.357 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m7"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s7" transform="translate(393.667 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m8"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s8" transform="translate(461.802 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m9"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g></g><g class="y-axis"><g class="title" transform="translate(0 65.7)"><text class="lab" text-anchor="middle" transform="translate(11) rotate(-90)">Time ago (generations)</text></g><line class="ax-line" x1="56.8" x2="56.8" y1="121.4" y2="10"></line><g class="ticks"><g class="tick" transform="translate(56.8 121.4)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">0</text></g></g><g class="tick" transform="translate(56.8 100.933)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">3</text></g></g><g class="tick" transform="translate(56.8 85.9974)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">10</text></g></g><g class="tick" transform="translate(56.8 70.7006)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">30</text></g></g><g class="tick" transform="translate(56.8 53.2623)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">100</text></g></g><g class="tick" transform="translate(56.8 37.1402)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">300</text></g></g><g class="tick" transform="translate(56.8 19.3991)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">1000</text></g></g></g></g></g><g class="plotbox trees"><g class="tree t0" transform="translate(56.8 0)"><g class="plotbox"><g class="c2 node n11 p0 root" transform="translate(75.7972 26.8)"><g class="a11 c2 node n7 p0" transform="translate(28.425 39.4313)"><g class="a7 i0 leaf node n1 p0 sample" transform="translate(-8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">1</text></g><g class="a7 i2 leaf node n4 p0 sample" transform="translate(8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">4</text></g><path class="edge" d="M 0 0 V -39.4313 H -28.425"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">7</text></g><g class="a11 c2 node n10 p0" transform="translate(-28.425 8.49131)"><g class="a10 i0 leaf m1 node n0 p0 s1 sample" transform="translate(-18.95 86.1087)"><path class="edge" d="M 0 0 V -86.1087 H 18.95"></path><g class="mut m1 s1" transform="translate(0 -75.8949)"><line x1="0" x2="0" y1="0" y2="75.8949"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab lft" transform="translate(-5 0)">1</text></g><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">0</text></g><g class="a10 c2 m0 node n8 p0 s0" transform="translate(18.95 22.6576)"><g class="a8 i1 leaf node n3 p0 sample" transform="translate(12.6333 63.4511)"><path class="edge" d="M 0 0 V -63.4511 H -12.6333"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">3</text></g><g class="a8 c2 node n6 p0" transform="translate(-12.6333 22.7955)"><g class="a6 i1 leaf node n2 p0 sample" transform="translate(-8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">2</text></g><g class="a6 i2 leaf node n5 p0 sample" transform="translate(8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">5</text></g><path class="edge" d="M 0 0 V -22.7955 H 12.6333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">6</text></g><path class="edge" d="M 0 0 V -22.6576 H -18.95"></path><g class="mut m0 s0" transform="translate(0 -18.0003)"><line x1="0" x2="0" y1="0" y2="18.0003"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">0</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">8</text></g><path class="edge" d="M 0 0 V -8.49131 H 28.425"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">10</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab" transform="translate(0 -11)">11</text></g></g></g><g class="tree t1" transform="translate(197.867 0)"><g class="plotbox"><g class="c2 node n10 p0 root" transform="translate(70.5333 35.2913)"><g class="a10 c2 node n8 p0" transform="translate(29.4778 22.6576)"><g class="a8 i1 leaf m2 m5 node n3 p0 s2 s4 sample" transform="translate(12.6333 63.4511)"><path class="edge" d="M 0 0 V -63.4511 H -12.6333"></path><g class="mut m5 s4" transform="translate(0 -55.7768)"><line x1="0" x2="0" y1="0" y2="55.7768"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">5</text></g><g class="mut m2 s2" transform="translate(0 -51.5519)"><line x1="0" x2="0" y1="0" y2="51.5519"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">2</text></g><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">3</text></g><g class="a8 c2 node n6 p0" transform="translate(-12.6333 22.7955)"><g class="a6 i1 leaf node n2 p0 sample" transform="translate(-8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">2</text></g><g class="a6 i2 leaf node n5 p0 sample" transform="translate(8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">5</text></g><path class="edge" d="M 0 0 V -22.7955 H 12.6333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">6</text></g><path class="edge" d="M 0 0 V -22.6576 H -29.4778"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">8</text></g><g class="a10 c2 m3 node n9 p0 s3" transform="translate(-29.4778 1.98569)"><g class="a9 i0 leaf node n0 p0 sample" transform="translate(-12.6333 84.123)"><path class="edge" d="M 0 0 V -84.123 H 12.6333"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">0</text></g><g class="a9 c2 m4 m6 node n7 p0 s3 s5" transform="translate(12.6333 28.9543)"><g class="a7 i0 leaf node n1 p0 sample" transform="translate(-8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">1</text></g><g class="a7 i2 leaf node n4 p0 sample" transform="translate(8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">4</text></g><path class="edge" d="M 0 0 V -28.9543 H -12.6333"></path><g class="mut m4 s3" transform="translate(0 -7.98068)"><line x1="0" x2="0" y1="0" y2="7.98068"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">4</text></g><g class="mut m6 s5" transform="translate(0 -4.3773)"><line x1="0" x2="0" y1="0" y2="4.3773"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">6</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">7</text></g><path class="edge" d="M 0 0 V -1.98569 H 29.4778"></path><g class="mut m3 s3" transform="translate(0 -1.37181)"><line x1="0" x2="0" y1="0" y2="1.37181"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab lft" transform="translate(-5 0)">3</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">9</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab" transform="translate(0 -11)">10</text></g></g></g><g class="tree t2" transform="translate(338.933 0)"><g class="plotbox"><g class="c2 node n11 p0 root" transform="translate(70.5333 26.8)"><g class="a11 c2 m8 node n8 p0 s7" transform="translate(29.4778 31.1489)"><g class="a8 i1 leaf node n3 p0 sample" transform="translate(12.6333 63.4511)"><path class="edge" d="M 0 0 V -63.4511 H -12.6333"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">3</text></g><g class="a8 c2 node n6 p0" transform="translate(-12.6333 22.7955)"><g class="a6 i1 leaf node n2 p0 sample" transform="translate(-8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">2</text></g><g class="a6 i2 leaf node n5 p0 sample" transform="translate(8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">5</text></g><path class="edge" d="M 0 0 V -22.7955 H 12.6333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">6</text></g><path class="edge" d="M 0 0 V -31.1489 H -29.4778"></path><g class="mut m8 s7" transform="translate(0 -12.4493)"><line x1="0" x2="0" y1="0" y2="12.4493"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">8</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">8</text></g><g class="a11 c2 node n9 p0" transform="translate(-29.4778 10.477)"><g class="a9 i0 leaf m7 m9 node n0 p0 s6 s8 sample" transform="translate(-12.6333 84.123)"><path class="edge" d="M 0 0 V -84.123 H 12.6333"></path><g class="mut m7 s6" transform="translate(0 -82.1448)"><line x1="0" x2="0" y1="0" y2="82.1448"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab lft" transform="translate(-5 0)">7</text></g><g class="mut m9 s8" transform="translate(0 -55.6922)"><line x1="0" x2="0" y1="0" y2="55.6922"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab lft" transform="translate(-5 0)">9</text></g><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">0</text></g><g class="a9 c2 node n7 p0" transform="translate(12.6333 28.9543)"><g class="a7 i0 leaf node n1 p0 sample" transform="translate(-8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">1</text></g><g class="a7 i2 leaf node n4 p0 sample" transform="translate(8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">4</text></g><path class="edge" d="M 0 0 V -28.9543 H -12.6333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">7</text></g><path class="edge" d="M 0 0 V -10.477 H 29.4778"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">9</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab" transform="translate(0 -11)">11</text></g></g></g></g></g>
</svg>
</div>
<div>
<p>We can create a <span class="cbptomato heavy">site</span> at a given genomic <span class="cbpgreen heavy">position</span> with a fixed <span class="cbpblue heavy">ancestral state</span>.</p>
<div class="dna smallr">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: right;">id</th>
<th style="text-align: right;">position</th>
<th style="text-align: right;">ancestral_state</th>
<th style="text-align: right;">metadata</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;"><span class="cbpgreen-bg">52</span></td>
<td style="text-align: right;"><span class="cbpblue-bg">C</span></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">A</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">335</td>
<td style="text-align: right;">A</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">354</td>
<td style="text-align: right;">A</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">474</td>
<td style="text-align: right;">G</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">523</td>
<td style="text-align: right;">A</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">774</td>
<td style="text-align: right;">C</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: right;">796</td>
<td style="text-align: right;">C</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">8</td>
<td style="text-align: right;">957</td>
<td style="text-align: right;">A</td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>This is how we can encode genetic variation. Most genomic positions do not vary between genomes: usually we don’t bother tracking these.</p>
<div>
<p>Normally, a site is created in order to place one or <span class="cbporange heavy">more</span> <span class="cbptomato heavy">mutations</span> at that site</p>
<div class="dna smallr">
<table class="caption-top">
<colgroup>
<col style="width: 5%">
<col style="width: 25%">
<col style="width: 7%">
<col style="width: 18%">
<col style="width: 19%">
<col style="width: 10%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">id</th>
<th style="text-align: right;">site</th>
<th style="text-align: right;">node</th>
<th style="text-align: right;">time</th>
<th style="text-align: right;">derived_state</th>
<th style="text-align: right;">parent</th>
<th style="text-align: right;">metadata</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">247.85988972</td>
<td style="text-align: right;">T</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">169.80687857</td>
<td style="text-align: right;">C</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">31.84262397</td>
<td style="text-align: right;">C</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;"><span class="cbporange-bg">3</span></td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">326.26095349</td>
<td style="text-align: right;">C</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;"><span class="cbporange-bg">3</span></td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">71.04212649</td>
<td style="text-align: right;">T</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">42.72352948</td>
<td style="text-align: right;">C</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">55.44045835</td>
<td style="text-align: right;">T</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">259.82567754</td>
<td style="text-align: right;">T</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">8</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">169.87040769</td>
<td style="text-align: right;">G</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">42.47396523</td>
<td style="text-align: right;">C</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div></div>
</section>
<section id="tree-sequence-inference-methods" class="slide level2 ultitle">
<h2>Tree sequence inference methods</h2>
<p><span class="fragment absolute citebox" data-fragment-index="2" style="top: 100px; left: 170px; "><strong>tsinfer/tsdate</strong></span> <span class="fragment absolute citebox" data-fragment-index="2" style="top: 150px; left: 250px; "><strong>relate</strong></span> <span class="fragment absolute citebox" data-fragment-index="1" style="top: 480px; left: 500px; "><strong>ARGweaver</strong></span> <span class="fragment absolute citebox" data-fragment-index="3" style="top: 300px; left: 470px; "><strong>SINGER</strong></span> <span class="fragment absolute citebox" data-fragment-index="4" style="top: 200px; right: 100px; "><strong>ARGNeedle</strong></span> <span class="fragment absolute citebox" data-fragment-index="4" style="top: 300px; right: 100px; "><strong>Threads</strong></span></p>
<p><span class="absolute fragment" data-fragment-index="5" style="top: 470px; right: 40px; ">Analysis of tree sequences with</span> <img data-src="https://github.com/tskit-dev/administrative/blob/main/logos/pngs/tskit/Tskit_logo.png?raw=true" class="absolute fragment" style="top: 500px; right: 100px; height: 100px; " data-fragment-index="5"></p>
<div>
<div id="cell-ts-inference-axes" class="cell" data-fig-format="svg" data-execution_count="12">
<p><a href="argintro_files/figure-revealjs/ts-inference-axes-output-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img data-src="argintro_files/figure-revealjs/ts-inference-axes-output-1.svg" id="ts-inference-axes"></a></p>
</div>
</div>
<!--

:::{.absolute top=600 left=100 style="font-size: 0.7em;" }

[^1^: @rasmussen_GenomewideInferenceAncestral_2014;]{.fragment fragment-index=1}
[^2^: @kelleher_InferringWholegenomeHistories_2019;]{.fragment fragment-index=2}
[^3^: @speidel_MethodGenomewideGenealogy_2019;]{.fragment fragment-index=2}
[^4^: @deng_RobustAccurateBayesian_2024;]{.fragment fragment-index=3}

:::

-->
<div class="absolute" style="font-size:0.8em;top: 650px; right: 0px; ">
<p>Adapted from slide by Yun Deng.</p>
</div>
<aside class="notes">
<p>From Felsenstein equation to inference? (too detailed; Simon’s version probably simpler)</p>
<p>Felsenstein: knowing P(G|D) provides information of entire evolutionary history</p>
<p>Rasmus talk: advent of NGS rendered estimation of P(G|D) difficult so summary stats / SFS-based analyses preferred.</p>
<p>Pros (Myers’ slides, Harris’ comments): summary stats</p>
<p>Seminal paper: Rasmussen (2014) showed that it actually <em>is</em> possible to infer ARGs -&gt; rapid development of new methods</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="relate" class="slide level2 ultitle">
<h2>Relate</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-left">
<figure>
<div class="quarto-figure quarto-figure-left">
<figure>
<p><a href="https://leospeidel.github.io/images/teampic/leo_riken.JPG" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Leo Speidel"><img data-src="https://leospeidel.github.io/images/teampic/leo_riken.JPG" class="quarto-figure quarto-figure-left" width="50" alt="Leo Speidel"></a></p>
</figure>
</div>
<figcaption>Leo Speidel</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p><img data-src="https://myersgroup.github.io/relate/figures/treeplot.png" style="width:70.0%" alt="Haplotypes and trees"><br>
</p>
</div>
</div>
</div>
<p><img data-src="https://media.springernature.com/full/springer-static/image/art%3A10.1038%2Fs41588-019-0484-x/MediaObjects/41588_2019_484_Fig1_HTML.png?as=webp" style="width:70.0%" alt="Relate method"><br>
</p>
<ul>
<li>fast, but limited sample sizes (1000s?)</li>
<li>good support for ancient DNA</li>
</ul>
<div class="flushright">
<p><span class="citation" data-cites="speidel_MethodGenomewideGenealogy_2019">(<a href="#/bibliography" role="doc-biblioref" onclick="">Speidel et al., 2019</a>)</span></p>
</div>
</div><div class="column" style="width:50%;">
<p><img data-src="../../slides/simulation/assets/images/speidel_mice.webp" alt="Speidel mice"><br>
</p>
<div class="flushright">
<p><span class="citation" data-cites="speidel_GenealogyEstimationThousands_2019">(<a href="#/bibliography" role="doc-biblioref" onclick="">Speidel, 2019</a>)</span></p>
</div>
</div></div>
</section>
<section id="tsinfer---tree-sequence-inference" class="slide level2 ultitle">
<h2>tsinfer - tree sequence inference</h2>
<div class="columns">
<div class="column" style="width:30%;">
<ul>
<li>fast</li>
<li>scales! (millions of samples!)</li>
<li>introduces tree sequence format</li>
<li>only genealogies, no branch lengths (but see tsdate <span class="citation" data-cites="wohns_UnifiedGenealogyModern_2022">(<a href="#/bibliography" role="doc-biblioref" onclick="">Wohns et al., 2022</a>)</span></li>
</ul>
</div><div class="column" style="width:70%;">
<p><img data-src="https://media.springernature.com/full/springer-static/image/art%3A10.1038%2Fs41588-019-0483-y/MediaObjects/41588_2019_483_Fig4_HTML.png?as=webp" class="quarto-figure quarto-figure-center" style="width:70.0%" alt="Tsinfer GNNs"><br>
</p>
<div class="flushright">
<p><span class="citation" data-cites="kelleher_InferringWholegenomeHistories_2019">(<a href="#/bibliography" role="doc-biblioref" onclick="">Kelleher et al., 2019</a>)</span></p>
</div>
</div></div>
</section>
<section id="garg-workshop-drøbak-research-station-aug-24" class="slide level2 center ultitle">
<h2>GARG workshop Drøbak research station Aug-24</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="../../slides/simulation/assets/images/gargcontent.webp" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img data-src="../../slides/simulation/assets/images/gargcontent.webp" class="quarto-figure quarto-figure-center"></a></p>
</figure>
</div>
<p style="text-align:center; font-size: 2em; line-height: 0.3;">.</p>
<p style="text-align:center; font-size: 2em; line-height: 0.3;">.</p>
<p style="text-align:center; font-size: 2em; line-height: 0.3;">.</p>
</div><div class="column" style="width:50%;">
<p><img data-src="../../slides/simulation/assets/images/PXL_20240820_100540036.webp" class="quarto-figure quarto-figure-center"> <img data-src="../../slides/simulation/assets/images/jose.webp" class="absolute" style="top: 100px; right: 50px; height: 100px; "></p>
</div></div>
<aside class="notes">
<p>Funded by EBP-NOR (Earth Biogenome Project Norway)</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="mapping-workflow-monkeyflower" class="slide level2 ultitle">
<h2>Mapping workflow Monkeyflower</h2>
<div>
<p><img data-src="../../slides/simulation/assets/images/rulegraph.svg" class="quarto-figure quarto-figure-center" height="600" alt="Rulegraph, all"><br>
</p>
</div>
</section>
<section id="tree-sequence-inference-in-monkeyflower" class="slide level2 ultitle">
<h2>Tree sequence inference in Monkeyflower</h2>
<div class="columns">
<div class="column" style="width:20%;">
<p><img data-src="../../slides/simulation/assets/images/monkeyflower-raxml.webp" alt="raxml"><br>
</p>
</div><div class="column" style="width:60%;">
<p><img data-src="../../slides/simulation/assets/images/monkeyflower-densitree.webp" alt="Densitree"><br>
</p>
<p><img data-src="../../slides/simulation/assets/images/monkeyflower-pca.svg" alt="pca"><br>
</p>
</div><div class="column fragment" style="width:20%;">
<div>
<p><img data-src="../../slides/simulation/assets/images/tsinfer.svg" class="quarto-figure quarto-figure-center" height="600" alt="Rulegraph, tsinfer"><br>
</p>
</div>
</div></div>
</section>
<section id="bibliography" class="slide level2 unnumbered unlisted smaller ultitle scrollable">
<h2>Bibliography</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-baumdicker_EfficientAncestryMutation_2022" class="csl-entry" role="listitem">
Baumdicker, F., Bisschop, G., Goldstein, D., Gower, G., Ragsdale, A. P., Tsambos, G., Zhu, S., Eldon, B., Ellerman, E. C., Galloway, J. G., Gladstein, A. L., Gorjanc, G., Guo, B., Jeffery, B., Kretzschumar, W. W., Lohse, K., Matschiner, M., Nelson, D., Pope, N. S., … Kelleher, J. (2022). Efficient ancestry and mutation simulation with msprime 1.0. <em>Genetics</em>, <em>220</em>(3), iyab229. <a href="https://doi.org/10.1093/genetics/iyab229">https://doi.org/10.1093/genetics/iyab229</a>
</div>
<div id="ref-halanych_NewViewAnimal_2004" class="csl-entry" role="listitem">
Halanych, K. M. (2004). The <span>New View</span> of <span>Animal Phylogeny</span>. <em>Annual Review of Ecology, Evolution, and Systematics</em>, <em>35</em>(Volume 35, 2004), 229–256. <a href="https://doi.org/10.1146/annurev.ecolsys.35.112202.130124">https://doi.org/10.1146/annurev.ecolsys.35.112202.130124</a>
</div>
<div id="ref-kelleher_InferringWholegenomeHistories_2019" class="csl-entry" role="listitem">
Kelleher, J., Wong, Y., Wohns, A. W., Fadil, C., Albers, P. K., &amp; McVean, G. (2019). Inferring whole-genome histories in large population datasets. <em>Nature Genetics</em>, <em>51</em>(9), 1330–1338. <a href="https://doi.org/10.1038/s41588-019-0483-y">https://doi.org/10.1038/s41588-019-0483-y</a>
</div>
<div id="ref-ralph_EfficientlySummarizingRelationships_2020" class="csl-entry" role="listitem">
Ralph, P., Thornton, K., &amp; Kelleher, J. (2020). Efficiently <span>Summarizing Relationships</span> in <span>Large Samples</span>: <span>A General Duality Between Statistics</span> of <span>Genealogies</span> and <span>Genomes</span>. <em>Genetics</em>, <em>215</em>(3), 779–797. <a href="https://doi.org/10.1534/genetics.120.303253">https://doi.org/10.1534/genetics.120.303253</a>
</div>
<div id="ref-speidel_GenealogyEstimationThousands_2019" class="csl-entry" role="listitem">
Speidel, L. (2019). <em>Genealogy estimation for thousands of samples</em> [{{Http://purl.org/dc/dcmitype/Text}}]. University of Oxford.
</div>
<div id="ref-speidel_MethodGenomewideGenealogy_2019" class="csl-entry" role="listitem">
Speidel, L., Forest, M., Shi, S., &amp; Myers, S. R. (2019). A method for genome-wide genealogy estimation for thousands of samples. <em>Nature Genetics</em>, <em>51</em>(9), 1321–1329. <a href="https://doi.org/10.1038/s41588-019-0484-x">https://doi.org/10.1038/s41588-019-0484-x</a>
</div>
<div id="ref-wohns_UnifiedGenealogyModern_2022" class="csl-entry" role="listitem">
Wohns, A. W., Wong, Y., Jeffery, B., Akbari, A., Mallick, S., Pinhasi, R., Patterson, N., Reich, D., Kelleher, J., &amp; McVean, G. (2022). A unified genealogy of modern and ancient genomes. <em>Science</em>, <em>375</em>(6583), eabi8264. <a href="https://doi.org/10.1126/science.abi8264">https://doi.org/10.1126/science.abi8264</a>
</div>
<div id="ref-wong_GeneralEfficientRepresentation_2024" class="csl-entry" role="listitem">
Wong, Y., Ignatieva, A., Koskela, J., Gorjanc, G., Wohns, A. W., &amp; Kelleher, J. (2024). A general and efficient representation of ancestral recombination graphs. <em>Genetics</em>, iyae100. <a href="https://doi.org/10.1093/genetics/iyae100">https://doi.org/10.1093/genetics/iyae100</a>
</div>
</div>


<div class="reveal-header">
<div class="header-logo-left">
<a href="https://nbisweden.github.io/workshop-pgip-H25"><img data-src="../../site_libs/quarto-contrib/quarto-project/percyfal/nbis-quarto/assets/logo/nbislogo-green-teal.svg" style="height:50px;max-width:none;"></a>
</div>
<div class="header-logo-right">
<img data-src="../../site_libs/quarto-contrib/quarto-project/percyfal/nbis-quarto/assets/logo/SciLifeLab_symbol_green.png" style="height:50px;max-width:none;">
</div>
</div>
</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">
<p>Population Genomics in Practice</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': true,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1280,

        height: 720,

        // Factor of the display size that should remain empty around the content
        margin: 8.0e-2,

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/NBISweden\.github\.io\/workshop-pgip-H25\/");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    <script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
    (function() {
      let previousOnload = window.onload;
      window.onload = () => {
        if (previousOnload) {
          previousOnload();
        }
        lightboxQuarto.on('slide_before_load', (data) => {
          const { slideIndex, slideNode, slideConfig, player, trigger } = data;
          const href = trigger.getAttribute('href');
          if (href !== null) {
            const imgEl = window.document.querySelector(`a[href="${href}"] img`);
            if (imgEl !== null) {
              const srcAttr = imgEl.getAttribute("src");
              if (srcAttr && srcAttr.startsWith("data:")) {
                slideConfig.href = srcAttr;
              }
            }
          } 
        });
      
        lightboxQuarto.on('slide_after_load', (data) => {
          const { slideIndex, slideNode, slideConfig, player, trigger } = data;
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(slideNode);
          }
        });
      
      };
      
    })();
              </script>
    

</body></html>