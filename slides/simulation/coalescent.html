<!DOCTYPE html>
<html lang="en"><head>
<link href="../../assets/logos/nbislogo-green.svg" rel="icon" type="image/svg+xml">
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-541d1840fe0299ec4c9bf9ceaf6b9fb6.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/quarto-contrib/reveal-logo-1.0.0/reveal-logo.js" defer="true"></script>
<link href="../../site_libs/quarto-contrib/reveal-logo-1.0.0/reveal-logo.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-1.2.0/all.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-1.2.0/latex-fontsize.css" rel="stylesheet">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.33">

  <meta name="author" content="Per Unneberg">
  <title>Population Genomics in Practice 2025 – Primer on the coalescent and forward simulation</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #3c3836;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #3c3836; } /* Normal */
    code span.al { color: #282828; background-color: #cc241d; font-weight: bold; } /* Alert */
    code span.an { color: #98971a; } /* Annotation */
    code span.at { color: #d79921; } /* Attribute */
    code span.bn { color: #f67400; } /* BaseN */
    code span.bu { color: #d65d0e; } /* BuiltIn */
    code span.cf { color: #cc241d; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #b16286; } /* Char */
    code span.cn { color: #b16286; font-weight: bold; } /* Constant */
    code span.co { color: #928374; } /* Comment */
    code span.cv { color: #928374; } /* CommentVar */
    code span.do { color: #98971a; } /* Documentation */
    code span.dt { color: #d79921; } /* DataType */
    code span.dv { color: #f67400; } /* DecVal */
    code span.er { color: #cc241d; text-decoration: underline; } /* Error */
    code span.ex { color: #689d6a; font-weight: bold; } /* Extension */
    code span.fl { color: #f67400; } /* Float */
    code span.fu { color: #689d6a; } /* Function */
    code span.im { color: #689d6a; } /* Import */
    code span.in { color: #282828; background-color: #83a598; } /* Information */
    code span.kw { color: #3c3836; font-weight: bold; } /* Keyword */
    code span.op { color: #3c3836; } /* Operator */
    code span.ot { color: #689d6a; } /* Other */
    code span.pp { color: #d65d0e; } /* Preprocessor */
    code span.re { color: #928374; background-color: #f9f5d7; } /* RegionMarker */
    code span.sc { color: #b16286; } /* SpecialChar */
    code span.ss { color: #98971a; } /* SpecialString */
    code span.st { color: #98971a; } /* String */
    code span.va { color: #458588; } /* Variable */
    code span.vs { color: #98971a; } /* VerbatimString */
    code span.wa { color: #282828; background-color: #fabd2f; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-dd75e976e0414ec343b1912506d158bc.css">
  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Primer on the coalescent and forward simulation</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Per Unneberg 
</div>
</div>
</div>

</section>

<section id="intended-learning-outcomes" class="slide level2 unnumbered unlisted ultitle">
<h2>Intended learning outcomes</h2>
<p>Introduction to the coalescent and simulation in msprime, with two exercises on the coalescent and msprime. The students should be able to:</p>
<ul>
<li>Describe need for simulations</li>
<li>Demonstrate the coalescent step by step</li>
<li>Detail some properties of coalescent trees</li>
<li>Define the site-frequency spectrum</li>
<li>Describe the coalescent with recombination</li>
<li>Perform simple simulations in msprime</li>
</ul>
</section>
<section id="the-wright-fisher-model-and-simulations" class="slide level2 ultitle">
<h2>The Wright-Fisher model and simulations</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-wf-model-reproductive-success-1" class="quarto-float quarto-figure quarto-figure-center" data-fig-align="center">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-wf-model-reproductive-success-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="coalescent_files/figure-revealjs/fig-wf-model-reproductive-success-1-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Wright-Fisher model for 50 generations, 30 individuals"><img data-src="coalescent_files/figure-revealjs/fig-wf-model-reproductive-success-1-1.svg" class="quarto-figure quarto-figure-center" style="width:70.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-wf-model-reproductive-success-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Wright-Fisher model for 50 generations, 30 individuals
</figcaption>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<aside class="notes">

<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<h3 class="ultitle" id="recap">Recap</h3>
<p>Model of a population describing <strong>genealogies</strong> under the following assumptions</p>
<ul>
<li>discrete and non-overlapping generations</li>
<li>haploid individuals or two subpopulations (males and females)</li>
<li>constant population size</li>
<li>all individuals are equally fit</li>
<li>population has no geographical or social structure</li>
<li>no recombination</li>
</ul>
<div class="fragment">
<p><strong>Forward</strong> simulation</p>
</div>
</div></div>
<aside class="notes">
<p><span class="citation" data-cites="hein2005gene">(p.&nbsp;15 <a href="#/bibliography" role="doc-biblioref" onclick="">Hein et al., 2005</a>)</span> shows the fraction of genes without descendants. Focus on the number of descendants for <em>one</em> gene <em>i</em>, which is X ~ Bin(2N, 1/2N). Since E(X)=1, for large 2N, X is almos Po(1), such that P(no descendants) = P(X=0) = e^{-1}</p>
<p>Low reproductive success: forward simulations costly!</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="the-wright-fisher-model-and-simulations-1" class="slide level2 ultitle">
<h2>The Wright-Fisher model and simulations</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-wf-model-reproductive-success-2" class="quarto-float quarto-figure quarto-figure-center" data-fig-align="center">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-wf-model-reproductive-success-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="coalescent_files/figure-revealjs/fig-wf-model-reproductive-success-2-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: Wright-Fisher model for 50 generations, 30 individuals. Black points represent individuals that pass on offspring to the next generation."><img data-src="coalescent_files/figure-revealjs/fig-wf-model-reproductive-success-2-1.svg" class="quarto-figure quarto-figure-center" style="width:70.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-wf-model-reproductive-success-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Wright-Fisher model for 50 generations, 30 individuals. Black points represent individuals that pass on offspring to the next generation.
</figcaption>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-wf-model-reproductive-success-graph" class="quarto-float quarto-figure quarto-figure-center" data-fig-align="center">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-wf-model-reproductive-success-graph-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="coalescent_files/figure-revealjs/fig-wf-model-reproductive-success-graph-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;3: Reproductive success in percent per generation."><img data-src="coalescent_files/figure-revealjs/fig-wf-model-reproductive-success-graph-1.svg" class="quarto-figure quarto-figure-center" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-wf-model-reproductive-success-graph-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Reproductive success in percent per generation.
</figcaption>
</figure>
</div>
</div>
</div>
<div>
<p>Mean reproductive success = 63.4%. Can show for large populations P(no descendants)=<span class="math inline">1 - e^{-1} \approx
0.632</span></p>
</div>
</div></div>
<aside class="notes">
<p><span class="citation" data-cites="hein2005gene">(p.&nbsp;15 <a href="#/bibliography" role="doc-biblioref" onclick="">Hein et al., 2005</a>)</span> shows the fraction of genes without descendants. Focus on the number of descendants for <em>one</em> gene <em>i</em>, which is X ~ Bin(2N, 1/2N). Since E(X)=1, for large 2N, X is almos Po(1), such that P(no descendants) = P(X=0) = e^{-1}</p>
<p>Low reproductive success: forward simulations costly!</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="forward-and-backward-simulation" class="slide level2 smaller ultitle">
<h2>Forward and backward simulation</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div id="fig-wf-model-genealogy-forward" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-wf-model-genealogy-forward-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="coalescent_files/figure-revealjs/fig-wf-model-genealogy-forward-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;4: Forward simulation."><img data-src="coalescent_files/figure-revealjs/fig-wf-model-genealogy-forward-1.svg" style="width:60.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-wf-model-genealogy-forward-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Forward simulation.
</figcaption>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div id="fig-wf-model-genealogy-backward" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-wf-model-genealogy-backward-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="coalescent_files/figure-revealjs/fig-wf-model-genealogy-backward-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;5: Backward simulation."><img data-src="coalescent_files/figure-revealjs/fig-wf-model-genealogy-backward-1.svg" style="width:60.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-wf-model-genealogy-backward-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Backward simulation.
</figcaption>
</figure>
</div>
</div>
</div>
</div></div>
<p>Simulated nodes are filled with black. Genealogy of interest is highlighted in thick black lines.</p>
<aside class="notes">
<p>Forward simulations: require that we keep track of the entire population -&gt; computationally challenging.</p>
<p>Backward simulations: require only tracking the sample -&gt; quicker. However, cannot model selection.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="why-do-we-want-simulations-anyway" class="slide level2 ultitle">
<h2>Why do we want simulations anyway?</h2>
<dl>
<dt class="fragment">Null model</dt>
<dd class="fragment">
Generate neutral null distributions to compare with observed data
</dd>
<dt class="fragment">Exploration</dt>
<dd class="fragment">
Use to gain understanding and improve interpretation of mutational processes
</dd>
<dt class="fragment">Mathematical complexity</dt>
<dd class="fragment">
No analytical solutions for linked selection and the like <span class="math inline">\rightarrow</span> must use simulations
</dd>
<dt class="fragment">Benchmarking</dt>
<dd class="fragment">
Use to generate test data with known properties on which to test and evaluate new methods
</dd>
<dt class="fragment">Model training</dt>
<dd class="fragment">
Generate training data for machine learning, e.g., Approximate Bayesian Computation (ABC) or Neural Networks (NNs)
</dd>
</dl>
</section>
<section>
<section id="the-coalescent" class="title-slide slide level1 center">
<h1>The coalescent</h1>

</section>
<section id="coalescent-simulations" class="slide level2 ultitle">
<h2>Coalescent simulations</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>The coalescent simulates the genealogy of a <strong>sample</strong> of individuals on which mutations are “sprinkled” according to a Poisson process.</p>
<ol type="1">
<li>Simulate ancestry (genealogy)</li>
</ol>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><a href="coalescent_files/figure-revealjs/wf-model-genealogy-backward-1-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img data-src="coalescent_files/figure-revealjs/wf-model-genealogy-backward-1-1.svg" style="width:75.0%"></a></p>
</figure>
</div>
</div>
</div>
</div></div>
<aside class="notes">
<p>NB: only the samples on the genealogy are needed, but the entire population is shown as a means to compare with forward simulations.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="coalescent-simulations-1" class="slide level2 ultitle">
<h2>Coalescent simulations</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>The coalescent simulates the genealogy of a <strong>sample</strong> of individuals on which mutations are “sprinkled” according to a Poisson process.</p>
<ol type="1">
<li>Simulate ancestry (genealogy)</li>
<li>Simulate mutations</li>
</ol>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><a href="coalescent_files/figure-revealjs/wf-model-genealogy-backward-mutations-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img data-src="coalescent_files/figure-revealjs/wf-model-genealogy-backward-mutations-1.svg" style="width:75.0%"></a></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="coalescent-simulations-2" class="slide level2 ultitle">
<h2>Coalescent simulations</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>The coalescent simulates the genealogy of a <strong>sample</strong> of individuals on which mutations are “sprinkled” according to a Poisson process.</p>
<ol type="1">
<li>Simulate ancestry (genealogy)</li>
<li>Simulate mutations</li>
</ol>
<h4>
Exercise
</h4>
<p>How many mutations are common to all samples? How many mutations does sample 1 have? Sample 2?</p>
<p>Assuming the ancestral state is denoted <code>0</code> (prior to the <em>first</em> generation) and the derived state <code>1</code>, what are the sequences of the samples?</p>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><a href="coalescent_files/figure-revealjs/wf-model-genealogy-backward-mutations-1-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img data-src="coalescent_files/figure-revealjs/wf-model-genealogy-backward-mutations-1-1.svg" style="width:75.0%"></a></p>
</figure>
</div>
</div>
</div>
</div></div>
<aside class="notes">
<p>Answers to exercise: 2 mutations are common to all samples. Sample 1 has 3 mutations, sample 2 has 4.</p>
<p>(arbitrarily) ordering the sites from top to bottom (oldest mutation comes first), the sequences are:</p>
<p>1: 11100 2: 11101 3: 11010</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="simulating-genealogies-hahn_molecularpopulationgenetics_2019-p.-115" class="slide level2 ultitle">
<h2>Simulating genealogies <span class="citation" data-cites="hahn_MolecularPopulationGenetics_2019">(<a href="#/bibliography" role="doc-biblioref" onclick="">Hahn, 2019, p. 115</a>)</span></h2>
<div class="columns">
<div class="column" style="width:50%;">
<ol type="1">
<li>Start with <span class="math inline">i=n</span> chromosomes</li>
</ol>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><a href="coalescent_files/figure-revealjs/simulate-genealogy-1-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img data-src="coalescent_files/figure-revealjs/simulate-genealogy-1-1.svg" width="500" height="600"></a></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="simulating-genealogies-hahn_molecularpopulationgenetics_2019-p.-115-1" class="slide level2 ultitle">
<h2>Simulating genealogies <span class="citation" data-cites="hahn_MolecularPopulationGenetics_2019">(<a href="#/bibliography" role="doc-biblioref" onclick="">Hahn, 2019, p. 115</a>)</span></h2>
<div class="columns">
<div class="column" style="width:50%;">
<ol type="1">
<li><p>Start with <span class="math inline">i=n</span> chromosomes</p></li>
<li><p>Choose time to next coalescent event from an exponential distribution with parameter <span class="math inline">\lambda=i(i-1)/2</span></p></li>
</ol>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><a href="coalescent_files/figure-revealjs/simulate-genealogy-2-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img data-src="coalescent_files/figure-revealjs/simulate-genealogy-2-1.svg" width="500" height="600"></a></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="simulating-genealogies-hahn_molecularpopulationgenetics_2019-p.-115-2" class="slide level2 ultitle">
<h2>Simulating genealogies <span class="citation" data-cites="hahn_MolecularPopulationGenetics_2019">(<a href="#/bibliography" role="doc-biblioref" onclick="">Hahn, 2019, p. 115</a>)</span></h2>
<div class="columns">
<div class="column" style="width:50%;">
<ol type="1">
<li><p>Start with <span class="math inline">i=n</span> chromosomes</p></li>
<li><p>Choose time to next coalescent event from an exponential distribution with parameter <span class="math inline">\lambda=i(i-1)/2</span></p></li>
<li><p>Choose two chromosomes at random to coalesce</p></li>
</ol>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><a href="coalescent_files/figure-revealjs/simulate-genealogy-3-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img data-src="coalescent_files/figure-revealjs/simulate-genealogy-3-1.svg" width="500" height="600"></a></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="simulating-genealogies-hahn_molecularpopulationgenetics_2019-p.-115-3" class="slide level2 ultitle">
<h2>Simulating genealogies <span class="citation" data-cites="hahn_MolecularPopulationGenetics_2019">(<a href="#/bibliography" role="doc-biblioref" onclick="">Hahn, 2019, p. 115</a>)</span></h2>
<div class="columns">
<div class="column" style="width:50%;">
<ol type="1">
<li><p>Start with <span class="math inline">i=n</span> chromosomes</p></li>
<li><p>Choose time to next coalescent event from an exponential distribution with parameter <span class="math inline">\lambda=i(i-1)/2</span></p></li>
<li><p>Choose two chromosomes at random to coalesce</p></li>
<li><p>Merge the two lineages and set <span class="math inline">i \rightarrow i - 1</span></p></li>
</ol>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><a href="coalescent_files/figure-revealjs/simulate-genealogy-4-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img data-src="coalescent_files/figure-revealjs/simulate-genealogy-4-1.svg" width="500" height="600"></a></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="simulating-genealogies-hahn_molecularpopulationgenetics_2019-p.-115-4" class="slide level2 ultitle">
<h2>Simulating genealogies <span class="citation" data-cites="hahn_MolecularPopulationGenetics_2019">(<a href="#/bibliography" role="doc-biblioref" onclick="">Hahn, 2019, p. 115</a>)</span></h2>
<div class="columns">
<div class="column" style="width:50%;">
<ol type="1">
<li>Start with <span class="math inline">i=n</span> chromosomes</li>
<li>Choose time to next coalescent event from an exponential distribution with parameter <span class="math inline">\lambda=i(i-1)/2</span></li>
<li>Choose two chromosomes at random to coalesce</li>
<li>Merge the two lineages and set <span class="math inline">i \rightarrow i - 1</span></li>
<li>If <span class="math inline">i&gt;1</span>, go to step 2; if not, stop.</li>
</ol>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><a href="coalescent_files/figure-revealjs/simulate-genealogy-5-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img data-src="coalescent_files/figure-revealjs/simulate-genealogy-5-1.svg" width="500" height="600"></a></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="simulating-genealogies-hahn_molecularpopulationgenetics_2019-p.-115-5" class="slide level2 ultitle">
<h2>Simulating genealogies <span class="citation" data-cites="hahn_MolecularPopulationGenetics_2019">(<a href="#/bibliography" role="doc-biblioref" onclick="">Hahn, 2019, p. 115</a>)</span></h2>
<div class="columns">
<div class="column" style="width:50%;">
<ol type="1">
<li>Start with <span class="math inline">i=n</span> chromosomes</li>
<li>Choose time to next coalescent event from an exponential distribution with parameter <span class="math inline">\lambda=i(i-1)/2</span></li>
<li>Choose two chromosomes at random to coalesce</li>
<li>Merge the two lineages and set <span class="math inline">i \rightarrow i - 1</span></li>
<li>If <span class="math inline">i&gt;1</span>, go to step 2; if not, stop.</li>
</ol>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><a href="coalescent_files/figure-revealjs/simulate-genealogy-6-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img data-src="coalescent_files/figure-revealjs/simulate-genealogy-6-1.svg" width="500" height="600"></a></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="simulating-genealogies-hahn_molecularpopulationgenetics_2019-p.-115-6" class="slide level2 ultitle">
<h2>Simulating genealogies <span class="citation" data-cites="hahn_MolecularPopulationGenetics_2019">(<a href="#/bibliography" role="doc-biblioref" onclick="">Hahn, 2019, p. 115</a>)</span></h2>
<div class="columns">
<div class="column" style="width:50%;">
<ol type="1">
<li>Start with <span class="math inline">i=n</span> chromosomes</li>
<li>Choose time to next coalescent event from an exponential distribution with parameter <span class="math inline">\lambda=i(i-1)/2</span></li>
<li>Choose two chromosomes at random to coalesce</li>
<li>Merge the two lineages and set <span class="math inline">i \rightarrow i - 1</span></li>
<li>If <span class="math inline">i&gt;1</span>, go to step 2; if not, stop.</li>
</ol>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><a href="coalescent_files/figure-revealjs/simulate-genealogy-7-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img data-src="coalescent_files/figure-revealjs/simulate-genealogy-7-1.svg" width="500" height="600"></a></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="simulating-genealogies-hahn_molecularpopulationgenetics_2019-p.-115-7" class="slide level2 ultitle">
<h2>Simulating genealogies <span class="citation" data-cites="hahn_MolecularPopulationGenetics_2019">(<a href="#/bibliography" role="doc-biblioref" onclick="">Hahn, 2019, p. 115</a>)</span></h2>
<div class="columns">
<div class="column" style="width:50%;">
<ol type="1">
<li>Start with <span class="math inline">i=n</span> chromosomes</li>
<li>Choose time to next coalescent event from an exponential distribution with parameter <span class="math inline">\lambda=i(i-1)/2</span></li>
<li>Choose two chromosomes at random to coalesce</li>
<li>Merge the two lineages and set <span class="math inline">i \rightarrow i - 1</span></li>
<li>If <span class="math inline">i&gt;1</span>, go to step 2; if not, stop.</li>
</ol>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><a href="coalescent_files/figure-revealjs/simulate-genealogy-8-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img data-src="coalescent_files/figure-revealjs/simulate-genealogy-8-1.svg" width="500" height="600"></a></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="simulating-genealogies-hahn_molecularpopulationgenetics_2019-p.-115-8" class="slide level2 ultitle">
<h2>Simulating genealogies <span class="citation" data-cites="hahn_MolecularPopulationGenetics_2019">(<a href="#/bibliography" role="doc-biblioref" onclick="">Hahn, 2019, p. 115</a>)</span></h2>
<div class="columns">
<div class="column" style="width:50%;">
<ol type="1">
<li>Start with <span class="math inline">i=n</span> chromosomes</li>
<li>Choose time to next coalescent event from an exponential distribution with parameter <span class="math inline">\lambda=i(i-1)/2</span></li>
<li>Choose two chromosomes at random to coalesce</li>
<li>Merge the two lineages and set <span class="math inline">i \rightarrow i - 1</span></li>
<li>If <span class="math inline">i&gt;1</span>, go to step 2; if not, stop.</li>
</ol>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><a href="coalescent_files/figure-revealjs/simulate-genealogy-9-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img data-src="coalescent_files/figure-revealjs/simulate-genealogy-9-1.svg" width="500" height="600"></a></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="simulating-genealogies-hahn_molecularpopulationgenetics_2019-p.-115-9" class="slide level2 ultitle">
<h2>Simulating genealogies <span class="citation" data-cites="hahn_MolecularPopulationGenetics_2019">(<a href="#/bibliography" role="doc-biblioref" onclick="">Hahn, 2019, p. 115</a>)</span></h2>
<div class="columns">
<div class="column" style="width:50%;">
<ol type="1">
<li>Start with <span class="math inline">i=n</span> chromosomes</li>
<li>Choose time to next coalescent event from an exponential distribution with parameter <span class="math inline">\lambda=i(i-1)/2</span></li>
<li>Choose two chromosomes at random to coalesce</li>
<li>Merge the two lineages and set <span class="math inline">i \rightarrow i - 1</span></li>
<li>If <span class="math inline">i&gt;1</span>, go to step 2; if not, stop.</li>
</ol>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><a href="coalescent_files/figure-revealjs/simulate-genealogy-10-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-18"><img data-src="coalescent_files/figure-revealjs/simulate-genealogy-10-1.svg" width="500" height="600"></a></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="simulating-genealogies-hahn_molecularpopulationgenetics_2019-p.-115-10" class="slide level2 ultitle">
<h2>Simulating genealogies <span class="citation" data-cites="hahn_MolecularPopulationGenetics_2019">(<a href="#/bibliography" role="doc-biblioref" onclick="">Hahn, 2019, p. 115</a>)</span></h2>
<div class="columns">
<div class="column" style="width:50%;">
<ol type="1">
<li>Start with <span class="math inline">i=n</span> chromosomes</li>
<li>Choose time to next coalescent event from an exponential distribution with parameter <span class="math inline">\lambda=i(i-1)/2</span><span class="math inline">^1</span></li>
<li>Choose two chromosomes at random to coalesce</li>
<li>Merge the two lineages and set <span class="math inline">i \rightarrow i - 1</span></li>
<li>If <span class="math inline">i&gt;1</span>, go to step 2; if not, stop.</li>
</ol>
<div class="smallr">
<p><span class="math inline">^1</span>: The exponential can be parametrized in two different ways, so that the parameter to the function is either <span class="math inline">\lambda</span> or <span class="math inline">\beta=1/\lambda</span>.</p>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><a href="coalescent_files/figure-revealjs/simulate-genealogy-11-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-19"><img data-src="coalescent_files/figure-revealjs/simulate-genealogy-11-1.svg" width="500" height="600"></a></p>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="simulating-genealogies-hahn_molecularpopulationgenetics_2019-p.-115-11" class="slide level2 ultitle">
<h2>Simulating genealogies <span class="citation" data-cites="hahn_MolecularPopulationGenetics_2019">(<a href="#/bibliography" role="doc-biblioref" onclick="">Hahn, 2019, p. 115</a>)</span></h2>
<div class="columns">
<div class="column" style="width:50%;">
<ol type="1">
<li>Start with <span class="math inline">i=n</span> chromosomes</li>
<li>Choose time to next coalescent event from an exponential distribution with parameter <span class="math inline">\lambda=i(i-1)/2</span><span class="math inline">^1</span></li>
<li>Choose two chromosomes at random to coalesce</li>
<li>Merge the two lineages and set <span class="math inline">i \rightarrow i - 1</span></li>
<li>If <span class="math inline">i&gt;1</span>, go to step 2; if not, stop.</li>
</ol>
<div class="smallr">
<p><span class="math inline">^1</span>: The exponential can be parametrized in two different ways, so that the parameter to the function is either <span class="math inline">\lambda</span> or <span class="math inline">\beta=1/\lambda</span>.</p>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-simulate-genealogy-end" class="quarto-float quarto-figure quarto-figure-center" data-fig-align="center">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-simulate-genealogy-end-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="coalescent_files/figure-revealjs/fig-simulate-genealogy-end-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-20" title="Figure&nbsp;6: A simulated genealogy. The T_i represent the waiting time when the state has i chromosomes."><img data-src="coalescent_files/figure-revealjs/fig-simulate-genealogy-end-1.svg" class="quarto-figure quarto-figure-center" style="width:60.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-simulate-genealogy-end-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: A simulated genealogy. The <span class="math inline">T_i</span> represent the waiting time when the state has <span class="math inline">i</span> chromosomes.
</figcaption>
</figure>
</div>
</div>
</div>
</div></div>
</section>
<section id="some-properties-of-the-tree" class="slide level2 smaller ultitle">
<h2>Some properties of the tree</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-genealogy-properties" class="quarto-float quarto-figure quarto-figure-center" data-fig-align="center">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-genealogy-properties-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="coalescent_files/figure-revealjs/fig-genealogy-properties-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-21" title="Figure&nbsp;7: A coalescent tree with numbered nodes. Nodes 1-5 correspond to the samples and are leaves. The internal nodes 6-8 (and the unlabelled root) are ancestral chromosomes (unsampled). The T_i represent the waiting time when the state has i chromosomes, whereas \tau_i correspond to the branch length from node i to its parent."><img data-src="coalescent_files/figure-revealjs/fig-genealogy-properties-1.svg" class="quarto-figure quarto-figure-center" style="width:60.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-genealogy-properties-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: A coalescent tree with numbered nodes. Nodes 1-5 correspond to the samples and are leaves. The internal nodes 6-8 (and the unlabelled root) are ancestral chromosomes (unsampled). The <span class="math inline">T_i</span> represent the waiting time when the state has <span class="math inline">i</span> chromosomes, whereas <span class="math inline">\tau_i</span> correspond to the branch length from node <span class="math inline">i</span> to its parent.
</figcaption>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>The <strong>waiting time</strong> for coalescence is <strong>shorter</strong> when there are more lineages</p>
<p>Time to the <strong>most recent common ancestor (MRCA)</strong> (i.e., the tree height) is the sum of the waiting times (<span class="math inline">T_2 + T_3 + ...</span>)</p>
<p>On average, the time for coalescence when there are two remaining lineages is <strong>half</strong> the tree height</p>
</div></div>
<aside class="notes">
<p>Note that the parametrization is in 2N generations (continuous time approximation); some use N, others 4N, and so on.</p>
<p>Expected waiting time: the first expression follows from the fact that the waiting time, given <span class="math inline">i</span> chromosomes, is exponentially distributed with parameter <span class="math inline">\lambda=i(i-1)/2</span>. For an exponentially distributed variable <span class="math inline">X</span>, the expected value is simply <span class="math inline">E(X)=1/\lambda</span>.</p>
<p>Other relations are most easily derived by studying the tree and summing up relevant branches or time intervals.</p>
<p>Expected waiting time to coalesce when <span class="math inline">i</span> lineages: <span class="math inline">E(T_i) =
\frac{2}{i(i-1)}</span></p>
<p>Branch lengths can be derived from waiting times. For instance, <span class="math inline">\tau_1=\tau_2=T_5+T_4</span> and <span class="math inline">\tau_4=\tau_5=T_5</span></p>
<p>Time to the <strong>most recent common ancestor (MRCA)</strong> is sum of wating times: <span class="math inline">T_{MRCA} = \sum_{i=2}^n T_i</span></p>
<p>with expected value <span class="math inline">E(T_{MRCA}) = \sum_{i=2}^nE(T_i) = 2\left(1 -
\frac{1}{n}\right)</span></p>
<p>The expected <strong>total tree height</strong> is <span class="math inline">E(T_{total}) = \sum_{i=2}^n
iE(T_i) = 2\sum_{i=2}^n\frac{1}{i-1}</span></p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="coalescent-simulations-vary-in-topology-and-height" class="slide level2 smaller ultitle">
<h2>Coalescent simulations vary in topology and height</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a></a><span class="im">import</span> msprime</span>
<span id="cb1-2"><a></a>seeds <span class="op">=</span> [<span class="dv">12</span>, <span class="dv">15</span>, <span class="dv">34</span>, <span class="dv">63</span>, <span class="dv">30</span>]</span>
<span id="cb1-3"><a></a>trees <span class="op">=</span> [msprime.sim_ancestry(<span class="dv">3</span>, random_seed<span class="op">=</span>x) <span class="cf">for</span> x <span class="kw">in</span> seeds]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div>
<svg baseprofile="full" height="262.5576521441852" id="msprime-simulation" version="1.1" width="200" xmlns="http://www.w3.org/2000/svg" xmlns:ev="http://www.w3.org/2001/xml-events" xlink="http://www.w3.org/1999/xlink">
<defs>
<style type="text/css">.background path {fill: #808080; fill-opacity: 0}.background path:nth-child(odd) {fill-opacity: .1}.x-regions rect {fill: yellow; stroke: black; opacity: 0.5}.axes {font-size: 14px}.x-axis .tick .lab {font-weight: bold; dominant-baseline: hanging}.axes, .tree {font-size: 14px; text-anchor: middle}.axes line, .edge {stroke: black; fill: none}.axes .ax-skip {stroke-dasharray: 4}.y-axis .grid {stroke: #FAFAFA}.node > .sym {fill: black; stroke: none}.site > .sym {stroke: black}.mut text {fill: red; font-style: italic}.mut.extra text {fill: hotpink}.mut line {fill: none; stroke: none}.mut .sym {fill: none; stroke: red}.mut.extra .sym {stroke: hotpink}.node .mut .sym {stroke-width: 1.5px}.tree text, .tree-sequence text {dominant-baseline: central}.plotbox .lab.lft {text-anchor: end}.plotbox .lab.rgt {text-anchor: start}.polytomy line {stroke: black; stroke-dasharray: 1px, 1px}.polytomy text {paint-order:stroke;stroke-width:0.3em;stroke:white}.edge {stroke-width: 2px}</style>
</defs><g class="tree-sequence"><g class="plotbox trees"><g class="tree t0" transform="translate(20 0)"><g class="plotbox"><g class="c2 node n10 p0 root" transform="translate(95.625 26.8)"><g class="a10 i1 leaf node n2 p0 sample" transform="translate(34.375 193.958)"><path class="edge" d="M 0 0 V -193.958 H -34.375"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a10 c2 node n9 p0" transform="translate(-34.375 160.079)"><g class="a9 i0 leaf node n0 p0 sample" transform="translate(-31.25 33.8787)"><path class="edge" d="M 0 0 V -33.8787 H 31.25"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a9 c2 node n8 p0" transform="translate(31.25 9.96887)"><g class="a8 i2 leaf node n4 p0 sample" transform="translate(17.5 23.9099)"><path class="edge" d="M 0 0 V -23.9099 H -17.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a8 c2 node n7 p0" transform="translate(-17.5 8.81347)"><g class="a7 i2 leaf node n5 p0 sample" transform="translate(15 15.0964)"><path class="edge" d="M 0 0 V -15.0964 H -15"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a7 c2 node n6 p0" transform="translate(-15 14.3228)"><g class="a6 i0 leaf node n1 p0 sample" transform="translate(-10 0.77358)"><path class="edge" d="M 0 0 V -0.77358 H 10"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a6 i1 leaf node n3 p0 sample" transform="translate(10 0.77358)"><path class="edge" d="M 0 0 V -0.77358 H -10"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -14.3228 H 15"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -8.81347 H 17.5"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -9.96887 H -31.25"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -160.079 H 34.375"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab" transform="translate(0 -14)"></text></g></g></g></g></g>
</svg>
<svg baseprofile="full" height="143.18431650051062" id="msprime-simulation" version="1.1" width="200" xmlns="http://www.w3.org/2000/svg" xmlns:ev="http://www.w3.org/2001/xml-events" xlink="http://www.w3.org/1999/xlink">
<defs>
<style type="text/css">.background path {fill: #808080; fill-opacity: 0}.background path:nth-child(odd) {fill-opacity: .1}.x-regions rect {fill: yellow; stroke: black; opacity: 0.5}.axes {font-size: 14px}.x-axis .tick .lab {font-weight: bold; dominant-baseline: hanging}.axes, .tree {font-size: 14px; text-anchor: middle}.axes line, .edge {stroke: black; fill: none}.axes .ax-skip {stroke-dasharray: 4}.y-axis .grid {stroke: #FAFAFA}.node > .sym {fill: black; stroke: none}.site > .sym {stroke: black}.mut text {fill: red; font-style: italic}.mut.extra text {fill: hotpink}.mut line {fill: none; stroke: none}.mut .sym {fill: none; stroke: red}.mut.extra .sym {stroke: hotpink}.node .mut .sym {stroke-width: 1.5px}.tree text, .tree-sequence text {dominant-baseline: central}.plotbox .lab.lft {text-anchor: end}.plotbox .lab.rgt {text-anchor: start}.polytomy line {stroke: black; stroke-dasharray: 1px, 1px}.polytomy text {paint-order:stroke;stroke-width:0.3em;stroke:white}.edge {stroke-width: 2px}</style>
</defs><g class="tree-sequence"><g class="plotbox trees"><g class="tree t0" transform="translate(20 0)"><g class="plotbox"><g class="c2 node n10 p0 root" transform="translate(105.625 26.8)"><g class="a10 i1 leaf node n2 p0 sample" transform="translate(24.375 74.5843)"><path class="edge" d="M 0 0 V -74.5843 H -24.375"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a10 c2 node n9 p0" transform="translate(-24.375 17.8455)"><g class="a9 i1 leaf node n3 p0 sample" transform="translate(28.75 56.7388)"><path class="edge" d="M 0 0 V -56.7388 H -28.75"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a9 c2 node n8 p0" transform="translate(-28.75 42.5557)"><g class="a8 i0 leaf node n0 p0 sample" transform="translate(-22.5 14.1831)"><path class="edge" d="M 0 0 V -14.1831 H 22.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a8 c2 node n7 p0" transform="translate(22.5 3.65457)"><g class="a7 i2 leaf node n4 p0 sample" transform="translate(15 10.5285)"><path class="edge" d="M 0 0 V -10.5285 H -15"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a7 c2 node n6 p0" transform="translate(-15 4.37337)"><g class="a6 i0 leaf node n1 p0 sample" transform="translate(-10 6.15517)"><path class="edge" d="M 0 0 V -6.15517 H 10"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a6 i2 leaf node n5 p0 sample" transform="translate(10 6.15517)"><path class="edge" d="M 0 0 V -6.15517 H -10"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -4.37337 H 15"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -3.65457 H -22.5"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -42.5557 H 28.75"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -17.8455 H 24.375"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab" transform="translate(0 -14)"></text></g></g></g></g></g>
</svg>
<svg baseprofile="full" height="76.60317603443052" id="msprime-simulation" version="1.1" width="200" xmlns="http://www.w3.org/2000/svg" xmlns:ev="http://www.w3.org/2001/xml-events" xlink="http://www.w3.org/1999/xlink">
<defs>
<style type="text/css">.background path {fill: #808080; fill-opacity: 0}.background path:nth-child(odd) {fill-opacity: .1}.x-regions rect {fill: yellow; stroke: black; opacity: 0.5}.axes {font-size: 14px}.x-axis .tick .lab {font-weight: bold; dominant-baseline: hanging}.axes, .tree {font-size: 14px; text-anchor: middle}.axes line, .edge {stroke: black; fill: none}.axes .ax-skip {stroke-dasharray: 4}.y-axis .grid {stroke: #FAFAFA}.node > .sym {fill: black; stroke: none}.site > .sym {stroke: black}.mut text {fill: red; font-style: italic}.mut.extra text {fill: hotpink}.mut line {fill: none; stroke: none}.mut .sym {fill: none; stroke: red}.mut.extra .sym {stroke: hotpink}.node .mut .sym {stroke-width: 1.5px}.tree text, .tree-sequence text {dominant-baseline: central}.plotbox .lab.lft {text-anchor: end}.plotbox .lab.rgt {text-anchor: start}.polytomy line {stroke: black; stroke-dasharray: 1px, 1px}.polytomy text {paint-order:stroke;stroke-width:0.3em;stroke:white}.edge {stroke-width: 2px}</style>
</defs><g class="tree-sequence"><g class="plotbox trees"><g class="tree t0" transform="translate(20 0)"><g class="plotbox"><g class="c2 node n10 p0 root" transform="translate(86.25 26.8)"><g class="a10 c2 node n8 p0" transform="translate(33.75 5.80079)"><g class="a8 i1 leaf node n2 p0 sample" transform="translate(-10 2.20239)"><path class="edge" d="M 0 0 V -2.20239 H 10"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a8 i2 leaf node n5 p0 sample" transform="translate(10 2.20239)"><path class="edge" d="M 0 0 V -2.20239 H -10"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -5.80079 H -33.75"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><g class="a10 c2 node n9 p0" transform="translate(-33.75 5.45098)"><g class="a9 i0 leaf node n0 p0 sample" transform="translate(-22.5 2.55219)"><path class="edge" d="M 0 0 V -2.55219 H 22.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a9 c2 node n7 p0" transform="translate(22.5 1.98685)"><g class="a7 i1 leaf node n3 p0 sample" transform="translate(15 0.565342)"><path class="edge" d="M 0 0 V -0.565342 H -15"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a7 c2 node n6 p0" transform="translate(-15 0.539646)"><g class="a6 i0 leaf node n1 p0 sample" transform="translate(-10 0.0256967)"><path class="edge" d="M 0 0 V -0.0256967 H 10"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a6 i2 leaf node n4 p0 sample" transform="translate(10 0.0256967)"><path class="edge" d="M 0 0 V -0.0256967 H -10"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -0.539646 H 15"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -1.98685 H -22.5"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -5.45098 H 33.75"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab" transform="translate(0 -14)"></text></g></g></g></g></g>
</svg>
<svg baseprofile="full" height="87.63214958144492" id="msprime-simulation" version="1.1" width="200" xmlns="http://www.w3.org/2000/svg" xmlns:ev="http://www.w3.org/2001/xml-events" xlink="http://www.w3.org/1999/xlink">
<defs>
<style type="text/css">.background path {fill: #808080; fill-opacity: 0}.background path:nth-child(odd) {fill-opacity: .1}.x-regions rect {fill: yellow; stroke: black; opacity: 0.5}.axes {font-size: 14px}.x-axis .tick .lab {font-weight: bold; dominant-baseline: hanging}.axes, .tree {font-size: 14px; text-anchor: middle}.axes line, .edge {stroke: black; fill: none}.axes .ax-skip {stroke-dasharray: 4}.y-axis .grid {stroke: #FAFAFA}.node > .sym {fill: black; stroke: none}.site > .sym {stroke: black}.mut text {fill: red; font-style: italic}.mut.extra text {fill: hotpink}.mut line {fill: none; stroke: none}.mut .sym {fill: none; stroke: red}.mut.extra .sym {stroke: hotpink}.node .mut .sym {stroke-width: 1.5px}.tree text, .tree-sequence text {dominant-baseline: central}.plotbox .lab.lft {text-anchor: end}.plotbox .lab.rgt {text-anchor: start}.polytomy line {stroke: black; stroke-dasharray: 1px, 1px}.polytomy text {paint-order:stroke;stroke-width:0.3em;stroke:white}.edge {stroke-width: 2px}</style>
</defs><g class="tree-sequence"><g class="plotbox trees"><g class="tree t0" transform="translate(20 0)"><g class="plotbox"><g class="c2 node n10 p0 root" transform="translate(86.25 26.8)"><g class="a10 c2 node n8 p0" transform="translate(-33.75 15.3658)"><g class="a8 i0 leaf node n0 p0 sample" transform="translate(-22.5 3.66634)"><path class="edge" d="M 0 0 V -3.66634 H 22.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a8 c2 node n7 p0" transform="translate(22.5 2.53288)"><g class="a7 i2 leaf node n5 p0 sample" transform="translate(15 1.13346)"><path class="edge" d="M 0 0 V -1.13346 H -15"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a7 c2 node n6 p0" transform="translate(-15 0.0368438)"><g class="a6 i1 leaf node n3 p0 sample" transform="translate(-10 1.09662)"><path class="edge" d="M 0 0 V -1.09662 H 10"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a6 i2 leaf node n4 p0 sample" transform="translate(10 1.09662)"><path class="edge" d="M 0 0 V -1.09662 H -10"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -0.0368438 H 15"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -2.53288 H -22.5"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -15.3658 H 33.75"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><g class="a10 c2 node n9 p0" transform="translate(33.75 6.02772)"><g class="a9 i0 leaf node n1 p0 sample" transform="translate(-10 13.0044)"><path class="edge" d="M 0 0 V -13.0044 H 10"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a9 i1 leaf node n2 p0 sample" transform="translate(10 13.0044)"><path class="edge" d="M 0 0 V -13.0044 H -10"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -6.02772 H -33.75"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab" transform="translate(0 -14)"></text></g></g></g></g></g>
</svg>
<svg baseprofile="full" height="500.0" id="msprime-simulation" version="1.1" width="200" xmlns="http://www.w3.org/2000/svg" xmlns:ev="http://www.w3.org/2001/xml-events" xlink="http://www.w3.org/1999/xlink">
<defs>
<style type="text/css">.background path {fill: #808080; fill-opacity: 0}.background path:nth-child(odd) {fill-opacity: .1}.x-regions rect {fill: yellow; stroke: black; opacity: 0.5}.axes {font-size: 14px}.x-axis .tick .lab {font-weight: bold; dominant-baseline: hanging}.axes, .tree {font-size: 14px; text-anchor: middle}.axes line, .edge {stroke: black; fill: none}.axes .ax-skip {stroke-dasharray: 4}.y-axis .grid {stroke: #FAFAFA}.node > .sym {fill: black; stroke: none}.site > .sym {stroke: black}.mut text {fill: red; font-style: italic}.mut.extra text {fill: hotpink}.mut line {fill: none; stroke: none}.mut .sym {fill: none; stroke: red}.mut.extra .sym {stroke: hotpink}.node .mut .sym {stroke-width: 1.5px}.tree text, .tree-sequence text {dominant-baseline: central}.plotbox .lab.lft {text-anchor: end}.plotbox .lab.rgt {text-anchor: start}.polytomy line {stroke: black; stroke-dasharray: 1px, 1px}.polytomy text {paint-order:stroke;stroke-width:0.3em;stroke:white}.edge {stroke-width: 2px}</style>
</defs><g class="tree-sequence"><g class="plotbox trees"><g class="tree t0" transform="translate(20 0)"><g class="plotbox"><g class="c2 node n10 p0 root" transform="translate(70 26.8)"><g class="a10 c2 node n6 p0" transform="translate(-30 425.824)"><g class="a6 i0 leaf node n0 p0 sample" transform="translate(-10 5.57571)"><path class="edge" d="M 0 0 V -5.57571 H 10"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a6 i2 leaf node n4 p0 sample" transform="translate(10 5.57571)"><path class="edge" d="M 0 0 V -5.57571 H -10"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -425.824 H 30"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><g class="a10 c2 node n9 p0" transform="translate(30 388.351)"><g class="a9 c2 node n7 p0" transform="translate(20 35.4797)"><g class="a7 i1 leaf node n2 p0 sample" transform="translate(-10 7.56884)"><path class="edge" d="M 0 0 V -7.56884 H 10"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a7 i2 leaf node n5 p0 sample" transform="translate(10 7.56884)"><path class="edge" d="M 0 0 V -7.56884 H -10"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -35.4797 H -20"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><g class="a9 c2 node n8 p0" transform="translate(-20 33.0688)"><g class="a8 i0 leaf node n1 p0 sample" transform="translate(-10 9.9798)"><path class="edge" d="M 0 0 V -9.9798 H 10"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a8 i1 leaf node n3 p0 sample" transform="translate(10 9.9798)"><path class="edge" d="M 0 0 V -9.9798 H -10"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -33.0688 H 20"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -388.351 H -30"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab" transform="translate(0 -14)"></text></g></g></g></g></g>
</svg>
</div>
<p>Examples of coalescent simulations. Note the variation in tree topology and height.</p>
</section>
<section id="diminishing-returns-of-adding-more-samples" class="slide level2 ultitle">
<h2>Diminishing returns of adding more samples</h2>
<div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-coalescent-diminishing-returns" class="quarto-float quarto-figure quarto-figure-center" data-fig-align="center">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-coalescent-diminishing-returns-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="coalescent_files/figure-revealjs/fig-coalescent-diminishing-returns-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-22" title="Figure&nbsp;8: Dependence of time to most recent common ancestor (T_{MRCA}) and total branch length of tree on the sample size n.&nbsp;Already at low values of n the value of T_{MRCA} is close to its asymptotic value, which has practical consequences for the measurement of DNA variation; adding more samples mainly adds tips to the trees and does not provide access to deep time. Adapted from @wakeley_CoalescentTheoryIntroduction_2008, Fig. 3.3."><img data-src="coalescent_files/figure-revealjs/fig-coalescent-diminishing-returns-1.svg" class="quarto-figure quarto-figure-center" style="width:80.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-coalescent-diminishing-returns-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Dependence of time to most recent common ancestor (<span class="math inline">T_{MRCA}</span>) and total branch length of tree on the sample size n.&nbsp;Already at low values of n the value of <span class="math inline">T_{MRCA}</span> is close to its asymptotic value, which has practical consequences for the measurement of DNA variation; adding more samples mainly adds tips to the trees and does not provide access to deep time. Adapted from <span class="citation" data-cites="wakeley_CoalescentTheoryIntroduction_2008">Wakeley (<a href="#/bibliography" role="doc-biblioref" onclick="">2008</a>)</span>, Fig. 3.3.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<aside class="notes">
<p>Adding a sample only adds <span class="math inline">2/n</span> to the total tree length. Also, adding a sample will add little to <span class="math inline">T_{MRCA}</span>, or equivalently, will most likely add a very recent coalescent event to the tree for large enough <span class="math inline">n</span>. Note that <span class="math inline">n=20</span> here is equivalent to 10 diploid individuals.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="adding-mutations" class="slide level2 ultitle">
<h2>Adding mutations</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<div id="fig-add-mutations" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-add-mutations-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="coalescent_files/figure-revealjs/fig-add-mutations-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-23" title="Figure&nbsp;9: Adding mutations on a coalescent genealogy."><img data-src="coalescent_files/figure-revealjs/fig-add-mutations-1.svg" width="500" height="500"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-add-mutations-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Adding mutations on a coalescent genealogy.
</figcaption>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>Mutations are added by “throwing” them on branches, where the probability of ending up on a given branch is equal to its relative length.</p>
<p>The total number of segregating sites <span class="math inline">S</span> to be thrown on the tree is modelled as a <a href="https://en.wikipedia.org/wiki/Poisson_distribution">Poisson random variable</a> which expresses the probability of a given number of events in a given time. Here the time is the total branch length of the tree and mutations are added with intensity proportional to the <strong>population mutation rate</strong> <span class="math inline">\theta</span>.</p>
</div></div>
<aside class="notes">
<p>Sofar we have looked at genealogies; now add mutations.</p>
<p>In words: sample a number of segregating sites from the Poisson distribution, and “sprinkle” them on the tree.</p>
<p>The parametrization <span class="math inline">\lambda = \theta / 2</span> is defined with reference to the average heterozygosity between two sequences being <span class="math inline">\theta</span> (by Tajima; see <span class="citation" data-cites="wakeley_CoalescentTheoryIntroduction_2008">Wakeley (<a href="#/bibliography" role="doc-biblioref" onclick="">2008</a>)</span>, p.&nbsp;92)</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="the-coalescent-and-diversity" class="slide level2 smaller ultitle">
<h2>The coalescent and diversity</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="dna">
<table class="caption-top" style="width:90%;">
<colgroup>
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">1</th>
<th style="text-align: center;">2</th>
<th style="text-align: center;">3</th>
<th style="text-align: center;">4</th>
<th style="text-align: center;">5</th>
<th style="text-align: center;">6</th>
<th style="text-align: center;">7</th>
<th style="text-align: center;">8</th>
<th style="text-align: center;">9</th>
<th style="text-align: center;">10</th>
<th style="text-align: center;">11</th>
<th style="text-align: center;">12</th>
<th style="text-align: center;">13</th>
<th style="text-align: center;">14</th>
<th style="text-align: center;">15</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">T</td>
<td style="text-align: center;">T</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">T</td>
<td style="text-align: center;"><strong>C</strong></td>
<td style="text-align: center;">C</td>
<td style="text-align: center;">G</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">T</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;">G</td>
<td style="text-align: center;">T</td>
</tr>
<tr class="even">
<td style="text-align: center;">T</td>
<td style="text-align: center;">T</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;"><strong>G</strong></td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">T</td>
<td style="text-align: center;">G</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;">G</td>
<td style="text-align: center;"><strong>C</strong></td>
<td style="text-align: center;">T</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;">G</td>
<td style="text-align: center;">T</td>
</tr>
<tr class="odd">
<td style="text-align: center;">T</td>
<td style="text-align: center;"><strong>C</strong></td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">T</td>
<td style="text-align: center;">G</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;">G</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">T</td>
<td style="text-align: center;"><strong>G</strong></td>
<td style="text-align: center;">G</td>
<td style="text-align: center;"><strong>A</strong></td>
</tr>
<tr class="even">
<td style="text-align: center;">T</td>
<td style="text-align: center;">T</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;"><strong>G</strong></td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">T</td>
<td style="text-align: center;">G</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;">G</td>
<td style="text-align: center;"><strong>C</strong></td>
<td style="text-align: center;">T</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;">G</td>
<td style="text-align: center;">T</td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: center;">*</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">*</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">*</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">*</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">*</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">*</td>
</tr>
</tbody>
</table>
</div>
<div class="fragment">
<!-- markdownlint-disable MD013 -->
<p><span class="math display">
\begin{align}
\pi &amp; = \sum_{j=1}^S h_j = \sum_{j=1}^{S} \frac{n}{n-1}\left(1 - \sum_i p_i^2 \right) \\
&amp; \stackrel{S=6,\\ n=4}{=} \sum_{j=1}^{6} \frac{4}{3}\left(1 - \sum_i p_i^2\right) \\
&amp; = \frac{4}{3}\left(\mathbf{\color{#a7c947}{4}}\left(1-\frac{1}{16}-\frac{9}{16}\right) + \mathbf{\color{#a7c947}{2}}\left(1 - \frac{1}{4} - \frac{1}{4}\right)\right) = \frac{10}{3}
\end{align}
</span></p>
<!-- markdownlint-enable MD013 -->
</div>
</div><div class="column fragment" style="width:20%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><a href="coalescent_files/figure-revealjs/coalescent-tree-dna-variation-representation-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-24"><img data-src="coalescent_files/figure-revealjs/coalescent-tree-dna-variation-representation-1.svg" style="width:80.0%"></a></p>
</figure>
</div>
</div>
</div>
</div><div class="column fragment" style="width:30%;">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><a href="coalescent_files/figure-revealjs/tree-site-frequency-spectrum-graph-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-25"><img data-src="coalescent_files/figure-revealjs/tree-site-frequency-spectrum-graph-1.svg" style="width:80.0%"></a></p>
</figure>
</div>
</div>
</div>
<div class="fragment">
<p>In this notation one can show that <span class="math inline">\pi</span>, the nucleotide diversity, is</p>
<p><span class="math display">
\begin{equation*}
\begin{split}
\pi &amp; = \frac{\sum_{i=1}^{n-1}i(n-i)\xi_i}{n(n-1)/2} \\
&amp; \stackrel{n=4}{=} \frac{1*(4-1)*4 + 2*(4-2)*2}{6} \\
&amp; = \frac{10}{3}
\end{split}
\end{equation*}
</span></p>
</div>
</div></div>
<div class="fragment">
<p>Many statistical quantities can be related to the <strong>site frequency spectrum</strong> (<strong>SFS</strong>), which is a summary of the frequencies of the segregating sites. Let <span class="math inline">\xi_i</span> be the number of chromosomes in the sample with <span class="math inline">i</span> minor alleles. In the example above we have <span class="math inline">S=6</span> mutations on <span class="math inline">n=4</span> chromosomes.</p>
</div>
</section>
<section id="the-impact-of-topology-on-the-sfs" class="slide level2 smaller ultitle">
<h2>The impact of topology on the SFS</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>Coalescent trees. <a href="../../recipes/slides/index.html#sec-recipe-msprime-trees"><i class="fa-solid fa-rectangle-list" aria-label="rectangle-list"></i></a></p>
<!-- markdownlint-disable MD013 -->
<div style="display: grid; grid-template-columns: 200px 200px; grid-row-gap: 0px; grid-column-gap: 40px;">
<div>
<p><em>Neutral</em></p>
<svg baseprofile="full" height="250" id="neutral" version="1.1" width="200" xmlns="http://www.w3.org/2000/svg" xmlns:ev="http://www.w3.org/2001/xml-events" xlink="http://www.w3.org/1999/xlink">
<defs>
<style type="text/css">.background path {fill: #808080; fill-opacity: 0}.background path:nth-child(odd) {fill-opacity: .1}.x-regions rect {fill: yellow; stroke: black; opacity: 0.5}.axes {font-size: 14px}.x-axis .tick .lab {font-weight: bold; dominant-baseline: hanging}.axes, .tree {font-size: 14px; text-anchor: middle}.axes line, .edge {stroke: black; fill: none}.axes .ax-skip {stroke-dasharray: 4}.y-axis .grid {stroke: #FAFAFA}.node > .sym {fill: black; stroke: none}.site > .sym {stroke: black}.mut text {fill: red; font-style: italic}.mut.extra text {fill: hotpink}.mut line {fill: none; stroke: none}.mut .sym {fill: none; stroke: red}.mut.extra .sym {stroke: hotpink}.node .mut .sym {stroke-width: 1.5px}.tree text, .tree-sequence text {dominant-baseline: central}.plotbox .lab.lft {text-anchor: end}.plotbox .lab.rgt {text-anchor: start}.polytomy line {stroke: black; stroke-dasharray: 1px, 1px}.polytomy text {paint-order:stroke;stroke-width:0.3em;stroke:white}#neutral { .edge {stroke-width: 2px} }</style>
</defs><g class="tree-sequence"><g class="plotbox trees"><g class="tree t0" transform="translate(20 0)"><g class="plotbox"><g class="c2 node n38 p0 root" transform="translate(114.547 26.8)"><g class="a38 i5 leaf node n10 p0 sample" transform="translate(22.4531 181.4)"><path class="edge" d="M 0 0 V -181.4 H -22.4531"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a38 c2 node n37 p0" transform="translate(-22.4531 118.917)"><g class="a37 c2 node n35 p0" transform="translate(-29.3438 20.5598)"><g class="a35 i8 leaf node n16 p0 sample" transform="translate(14.25 41.9228)"><path class="edge" d="M 0 0 V -41.9228 H -14.25"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a35 c2 node n33 p0" transform="translate(-14.25 20.2335)"><g class="a33 c2 node n31 p0" transform="translate(-12.75 5.70072)"><g class="a31 i4 leaf node n9 p0 sample" transform="translate(5.25 15.9886)"><path class="edge" d="M 0 0 V -15.9886 H -5.25"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a31 c2 node n29 p0" transform="translate(-5.25 5.78699)"><g class="a29 i9 leaf node n18 p0 sample" transform="translate(4.5 10.2016)"><path class="edge" d="M 0 0 V -10.2016 H -4.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a29 c2 node n25 p0" transform="translate(-4.5 7.30927)"><g class="a25 i0 leaf node n0 p0 sample" transform="translate(-3 2.8923)"><path class="edge" d="M 0 0 V -2.8923 H 3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a25 i3 leaf node n6 p0 sample" transform="translate(3 2.8923)"><path class="edge" d="M 0 0 V -2.8923 H -3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -7.30927 H 4.5"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -5.78699 H 5.25"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -5.70072 H 12.75"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><g class="a33 c2 node n32 p0" transform="translate(12.75 2.03576)"><g class="a32 c2 node n28 p0" transform="translate(6.75 12.5623)"><g class="a28 i2 leaf node n5 p0 sample" transform="translate(-3 7.09118)"><path class="edge" d="M 0 0 V -7.09118 H 3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a28 i6 leaf node n12 p0 sample" transform="translate(3 7.09118)"><path class="edge" d="M 0 0 V -7.09118 H -3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -12.5623 H -6.75"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><g class="a32 c2 node n30 p0" transform="translate(-6.75 8.30281)"><g class="a30 i3 leaf node n7 p0 sample" transform="translate(4.5 11.3507)"><path class="edge" d="M 0 0 V -11.3507 H -4.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a30 c2 node n27 p0" transform="translate(-4.5 7.3301)"><g class="a27 i1 leaf node n2 p0 sample" transform="translate(-3 4.02062)"><path class="edge" d="M 0 0 V -4.02062 H 3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a27 i4 leaf node n8 p0 sample" transform="translate(3 4.02062)"><path class="edge" d="M 0 0 V -4.02062 H -3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -7.3301 H 4.5"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -8.30281 H 6.75"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -2.03576 H -12.75"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -20.2335 H 14.25"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -20.5598 H 29.3438"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><g class="a37 c2 node n36 p0" transform="translate(29.3438 16.2194)"><g class="a36 i1 leaf node n3 p0 sample" transform="translate(9.5625 46.2631)"><path class="edge" d="M 0 0 V -46.2631 H -9.5625"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a36 c2 node n34 p0" transform="translate(-9.5625 24.4754)"><g class="a34 c2 node n24 p0" transform="translate(-10.125 18.953)"><g class="a24 i7 leaf node n14 p0 sample" transform="translate(11.25 2.83471)"><path class="edge" d="M 0 0 V -2.83471 H -11.25"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a24 c2 node n23 p0" transform="translate(-11.25 1.35141)"><g class="a23 i0 leaf node n1 p0 sample" transform="translate(-7.5 1.48331)"><path class="edge" d="M 0 0 V -1.48331 H 7.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a23 c2 node n22 p0" transform="translate(7.5 0.222772)"><g class="a22 c2 node n20 p0" transform="translate(-6 1.19866)"><g class="a20 i2 leaf node n4 p0 sample" transform="translate(-3 0.0618694)"><path class="edge" d="M 0 0 V -0.0618694 H 3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a20 i5 leaf node n11 p0 sample" transform="translate(3 0.0618694)"><path class="edge" d="M 0 0 V -0.0618694 H -3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -1.19866 H 6"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><g class="a22 c2 node n21 p0" transform="translate(6 0.350138)"><g class="a21 i7 leaf node n15 p0 sample" transform="translate(-3 0.910395)"><path class="edge" d="M 0 0 V -0.910395 H 3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a21 i9 leaf node n19 p0 sample" transform="translate(3 0.910395)"><path class="edge" d="M 0 0 V -0.910395 H -3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -0.350138 H -6"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -0.222772 H -7.5"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -1.35141 H 11.25"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -18.953 H 10.125"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><g class="a34 c2 node n26 p0" transform="translate(10.125 18.7815)"><g class="a26 i6 leaf node n13 p0 sample" transform="translate(-3 3.00617)"><path class="edge" d="M 0 0 V -3.00617 H 3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a26 i8 leaf node n17 p0 sample" transform="translate(3 3.00617)"><path class="edge" d="M 0 0 V -3.00617 H -3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -18.7815 H -10.125"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -24.4754 H 9.5625"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -16.2194 H -29.3438"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -118.917 H 22.4531"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab" transform="translate(0 -14)"></text></g></g></g></g></g>
</svg>
</div>
<div>
<p><em>Expansion</em></p>
<svg baseprofile="full" height="250" id="expansion" version="1.1" width="200" xmlns="http://www.w3.org/2000/svg" xmlns:ev="http://www.w3.org/2001/xml-events" xlink="http://www.w3.org/1999/xlink">
<defs>
<style type="text/css">.background path {fill: #808080; fill-opacity: 0}.background path:nth-child(odd) {fill-opacity: .1}.x-regions rect {fill: yellow; stroke: black; opacity: 0.5}.axes {font-size: 14px}.x-axis .tick .lab {font-weight: bold; dominant-baseline: hanging}.axes, .tree {font-size: 14px; text-anchor: middle}.axes line, .edge {stroke: black; fill: none}.axes .ax-skip {stroke-dasharray: 4}.y-axis .grid {stroke: #FAFAFA}.node > .sym {fill: black; stroke: none}.site > .sym {stroke: black}.mut text {fill: red; font-style: italic}.mut.extra text {fill: hotpink}.mut line {fill: none; stroke: none}.mut .sym {fill: none; stroke: red}.mut.extra .sym {stroke: hotpink}.node .mut .sym {stroke-width: 1.5px}.tree text, .tree-sequence text {dominant-baseline: central}.plotbox .lab.lft {text-anchor: end}.plotbox .lab.rgt {text-anchor: start}.polytomy line {stroke: black; stroke-dasharray: 1px, 1px}.polytomy text {paint-order:stroke;stroke-width:0.3em;stroke:white}#expansion { .edge {stroke-width: 2px} }</style>
</defs><g class="tree-sequence"><g class="plotbox trees"><g class="tree t0" transform="translate(20 0)"><g class="plotbox"><g class="c2 node n38 p0 root" transform="translate(114.547 26.8)"><g class="a38 i5 leaf node n10 p0 sample" transform="translate(22.4531 181.4)"><path class="edge" d="M 0 0 V -181.4 H -22.4531"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a38 c2 node n37 p0" transform="translate(-22.4531 22.6042)"><g class="a37 c2 node n35 p0" transform="translate(-29.3438 8.46042)"><g class="a35 i8 leaf node n16 p0 sample" transform="translate(14.25 150.335)"><path class="edge" d="M 0 0 V -150.335 H -14.25"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a35 c2 node n33 p0" transform="translate(-14.25 13.9648)"><g class="a33 c2 node n31 p0" transform="translate(-12.75 6.45737)"><g class="a31 i4 leaf node n9 p0 sample" transform="translate(5.25 129.913)"><path class="edge" d="M 0 0 V -129.913 H -5.25"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a31 c2 node n29 p0" transform="translate(-5.25 9.5065)"><g class="a29 i9 leaf node n18 p0 sample" transform="translate(4.5 120.407)"><path class="edge" d="M 0 0 V -120.407 H -4.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a29 c2 node n25 p0" transform="translate(-4.5 26.559)"><g class="a25 i0 leaf node n0 p0 sample" transform="translate(-3 93.8478)"><path class="edge" d="M 0 0 V -93.8478 H 3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a25 i3 leaf node n6 p0 sample" transform="translate(3 93.8478)"><path class="edge" d="M 0 0 V -93.8478 H -3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -26.559 H 4.5"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -9.5065 H 5.25"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -6.45737 H 12.75"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><g class="a33 c2 node n32 p0" transform="translate(12.75 2.0875)"><g class="a32 c2 node n28 p0" transform="translate(6.75 21.5604)"><g class="a28 i2 leaf node n5 p0 sample" transform="translate(-3 112.723)"><path class="edge" d="M 0 0 V -112.723 H 3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a28 i6 leaf node n12 p0 sample" transform="translate(3 112.723)"><path class="edge" d="M 0 0 V -112.723 H -3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -21.5604 H -6.75"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><g class="a32 c2 node n30 p0" transform="translate(-6.75 11.6192)"><g class="a30 i3 leaf node n7 p0 sample" transform="translate(4.5 122.664)"><path class="edge" d="M 0 0 V -122.664 H -4.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a30 c2 node n27 p0" transform="translate(-4.5 21.8996)"><g class="a27 i1 leaf node n2 p0 sample" transform="translate(-3 100.764)"><path class="edge" d="M 0 0 V -100.764 H 3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a27 i4 leaf node n8 p0 sample" transform="translate(3 100.764)"><path class="edge" d="M 0 0 V -100.764 H -3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -21.8996 H 4.5"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -11.6192 H 6.75"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -2.0875 H -12.75"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -13.9648 H 14.25"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -8.46042 H 29.3438"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><g class="a37 c2 node n36 p0" transform="translate(29.3438 6.37201)"><g class="a36 i1 leaf node n3 p0 sample" transform="translate(9.5625 152.424)"><path class="edge" d="M 0 0 V -152.424 H -9.5625"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a36 c2 node n34 p0" transform="translate(-9.5625 15.9573)"><g class="a34 c2 node n24 p0" transform="translate(-10.125 43.0403)"><g class="a24 i7 leaf node n14 p0 sample" transform="translate(11.25 93.4263)"><path class="edge" d="M 0 0 V -93.4263 H -11.25"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a24 c2 node n23 p0" transform="translate(-11.25 13.5055)"><g class="a23 i0 leaf node n1 p0 sample" transform="translate(-7.5 79.9208)"><path class="edge" d="M 0 0 V -79.9208 H 7.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a23 c2 node n22 p0" transform="translate(7.5 3.36608)"><g class="a22 c2 node n20 p0" transform="translate(-6 54.9975)"><g class="a20 i2 leaf node n4 p0 sample" transform="translate(-3 21.5572)"><path class="edge" d="M 0 0 V -21.5572 H 3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a20 i5 leaf node n11 p0 sample" transform="translate(3 21.5572)"><path class="edge" d="M 0 0 V -21.5572 H -3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -54.9975 H 6"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><g class="a22 c2 node n21 p0" transform="translate(6 6.68386)"><g class="a21 i7 leaf node n15 p0 sample" transform="translate(-3 69.8708)"><path class="edge" d="M 0 0 V -69.8708 H 3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a21 i9 leaf node n19 p0 sample" transform="translate(3 69.8708)"><path class="edge" d="M 0 0 V -69.8708 H -3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -6.68386 H -6"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -3.36608 H -7.5"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -13.5055 H 11.25"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -43.0403 H 10.125"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><g class="a34 c2 node n26 p0" transform="translate(10.125 41.8092)"><g class="a26 i6 leaf node n13 p0 sample" transform="translate(-3 94.6574)"><path class="edge" d="M 0 0 V -94.6574 H 3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a26 i8 leaf node n17 p0 sample" transform="translate(3 94.6574)"><path class="edge" d="M 0 0 V -94.6574 H -3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -41.8092 H -10.125"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -15.9573 H 9.5625"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -6.37201 H -29.3438"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -22.6042 H 22.4531"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab" transform="translate(0 -14)"></text></g></g></g></g></g>
</svg>
</div>
<div>
<p><em>Bottleneck</em></p>
<svg baseprofile="full" height="250" id="bottleneck" version="1.1" width="200" xmlns="http://www.w3.org/2000/svg" xmlns:ev="http://www.w3.org/2001/xml-events" xlink="http://www.w3.org/1999/xlink">
<defs>
<style type="text/css">.background path {fill: #808080; fill-opacity: 0}.background path:nth-child(odd) {fill-opacity: .1}.x-regions rect {fill: yellow; stroke: black; opacity: 0.5}.axes {font-size: 14px}.x-axis .tick .lab {font-weight: bold; dominant-baseline: hanging}.axes, .tree {font-size: 14px; text-anchor: middle}.axes line, .edge {stroke: black; fill: none}.axes .ax-skip {stroke-dasharray: 4}.y-axis .grid {stroke: #FAFAFA}.node > .sym {fill: black; stroke: none}.site > .sym {stroke: black}.mut text {fill: red; font-style: italic}.mut.extra text {fill: hotpink}.mut line {fill: none; stroke: none}.mut .sym {fill: none; stroke: red}.mut.extra .sym {stroke: hotpink}.node .mut .sym {stroke-width: 1.5px}.tree text, .tree-sequence text {dominant-baseline: central}.plotbox .lab.lft {text-anchor: end}.plotbox .lab.rgt {text-anchor: start}.polytomy line {stroke: black; stroke-dasharray: 1px, 1px}.polytomy text {paint-order:stroke;stroke-width:0.3em;stroke:white}#bottleneck { .edge {stroke-width: 2px} }</style>
</defs><g class="tree-sequence"><g class="plotbox trees"><g class="tree t0" transform="translate(20 0)"><g class="plotbox"><g class="c2 node n33 p0 root" transform="translate(96.4062 26.8)"><g class="a33 c4 node n27 p0" transform="translate(27.0938 167.508)"><g class="a27 i1 leaf node n2 p0 sample" transform="translate(-10.5 13.8916)"><path class="edge" d="M 0 0 V -13.8916 H 10.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a27 i3 leaf node n7 p0 sample" transform="translate(-4.5 13.8916)"><path class="edge" d="M 0 0 V -13.8916 H 4.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a27 i5 leaf node n10 p0 sample" transform="translate(1.5 13.8916)"><path class="edge" d="M 0 0 V -13.8916 H -1.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a27 c2 node n26 p0" transform="translate(10.5 1.99575)"><g class="a26 i6 leaf node n13 p0 sample" transform="translate(-3 11.8959)"><path class="edge" d="M 0 0 V -11.8959 H 3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a26 i8 leaf node n17 p0 sample" transform="translate(3 11.8959)"><path class="edge" d="M 0 0 V -11.8959 H -3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -1.99575 H -10.5"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -167.508 H -27.0938"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><g class="a33 c2 node n32 p0" transform="translate(-27.0938 94.9931)"><g class="a32 c3 node n28 p0" transform="translate(26.0625 72.5153)"><g class="a28 i4 leaf node n8 p0 sample" transform="translate(5.625 13.8916)"><path class="edge" d="M 0 0 V -13.8916 H -5.625"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a28 i6 leaf node n12 p0 sample" transform="translate(11.625 13.8916)"><path class="edge" d="M 0 0 V -13.8916 H -11.625"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a28 c2 node n24 p0" transform="translate(-11.625 2.67424)"><g class="a24 i7 leaf node n14 p0 sample" transform="translate(11.25 11.2174)"><path class="edge" d="M 0 0 V -11.2174 H -11.25"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a24 c2 node n23 p0" transform="translate(-11.25 5.34771)"><g class="a23 i0 leaf node n1 p0 sample" transform="translate(-7.5 5.86966)"><path class="edge" d="M 0 0 V -5.86966 H 7.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a23 c2 node n22 p0" transform="translate(7.5 0.881543)"><g class="a22 c2 node n20 p0" transform="translate(-6 4.74329)"><g class="a20 i2 leaf node n4 p0 sample" transform="translate(-3 0.244826)"><path class="edge" d="M 0 0 V -0.244826 H 3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a20 i5 leaf node n11 p0 sample" transform="translate(3 0.244826)"><path class="edge" d="M 0 0 V -0.244826 H -3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -4.74329 H 6"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><g class="a22 c2 node n21 p0" transform="translate(6 1.38555)"><g class="a21 i7 leaf node n15 p0 sample" transform="translate(-3 3.60257)"><path class="edge" d="M 0 0 V -3.60257 H 3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a21 i9 leaf node n19 p0 sample" transform="translate(3 3.60257)"><path class="edge" d="M 0 0 V -3.60257 H -3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -1.38555 H -6"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -0.881543 H -7.5"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -5.34771 H 11.25"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -2.67424 H 11.625"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -72.5153 H -26.0625"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><g class="a32 c2 node n31 p0" transform="translate(-26.0625 20.974)"><g class="a31 c3 node n29 p0" transform="translate(9.75 51.5413)"><g class="a29 i1 leaf node n3 p0 sample" transform="translate(-6 13.8916)"><path class="edge" d="M 0 0 V -13.8916 H 6"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a29 i2 leaf node n5 p0 sample" transform="translate(0.0 13.8916)"><path class="edge" d="M 0 0 V -13.8916 H 0.0"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a29 i9 leaf node n18 p0 sample" transform="translate(6 13.8916)"><path class="edge" d="M 0 0 V -13.8916 H -6"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -51.5413 H -9.75"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><g class="a31 c3 node n30 p0" transform="translate(-9.75 51.5413)"><g class="a30 i4 leaf node n9 p0 sample" transform="translate(1.5 13.8916)"><path class="edge" d="M 0 0 V -13.8916 H -1.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a30 i8 leaf node n16 p0 sample" transform="translate(7.5 13.8916)"><path class="edge" d="M 0 0 V -13.8916 H -7.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a30 c2 node n25 p0" transform="translate(-7.5 2.44634)"><g class="a25 i0 leaf node n0 p0 sample" transform="translate(-3 11.4453)"><path class="edge" d="M 0 0 V -11.4453 H 3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a25 i3 leaf node n6 p0 sample" transform="translate(3 11.4453)"><path class="edge" d="M 0 0 V -11.4453 H -3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -2.44634 H 7.5"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -51.5413 H 9.75"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -20.974 H 26.0625"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -94.9931 H 27.0938"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab" transform="translate(0 -14)"></text></g></g></g></g></g>
</svg>
</div>
<div>
<p><em>Selection</em></p>
<svg baseprofile="full" height="250" id="selection" version="1.1" width="200" xmlns="http://www.w3.org/2000/svg" xmlns:ev="http://www.w3.org/2001/xml-events" xlink="http://www.w3.org/1999/xlink">
<defs>
<style type="text/css">.background path {fill: #808080; fill-opacity: 0}.background path:nth-child(odd) {fill-opacity: .1}.x-regions rect {fill: yellow; stroke: black; opacity: 0.5}.axes {font-size: 14px}.x-axis .tick .lab {font-weight: bold; dominant-baseline: hanging}.axes, .tree {font-size: 14px; text-anchor: middle}.axes line, .edge {stroke: black; fill: none}.axes .ax-skip {stroke-dasharray: 4}.y-axis .grid {stroke: #FAFAFA}.node > .sym {fill: black; stroke: none}.site > .sym {stroke: black}.mut text {fill: red; font-style: italic}.mut.extra text {fill: hotpink}.mut line {fill: none; stroke: none}.mut .sym {fill: none; stroke: red}.mut.extra .sym {stroke: hotpink}.node .mut .sym {stroke-width: 1.5px}.tree text, .tree-sequence text {dominant-baseline: central}.plotbox .lab.lft {text-anchor: end}.plotbox .lab.rgt {text-anchor: start}.polytomy line {stroke: black; stroke-dasharray: 1px, 1px}.polytomy text {paint-order:stroke;stroke-width:0.3em;stroke:white}#selection { .edge {stroke-width: 2px} }</style>
</defs><g class="tree-sequence"><g class="plotbox trees"><g class="tree t0" transform="translate(20 0)"><g class="plotbox"><g class="c2 node n38 p0 root" transform="translate(115.93 26.8)"><g class="a38 i3 leaf node n6 p0 sample" transform="translate(21.0703 181.4)"><path class="edge" d="M 0 0 V -181.4 H -21.0703"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a38 c2 node n37 p0" transform="translate(-21.0703 177.216)"><g class="a37 c2 node n35 p0" transform="translate(29.3906 0.347722)"><g class="a35 i5 leaf node n10 p0 sample" transform="translate(6.75 3.83662)"><path class="edge" d="M 0 0 V -3.83662 H -6.75"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a35 c2 node n32 p0" transform="translate(-6.75 0.227613)"><g class="a32 i4 leaf node n8 p0 sample" transform="translate(-4.5 3.60901)"><path class="edge" d="M 0 0 V -3.60901 H 4.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a32 c2 node n20 p0" transform="translate(4.5 3.50084)"><g class="a20 i6 leaf node n13 p0 sample" transform="translate(-3 0.108173)"><path class="edge" d="M 0 0 V -0.108173 H 3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a20 i8 leaf node n17 p0 sample" transform="translate(3 0.108173)"><path class="edge" d="M 0 0 V -0.108173 H -3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -3.50084 H -4.5"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -0.227613 H 6.75"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -0.347722 H -29.3906"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><g class="a37 c2 node n36 p0" transform="translate(-29.3906 0.0515823)"><g class="a36 c2 node n33 p0" transform="translate(24.0938 0.503637)"><g class="a33 c2 node n30 p0" transform="translate(12.9375 0.116185)"><g class="a30 i3 leaf node n7 p0 sample" transform="translate(4.5 3.51294)"><path class="edge" d="M 0 0 V -3.51294 H -4.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a30 c2 node n24 p0" transform="translate(-4.5 0.539862)"><g class="a24 i1 leaf node n2 p0 sample" transform="translate(-3 2.97308)"><path class="edge" d="M 0 0 V -2.97308 H 3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a24 i9 leaf node n19 p0 sample" transform="translate(3 2.97308)"><path class="edge" d="M 0 0 V -2.97308 H -3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -0.539862 H 4.5"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -0.116185 H -12.9375"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><g class="a33 c2 node n31 p0" transform="translate(-12.9375 0.0757877)"><g class="a31 c2 node n22 p0" transform="translate(9.375 1.28071)"><g class="a22 i1 leaf node n3 p0 sample" transform="translate(-3 2.27263)"><path class="edge" d="M 0 0 V -2.27263 H 3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a22 i7 leaf node n15 p0 sample" transform="translate(3 2.27263)"><path class="edge" d="M 0 0 V -2.27263 H -3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -1.28071 H -9.375"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><g class="a31 c2 node n29 p0" transform="translate(-9.375 0.096237)"><g class="a29 c2 node n23 p0" transform="translate(6.75 0.592195)"><g class="a23 i2 leaf node n5 p0 sample" transform="translate(-3 2.86491)"><path class="edge" d="M 0 0 V -2.86491 H 3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a23 i4 leaf node n9 p0 sample" transform="translate(3 2.86491)"><path class="edge" d="M 0 0 V -2.86491 H -3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -0.592195 H -6.75"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><g class="a29 c2 node n25 p0" transform="translate(-6.75 0.477512)"><g class="a25 i9 leaf node n18 p0 sample" transform="translate(4.5 2.97959)"><path class="edge" d="M 0 0 V -2.97959 H -4.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a25 c2 node n21 p0" transform="translate(-4.5 1.96405)"><g class="a21 i0 leaf node n1 p0 sample" transform="translate(-3 1.01554)"><path class="edge" d="M 0 0 V -1.01554 H 3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a21 i6 leaf node n12 p0 sample" transform="translate(3 1.01554)"><path class="edge" d="M 0 0 V -1.01554 H -3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -1.96405 H 4.5"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -0.477512 H 6.75"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -0.096237 H 9.375"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -0.0757877 H 12.9375"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -0.503637 H -24.0938"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab rgt" transform="translate(0.0 -7)"></text></g><g class="a36 c2 node n34 p0" transform="translate(-24.0938 0.29664)"><g class="a34 i2 leaf node n4 p0 sample" transform="translate(5.625 3.83612)"><path class="edge" d="M 0 0 V -3.83612 H -5.625"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a34 c2 node n28 p0" transform="translate(-5.625 0.423342)"><g class="a28 i8 leaf node n16 p0 sample" transform="translate(5.25 3.41278)"><path class="edge" d="M 0 0 V -3.41278 H -5.25"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a28 c2 node n27 p0" transform="translate(-5.25 0.0765389)"><g class="a27 i7 leaf node n14 p0 sample" transform="translate(4.5 3.33624)"><path class="edge" d="M 0 0 V -3.33624 H -4.5"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a27 c2 node n26 p0" transform="translate(-4.5 0.00550879)"><g class="a26 i0 leaf node n0 p0 sample" transform="translate(-3 3.33073)"><path class="edge" d="M 0 0 V -3.33073 H 3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><g class="a26 i5 leaf node n11 p0 sample" transform="translate(3 3.33073)"><path class="edge" d="M 0 0 V -3.33073 H -3"></path><rect class="sym" height="0" width="0" x="-0" y="-0"></rect><text class="lab" transform="translate(0 14)"></text></g><path class="edge" d="M 0 0 V -0.00550879 H 4.5"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -0.0765389 H 5.25"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -0.423342 H 5.625"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -0.29664 H 24.0938"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -0.0515823 H 29.3906"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><path class="edge" d="M 0 0 V -177.216 H 21.0703"></path><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab lft" transform="translate(0.0 -7)"></text></g><circle class="sym" cx="0" cy="0" r="0"></circle><text class="lab" transform="translate(0 -14)"></text></g></g></g></g></g>
</svg>
</div>
</div>
<!-- markdownlint-enable MD013 -->
</div><div class="column" style="width:50%;">
<!-- markdownlint-disable MD013 -->
<div id="fig-sfs-neutrality-selection" class="quarto-float quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-sfs-neutrality-selection-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="assets/images/nielsen-fig2-2005.webp" class="lightbox" data-gallery="quarto-lightbox-gallery-26" title="Figure&nbsp;10: The SFS under neutrality and selection"><img data-src="assets/images/nielsen-fig2-2005.webp" width="450"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-sfs-neutrality-selection-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: The SFS under neutrality and selection
</figcaption>
</figure>
</div>
<!-- markdownlint-enable MD013 -->
<p>Many tests for selection are based on the SFS which in turn is influenced by the topology of the tree.</p>
</div></div>
<aside class="notes">
<p>Take home: topologies influence shape of SFS</p>
<h3 class="ultitle" id="example-tajimas-d">Example: Tajima’s D</h3>
<p>Tests common versus rare alleles. Numerator compares nucleotide diversity <span class="math inline">\pi</span> to Watterson’s theta, <span class="math inline">\theta_W</span>.</p>
<dl>
<dt>D &lt; 0</dt>
<dd>
recent population increase <em>or</em> positive selection
</dd>
<dt>D &gt; 0</dt>
<dd>
population contraction <em>or</em> balancing selection
</dd>
</dl>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="msprime" class="slide level2 ultitle">
<h2>msprime</h2>
<div class="columns">
<div class="column" style="width:60%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="../../slides/simulation/assets/images/jerome.webp" class="lightbox" data-gallery="quarto-lightbox-gallery-27" title="Jerome Kelleher"><img data-src="../../slides/simulation/assets/images/jerome.webp" class="quarto-figure quarto-figure-center" style="width:30.0%" alt="Jerome Kelleher"></a></p>
</figure>
</div>
<figcaption>Jerome Kelleher</figcaption>
</figure>
</div>
<ul>
<li>Fast &amp; flexible backward-time simulator</li>
<li>Separates <em>ancestry</em> from <em>mutation</em> simulation</li>
<li>Arbitrary discrete demographies / species</li>
<li>Pedigree support (e.g., 1M+ Quebec ARG)</li>
<li>Approximate extension to selective sweeps</li>
</ul>
</div><div class="column" style="width:40%;">
<p><img data-src="../../slides/simulation/assets/images/msprime.webp" alt="msprime"><br>
</p>
<p><img data-src="../../slides/simulation/assets/images/demes.webp" alt="demes"><br>
</p>
</div></div>
</section>
<section id="msprime-stores-data-as-succinct-tree-sequences" class="slide level2 ultitle">
<h2>msprime stores data as succinct tree sequences</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="assets/images/baumdicker-2022-fig2.webp" class="lightbox" data-gallery="quarto-lightbox-gallery-28" title="Tree sequences [@baumdicker_EfficientAncestryMutation_2022, Fig. 2]"><img data-src="assets/images/baumdicker-2022-fig2.webp" width="700" alt="Tree sequences (Baumdicker et al., 2022, Figure 2)"></a></p>
<figcaption>Tree sequences <span class="citation" data-cites="baumdicker_EfficientAncestryMutation_2022">(<a href="#/bibliography" role="doc-biblioref" onclick="">Baumdicker et al., 2022, Figure 2</a>)</span></figcaption>
</figure>
</div>
</section>
<section id="tree-sequences-compress-data-and-speedup-analyses" class="slide level2 ultitle">
<h2>Tree sequences compress data and speedup analyses</h2>
<div style="display: grid; grid-template-columns: 400px 140px 600px; 220:grid-row-gap: 0px; grid-column-gap: 10px;">
<div>
<ul>
<li>Compact storage (“domain specific compression”)</li>
<li>Fast, efficient analysis (a “succinct” structure)</li>
<li>Well tested, open source (active dev community)</li>
</ul>
</div>
<div class="smallr">
<p>Data compression</p>
</div>
<div>
<p><a href="assets/images/tskit-data-compression.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-29"><img data-src="assets/images/tskit-data-compression.svg" style="width:80.0%"></a></p>
</div>
<div>
<ul>
<li>Built-in functionality (well documented: <a href="http://tskit.dev" class="uri">http://tskit.dev</a>)</li>
</ul>
<div class="smallr">
<p>…but limited support for major genomic rearrangements (e.g. inversions, large indels): genomes should be (reasonably) aligned =&gt; current primary focus = <strong>population genetics</strong></p>
</div>
</div>
<div class="smallr">
<p>Speed</p>
</div>
<div>
<p><a href="assets/images/tskit-analysis-speed.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-30"><img data-src="assets/images/tskit-analysis-speed.svg" style="width:80.0%"></a></p>
</div>
<div>

</div>
<div>

</div>
<div class="smallest">
<div class="flushright">
<p>Source: <a href="https://tskit.dev/tutorials/what_is.html">What is a tree sequence? (https://tskit.dev/tutorials/what_is.html)</a></p>
</div>
</div>
</div>
</section>
<section id="tskit-terminology-the-basics" class="slide level2 ultitle">
<h2>tskit terminology: the basics</h2>
<svg baseprofile="full" height="380" version="1.1" width="1200" xmlns="http://www.w3.org/2000/svg" xmlns:ev="http://www.w3.org/2001/xml-events" xlink="http://www.w3.org/1999/xlink">
<defs>
<style type="text/css">.background path {fill: #808080; fill-opacity: 0}.background path:nth-child(odd) {fill-opacity: .1}.x-regions rect {fill: yellow; stroke: black; opacity: 0.5}.axes {font-size: 14px}.x-axis .tick .lab {font-weight: bold; dominant-baseline: hanging}.axes, .tree {font-size: 14px; text-anchor: middle}.axes line, .edge {stroke: black; fill: none}.axes .ax-skip {stroke-dasharray: 4}.y-axis .grid {stroke: #FAFAFA}.node > .sym {fill: black; stroke: none}.site > .sym {stroke: black}.mut text {fill: red; font-style: italic}.mut.extra text {fill: hotpink}.mut line {fill: none; stroke: none}.mut .sym {fill: none; stroke: red}.mut.extra .sym {stroke: hotpink}.node .mut .sym {stroke-width: 1.5px}.tree text, .tree-sequence text {dominant-baseline: central}.plotbox .lab.lft {text-anchor: end}.plotbox .lab.rgt {text-anchor: start}.polytomy line {stroke: black; stroke-dasharray: 1px, 1px}.polytomy text {paint-order:stroke;stroke-width:0.3em;stroke:white}.node > .lab {font-size: 150%}.x-axis {font-size: 150%}.y-axis {font-size: 150%}</style>
</defs><g class="tree-sequence"><g class="background"><path d="M56.8,0 l374.4,0 l0,318.2 l-29.5776,25 l0,5 l-344.822,0 l0,-5 l0,-25 l0,-318.2z"></path><path d="M431.2,0 l374.4,0 l0,318.2 l-111.946,25 l0,5 l-292.032,0 l0,-5 l29.578,-25 l0,-318.2z"></path><path d="M805.6,0 l374.4,0 l0,318.2 l0,25 l0,5 l-486.346,0 l0,-5 l111.946,-25 l0,-318.2z"></path></g><g class="axes"><g class="x-axis"><g class="title" transform="translate(618.4 380)"><text class="lab" text-anchor="middle" transform="translate(0 -11)">Genome position</text></g><line class="ax-line" x1="56.8" x2="1180" y1="343.2" y2="343.2"></line><g class="ticks"><g class="tick" transform="translate(56.8 343.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">0</text></g></g><g class="tick" transform="translate(401.622 343.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">307</text></g></g><g class="tick" transform="translate(693.654 343.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">567</text></g></g><g class="tick" transform="translate(1180 343.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">1000</text></g></g></g></g><g class="y-axis"><g class="title" transform="translate(0 155.7)"><text class="lab" text-anchor="middle" transform="translate(11) rotate(-90)">Time ago (generations)</text></g><line class="ax-line" x1="56.8" x2="56.8" y1="301.4" y2="10"></line><g class="ticks"><g class="tick" transform="translate(56.8 301.4)"><line class="grid" x1="0" x2="1123.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">0</text></g></g><g class="tick" transform="translate(56.8 241.989)"><line class="grid" x1="0" x2="1123.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">3</text></g></g><g class="tick" transform="translate(56.8 198.635)"><line class="grid" x1="0" x2="1123.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">10</text></g></g><g class="tick" transform="translate(56.8 154.232)"><line class="grid" x1="0" x2="1123.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">30</text></g></g><g class="tick" transform="translate(56.8 103.613)"><line class="grid" x1="0" x2="1123.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">100</text></g></g><g class="tick" transform="translate(56.8 56.8149)"><line class="grid" x1="0" x2="1123.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">300</text></g></g><g class="tick" transform="translate(56.8 14.8693)"><line class="grid" x1="0" x2="1123.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">800</text></g></g></g></g></g><g class="plotbox trees"><g class="tree t0" transform="translate(56.8 0)"><g class="plotbox"><g class="c2 node n11 p0 root" transform="translate(204.617 26.8)"><g class="a11 c2 node n7 p0" transform="translate(94.05 114.459)"><g class="a7 i0 leaf node n1 p0 sample" transform="translate(-27.8667 160.141)"><path class="edge" d="M 0 0 V -160.141 H 27.8667"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">1</text></g><g class="a7 i2 leaf node n4 p0 sample" transform="translate(27.8667 160.141)"><path class="edge" d="M 0 0 V -160.141 H -27.8667"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">4</text></g><path class="edge" d="M 0 0 V -114.459 H -94.05"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">7</text></g><g class="a11 c2 node n10 p0" transform="translate(-94.05 24.6481)"><g class="a10 i0 leaf node n0 p0 sample" transform="translate(-62.7 249.952)"><path class="edge" d="M 0 0 V -249.952 H 62.7"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">0</text></g><g class="a10 c2 node n8 p0" transform="translate(62.7 65.7692)"><g class="a8 i1 leaf node n3 p0 sample" transform="translate(41.8 184.183)"><path class="edge" d="M 0 0 V -184.183 H -41.8"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">3</text></g><g class="a8 c2 node n6 p0" transform="translate(-41.8 66.1697)"><g class="a6 i1 leaf node n2 p0 sample" transform="translate(-27.8667 118.013)"><path class="edge" d="M 0 0 V -118.013 H 27.8667"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">2</text></g><g class="a6 i2 leaf node n5 p0 sample" transform="translate(27.8667 118.013)"><path class="edge" d="M 0 0 V -118.013 H -27.8667"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">5</text></g><path class="edge" d="M 0 0 V -66.1697 H 41.8"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">6</text></g><path class="edge" d="M 0 0 V -65.7692 H -62.7"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">8</text></g><path class="edge" d="M 0 0 V -24.6481 H 94.05"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">10</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab" transform="translate(0 -11)">11</text></g></g></g><g class="tree t1" transform="translate(431.2 0)"><g class="plotbox"><g class="c2 node n10 p0 root" transform="translate(187.2 51.4481)"><g class="a10 c2 node n8 p0" transform="translate(97.5333 65.7692)"><g class="a8 i1 leaf node n3 p0 sample" transform="translate(41.8 184.183)"><path class="edge" d="M 0 0 V -184.183 H -41.8"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">3</text></g><g class="a8 c2 node n6 p0" transform="translate(-41.8 66.1697)"><g class="a6 i1 leaf node n2 p0 sample" transform="translate(-27.8667 118.013)"><path class="edge" d="M 0 0 V -118.013 H 27.8667"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">2</text></g><g class="a6 i2 leaf node n5 p0 sample" transform="translate(27.8667 118.013)"><path class="edge" d="M 0 0 V -118.013 H -27.8667"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">5</text></g><path class="edge" d="M 0 0 V -66.1697 H 41.8"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">6</text></g><path class="edge" d="M 0 0 V -65.7692 H -97.5333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">8</text></g><g class="a10 c2 node n9 p0" transform="translate(-97.5333 5.76395)"><g class="a9 i0 leaf node n0 p0 sample" transform="translate(-41.8 244.188)"><path class="edge" d="M 0 0 V -244.188 H 41.8"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">0</text></g><g class="a9 c2 node n7 p0" transform="translate(41.8 84.047)"><g class="a7 i0 leaf node n1 p0 sample" transform="translate(-27.8667 160.141)"><path class="edge" d="M 0 0 V -160.141 H 27.8667"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">1</text></g><g class="a7 i2 leaf node n4 p0 sample" transform="translate(27.8667 160.141)"><path class="edge" d="M 0 0 V -160.141 H -27.8667"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">4</text></g><path class="edge" d="M 0 0 V -84.047 H -41.8"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">7</text></g><path class="edge" d="M 0 0 V -5.76395 H 97.5333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">9</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab" transform="translate(0 -11)">10</text></g></g></g><g class="tree t2" transform="translate(805.6 0)"><g class="plotbox"><g class="c2 node n11 p0 root" transform="translate(187.2 26.8)"><g class="a11 c2 node n8 p0" transform="translate(97.5333 90.4173)"><g class="a8 i1 leaf node n3 p0 sample" transform="translate(41.8 184.183)"><path class="edge" d="M 0 0 V -184.183 H -41.8"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">3</text></g><g class="a8 c2 node n6 p0" transform="translate(-41.8 66.1697)"><g class="a6 i1 leaf node n2 p0 sample" transform="translate(-27.8667 118.013)"><path class="edge" d="M 0 0 V -118.013 H 27.8667"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">2</text></g><g class="a6 i2 leaf node n5 p0 sample" transform="translate(27.8667 118.013)"><path class="edge" d="M 0 0 V -118.013 H -27.8667"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">5</text></g><path class="edge" d="M 0 0 V -66.1697 H 41.8"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">6</text></g><path class="edge" d="M 0 0 V -90.4173 H -97.5333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">8</text></g><g class="a11 c2 node n9 p0" transform="translate(-97.5333 30.4121)"><g class="a9 i0 leaf node n0 p0 sample" transform="translate(-41.8 244.188)"><path class="edge" d="M 0 0 V -244.188 H 41.8"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">0</text></g><g class="a9 c2 node n7 p0" transform="translate(41.8 84.047)"><g class="a7 i0 leaf node n1 p0 sample" transform="translate(-27.8667 160.141)"><path class="edge" d="M 0 0 V -160.141 H 27.8667"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">1</text></g><g class="a7 i2 leaf node n4 p0 sample" transform="translate(27.8667 160.141)"><path class="edge" d="M 0 0 V -160.141 H -27.8667"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">4</text></g><path class="edge" d="M 0 0 V -84.047 H -41.8"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">7</text></g><path class="edge" d="M 0 0 V -30.4121 H 97.5333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">9</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab" transform="translate(0 -11)">11</text></g></g></g></g></g>
</svg>
<div>
<ul>
<li>Multiple local trees exist along a genome of fixed length (by convention measured in base pairs)</li>
<li>Genomes exist at specific times, and arerepresented by nodes (the same node can persist across many local trees)</li>
<li>Some nodes are most recent common ancestors (MRCAs) of other nodes</li>
<li>Entities are zero-based: the rst node has id 0, the second id 1, …</li>
</ul>
</div>
<div class="flushright">
<p>Images from online tutorial “Terminology &amp; concepts” <a href="https://tskit.dev/tutorials/terminology_and_concepts.html" class="uri">https://tskit.dev/tutorials/terminology_and_concepts.html</a></p>
</div>
</section>
<section id="tskit-terminology-nodes-and-edges" class="slide level2 smallest ultitle">
<h2>tskit terminology: nodes and edges</h2>
<div class="columns">
<div class="column" style="width:50%;">
<svg baseprofile="full" height="200" version="1.1" width="500" xmlns="http://www.w3.org/2000/svg" xmlns:ev="http://www.w3.org/2001/xml-events" xlink="http://www.w3.org/1999/xlink">
<defs>
<style type="text/css">.background path {fill: #808080; fill-opacity: 0}.background path:nth-child(odd) {fill-opacity: .1}.x-regions rect {fill: yellow; stroke: black; opacity: 0.5}.axes {font-size: 14px}.x-axis .tick .lab {font-weight: bold; dominant-baseline: hanging}.axes, .tree {font-size: 14px; text-anchor: middle}.axes line, .edge {stroke: black; fill: none}.axes .ax-skip {stroke-dasharray: 4}.y-axis .grid {stroke: #FAFAFA}.node > .sym {fill: black; stroke: none}.site > .sym {stroke: black}.mut text {fill: red; font-style: italic}.mut.extra text {fill: hotpink}.mut line {fill: none; stroke: none}.mut .sym {fill: none; stroke: red}.mut.extra .sym {stroke: hotpink}.node .mut .sym {stroke-width: 1.5px}.tree text, .tree-sequence text {dominant-baseline: central}.plotbox .lab.lft {text-anchor: end}.plotbox .lab.rgt {text-anchor: start}.polytomy line {stroke: black; stroke-dasharray: 1px, 1px}.polytomy text {paint-order:stroke;stroke-width:0.3em;stroke:white}.node > .lab {font-size: 75%}.x-axis {font-size: 75%}.y-axis {font-size: 75%}</style>
</defs><g class="tree-sequence"><g class="background"><path d="M56.8,0 l141.067,0 l0,138.2 l-11.1443,25 l0,5 l-129.922,0 l0,-5 l0,-25 l0,-138.2z"></path><path d="M197.867,0 l141.067,0 l0,138.2 l-42.1789,25 l0,5 l-110.032,0 l0,-5 l11.145,-25 l0,-138.2z"></path><path d="M338.933,0 l141.067,0 l0,138.2 l0,25 l0,5 l-183.246,0 l0,-5 l42.179,-25 l0,-138.2z"></path></g><g class="axes"><g class="x-axis"><g class="title" transform="translate(268.4 200)"><text class="lab" text-anchor="middle" transform="translate(0 -11)">Genome position</text></g><line class="ax-line" x1="56.8" x2="480" y1="163.2" y2="163.2"></line><g class="ticks"><g class="tick" transform="translate(56.8 163.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">0</text></g></g><g class="tick" transform="translate(186.722 163.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">307</text></g></g><g class="tick" transform="translate(296.754 163.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">567</text></g></g><g class="tick" transform="translate(480 163.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">1000</text></g></g></g></g><g class="y-axis"><g class="title" transform="translate(0 65.7)"><text class="lab" text-anchor="middle" transform="translate(11) rotate(-90)">Time ago (generations)</text></g><line class="ax-line" x1="56.8" x2="56.8" y1="121.4" y2="10"></line><g class="ticks"><g class="tick" transform="translate(56.8 121.4)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">0</text></g></g><g class="tick" transform="translate(56.8 100.933)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">3</text></g></g><g class="tick" transform="translate(56.8 85.9974)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">10</text></g></g><g class="tick" transform="translate(56.8 70.7006)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">30</text></g></g><g class="tick" transform="translate(56.8 53.2623)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">100</text></g></g><g class="tick" transform="translate(56.8 37.1402)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">300</text></g></g><g class="tick" transform="translate(56.8 19.3991)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">1000</text></g></g></g></g></g><g class="plotbox trees"><g class="tree t0" transform="translate(56.8 0)"><g class="plotbox"><g class="c2 node n11 p0 root" transform="translate(75.7972 26.8)"><g class="a11 c2 node n7 p0" transform="translate(28.425 39.4313)"><g class="a7 i0 leaf node n1 p0 sample" transform="translate(-8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">1</text></g><g class="a7 i2 leaf node n4 p0 sample" transform="translate(8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">4</text></g><path class="edge" d="M 0 0 V -39.4313 H -28.425"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">7</text></g><g class="a11 c2 node n10 p0" transform="translate(-28.425 8.49131)"><g class="a10 i0 leaf node n0 p0 sample" transform="translate(-18.95 86.1087)"><path class="edge" d="M 0 0 V -86.1087 H 18.95"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">0</text></g><g class="a10 c2 node n8 p0" transform="translate(18.95 22.6576)"><g class="a8 i1 leaf node n3 p0 sample" transform="translate(12.6333 63.4511)"><path class="edge" d="M 0 0 V -63.4511 H -12.6333"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">3</text></g><g class="a8 c2 node n6 p0" transform="translate(-12.6333 22.7955)"><g class="a6 i1 leaf node n2 p0 sample" transform="translate(-8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">2</text></g><g class="a6 i2 leaf node n5 p0 sample" transform="translate(8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">5</text></g><path class="edge" d="M 0 0 V -22.7955 H 12.6333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">6</text></g><path class="edge" d="M 0 0 V -22.6576 H -18.95"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">8</text></g><path class="edge" d="M 0 0 V -8.49131 H 28.425"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">10</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab" transform="translate(0 -11)">11</text></g></g></g><g class="tree t1" transform="translate(197.867 0)"><g class="plotbox"><g class="c2 node n10 p0 root" transform="translate(70.5333 35.2913)"><g class="a10 c2 node n8 p0" transform="translate(29.4778 22.6576)"><g class="a8 i1 leaf node n3 p0 sample" transform="translate(12.6333 63.4511)"><path class="edge" d="M 0 0 V -63.4511 H -12.6333"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">3</text></g><g class="a8 c2 node n6 p0" transform="translate(-12.6333 22.7955)"><g class="a6 i1 leaf node n2 p0 sample" transform="translate(-8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">2</text></g><g class="a6 i2 leaf node n5 p0 sample" transform="translate(8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">5</text></g><path class="edge" d="M 0 0 V -22.7955 H 12.6333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">6</text></g><path class="edge" d="M 0 0 V -22.6576 H -29.4778"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">8</text></g><g class="a10 c2 node n9 p0" transform="translate(-29.4778 1.98569)"><g class="a9 i0 leaf node n0 p0 sample" transform="translate(-12.6333 84.123)"><path class="edge" d="M 0 0 V -84.123 H 12.6333"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">0</text></g><g class="a9 c2 node n7 p0" transform="translate(12.6333 28.9543)"><g class="a7 i0 leaf node n1 p0 sample" transform="translate(-8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">1</text></g><g class="a7 i2 leaf node n4 p0 sample" transform="translate(8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">4</text></g><path class="edge" d="M 0 0 V -28.9543 H -12.6333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">7</text></g><path class="edge" d="M 0 0 V -1.98569 H 29.4778"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">9</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab" transform="translate(0 -11)">10</text></g></g></g><g class="tree t2" transform="translate(338.933 0)"><g class="plotbox"><g class="c2 node n11 p0 root" transform="translate(70.5333 26.8)"><g class="a11 c2 node n8 p0" transform="translate(29.4778 31.1489)"><g class="a8 i1 leaf node n3 p0 sample" transform="translate(12.6333 63.4511)"><path class="edge" d="M 0 0 V -63.4511 H -12.6333"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">3</text></g><g class="a8 c2 node n6 p0" transform="translate(-12.6333 22.7955)"><g class="a6 i1 leaf node n2 p0 sample" transform="translate(-8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">2</text></g><g class="a6 i2 leaf node n5 p0 sample" transform="translate(8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">5</text></g><path class="edge" d="M 0 0 V -22.7955 H 12.6333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">6</text></g><path class="edge" d="M 0 0 V -31.1489 H -29.4778"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">8</text></g><g class="a11 c2 node n9 p0" transform="translate(-29.4778 10.477)"><g class="a9 i0 leaf node n0 p0 sample" transform="translate(-12.6333 84.123)"><path class="edge" d="M 0 0 V -84.123 H 12.6333"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">0</text></g><g class="a9 c2 node n7 p0" transform="translate(12.6333 28.9543)"><g class="a7 i0 leaf node n1 p0 sample" transform="translate(-8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">1</text></g><g class="a7 i2 leaf node n4 p0 sample" transform="translate(8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">4</text></g><path class="edge" d="M 0 0 V -28.9543 H -12.6333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">7</text></g><path class="edge" d="M 0 0 V -10.477 H 29.4778"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">9</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab" transform="translate(0 -11)">11</text></g></g></g></g></g>
</svg>
<div class="fragment">
<p><strong>Nodes (=genomes)</strong></p>
<ul>
<li>exist at a specific <span class="cbppink heavy">time</span></li>
<li>can be <span class="cbpgreen heavy">flagged</span> as “samples”</li>
<li>can belong to “<span class="cbporange heavy">individuals</span>” (e.g., 2 nodes per individuals in humans) and, if useful, “<span class="cbptomato heavy">populations</span>”</li>
</ul>
<div class="small dna">
<!-- markdownlint-disable MD013 -->
<table class="caption-top">
<colgroup>
<col style="width: 19%">
<col style="width: 7%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 21%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">id</th>
<th style="text-align: right;">flags</th>
<th style="text-align: right;">population</th>
<th style="text-align: right;">individual</th>
<th style="text-align: right;"><span class="cbppink-bg">time</span></th>
<th style="text-align: right;">metadata</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00000000</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;"><span class="cbporange-bg">0</span></td>
<td style="text-align: right;">0.00000000</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;"><span class="cbporange-bg">1</span></td>
<td style="text-align: right;">0.00000000</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"><span class="cbptomato-bg">0</span></td>
<td style="text-align: right;"><span class="cbporange-bg">1</span></td>
<td style="text-align: right;">0.00000000</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"><span class="cbptomato-bg">0</span></td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.00000000</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;"><span class="cbpgreen-bg">5</span></td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"><span class="cbptomato-bg">0</span></td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.00000000</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;"><span class="cbpgreen-bg">6</span></td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">14.70054184</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">40.95936939</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">8</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">72.52965866</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">297.22307150</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">10</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">340.15496436</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">11</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;">605.35907657</td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<!-- markdownlint-enable MD013 -->
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<p><strong>Edges</strong></p>
<ul>
<li>Connect a <span class="cbppink heavy">parent &amp; child</span></li>
<li>Have a <span class="cbpblue heavy">left &amp; right</span> genomic coordinate</li>
<li>Usually span multiple trees (e.g., edges connecting nodes 1+7 and 4+7)</li>
</ul>
<div class="small dna">
<!-- markdownlint-disable MD013 -->
<table class="caption-top">
<colgroup>
<col style="width: 4%">
<col style="width: 18%">
<col style="width: 21%">
<col style="width: 23%">
<col style="width: 22%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">id</th>
<th style="text-align: right;">left</th>
<th style="text-align: right;">right</th>
<th style="text-align: right;"><span class="cbppink-bg">parent</span></th>
<th style="text-align: right;"><span class="cbppink-bg">child</span></th>
<th style="text-align: right;">metadata</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1000</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1000</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;"><span class="cbpblue-bg">0</span></td>
<td style="text-align: right;"><span class="cbpblue-bg">1000</span></td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;"><span class="cbpblue-bg">0</span></td>
<td style="text-align: right;"><span class="cbpblue-bg">1000</span></td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1000</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1000</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">307</td>
<td style="text-align: right;">1000</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: right;">307</td>
<td style="text-align: right;">1000</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">8</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">307</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">567</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">10</td>
<td style="text-align: right;">307</td>
<td style="text-align: right;">567</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">11</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">307</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">12</td>
<td style="text-align: right;">567</td>
<td style="text-align: right;">1000</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td style="text-align: right;">567</td>
<td style="text-align: right;">1000</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">14</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">307</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<!-- markdownlint-enable MD013 -->
</div>
</div>
</div></div>
</section>
<section id="tskit-terminology-sites-and-mutations" class="slide level2 ultitle">
<h2>tskit terminology: sites and mutations</h2>
<div class="columns">
<div class="column" style="width:50%;">
<svg baseprofile="full" height="200" id="tsmut1" version="1.1" width="500" xmlns="http://www.w3.org/2000/svg" xmlns:ev="http://www.w3.org/2001/xml-events" xlink="http://www.w3.org/1999/xlink">
<defs>
<style type="text/css">.background path {fill: #808080; fill-opacity: 0}.background path:nth-child(odd) {fill-opacity: .1}.x-regions rect {fill: yellow; stroke: black; opacity: 0.5}.axes {font-size: 14px}.x-axis .tick .lab {font-weight: bold; dominant-baseline: hanging}.axes, .tree {font-size: 14px; text-anchor: middle}.axes line, .edge {stroke: black; fill: none}.axes .ax-skip {stroke-dasharray: 4}.y-axis .grid {stroke: #FAFAFA}.node > .sym {fill: black; stroke: none}.site > .sym {stroke: black}.mut text {fill: red; font-style: italic}.mut.extra text {fill: hotpink}.mut line {fill: none; stroke: none}.mut .sym {fill: none; stroke: red}.mut.extra .sym {stroke: hotpink}.node .mut .sym {stroke-width: 1.5px}.tree text, .tree-sequence text {dominant-baseline: central}.plotbox .lab.lft {text-anchor: end}.plotbox .lab.rgt {text-anchor: start}.polytomy line {stroke: black; stroke-dasharray: 1px, 1px}.polytomy text {paint-order:stroke;stroke-width:0.3em;stroke:white}#tsmut1 {.node > .lab {font-size: 75%} .x-axis {font-size: 75%} .y-axis {font-size: 75%} .mut .sym {stroke: none} .mut .lab {fill: none} .site  {stroke-width: 1px} }</style>
</defs><g class="tree-sequence"><g class="background"><path d="M56.8,0 l141.067,0 l0,138.2 l-11.1443,25 l0,5 l-129.922,0 l0,-5 l0,-25 l0,-138.2z"></path><path d="M197.867,0 l141.067,0 l0,138.2 l-42.1789,25 l0,5 l-110.032,0 l0,-5 l11.145,-25 l0,-138.2z"></path><path d="M338.933,0 l141.067,0 l0,138.2 l0,25 l0,5 l-183.246,0 l0,-5 l42.179,-25 l0,-138.2z"></path></g><g class="axes"><g class="x-axis"><g class="title" transform="translate(268.4 200)"><text class="lab" text-anchor="middle" transform="translate(0 -11)">Genome position</text></g><line class="ax-line" x1="56.8" x2="480" y1="163.2" y2="163.2"></line><g class="ticks"><g class="tick" transform="translate(56.8 163.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">0</text></g></g><g class="tick" transform="translate(186.722 163.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">307</text></g></g><g class="tick" transform="translate(296.754 163.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">567</text></g></g><g class="tick" transform="translate(480 163.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">1000</text></g></g></g><g class="site s0" transform="translate(78.8064 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m0"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s1" transform="translate(141.44 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m1"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s2" transform="translate(198.572 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m2"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s3" transform="translate(206.613 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m4"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g><g class="mut m3"><polyline class="sym" points="2.5,-10.5 0,-5.5 -2.5,-10.5"></polyline></g></g><g class="site s4" transform="translate(257.397 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m5"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s5" transform="translate(278.134 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m6"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s6" transform="translate(384.357 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m7"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s7" transform="translate(393.667 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m8"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s8" transform="translate(461.802 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m9"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g></g><g class="y-axis"><g class="title" transform="translate(0 65.7)"><text class="lab" text-anchor="middle" transform="translate(11) rotate(-90)">Time ago (generations)</text></g><line class="ax-line" x1="56.8" x2="56.8" y1="121.4" y2="10"></line><g class="ticks"><g class="tick" transform="translate(56.8 121.4)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">0</text></g></g><g class="tick" transform="translate(56.8 100.933)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">3</text></g></g><g class="tick" transform="translate(56.8 85.9974)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">10</text></g></g><g class="tick" transform="translate(56.8 70.7006)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">30</text></g></g><g class="tick" transform="translate(56.8 53.2623)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">100</text></g></g><g class="tick" transform="translate(56.8 37.1402)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">300</text></g></g><g class="tick" transform="translate(56.8 19.3991)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">1000</text></g></g></g></g></g><g class="plotbox trees"><g class="tree t0" transform="translate(56.8 0)"><g class="plotbox"><g class="c2 node n11 p0 root" transform="translate(75.7972 26.8)"><g class="a11 c2 node n7 p0" transform="translate(28.425 39.4313)"><g class="a7 i0 leaf node n1 p0 sample" transform="translate(-8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">1</text></g><g class="a7 i2 leaf node n4 p0 sample" transform="translate(8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">4</text></g><path class="edge" d="M 0 0 V -39.4313 H -28.425"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">7</text></g><g class="a11 c2 node n10 p0" transform="translate(-28.425 8.49131)"><g class="a10 i0 leaf m1 node n0 p0 s1 sample" transform="translate(-18.95 86.1087)"><path class="edge" d="M 0 0 V -86.1087 H 18.95"></path><g class="mut m1 s1" transform="translate(0 -75.8949)"><line x1="0" x2="0" y1="0" y2="75.8949"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab lft" transform="translate(-5 0)">1</text></g><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">0</text></g><g class="a10 c2 m0 node n8 p0 s0" transform="translate(18.95 22.6576)"><g class="a8 i1 leaf node n3 p0 sample" transform="translate(12.6333 63.4511)"><path class="edge" d="M 0 0 V -63.4511 H -12.6333"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">3</text></g><g class="a8 c2 node n6 p0" transform="translate(-12.6333 22.7955)"><g class="a6 i1 leaf node n2 p0 sample" transform="translate(-8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">2</text></g><g class="a6 i2 leaf node n5 p0 sample" transform="translate(8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">5</text></g><path class="edge" d="M 0 0 V -22.7955 H 12.6333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">6</text></g><path class="edge" d="M 0 0 V -22.6576 H -18.95"></path><g class="mut m0 s0" transform="translate(0 -18.0003)"><line x1="0" x2="0" y1="0" y2="18.0003"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">0</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">8</text></g><path class="edge" d="M 0 0 V -8.49131 H 28.425"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">10</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab" transform="translate(0 -11)">11</text></g></g></g><g class="tree t1" transform="translate(197.867 0)"><g class="plotbox"><g class="c2 node n10 p0 root" transform="translate(70.5333 35.2913)"><g class="a10 c2 node n8 p0" transform="translate(29.4778 22.6576)"><g class="a8 i1 leaf m2 m5 node n3 p0 s2 s4 sample" transform="translate(12.6333 63.4511)"><path class="edge" d="M 0 0 V -63.4511 H -12.6333"></path><g class="mut m5 s4" transform="translate(0 -55.7768)"><line x1="0" x2="0" y1="0" y2="55.7768"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">5</text></g><g class="mut m2 s2" transform="translate(0 -51.5519)"><line x1="0" x2="0" y1="0" y2="51.5519"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">2</text></g><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">3</text></g><g class="a8 c2 node n6 p0" transform="translate(-12.6333 22.7955)"><g class="a6 i1 leaf node n2 p0 sample" transform="translate(-8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">2</text></g><g class="a6 i2 leaf node n5 p0 sample" transform="translate(8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">5</text></g><path class="edge" d="M 0 0 V -22.7955 H 12.6333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">6</text></g><path class="edge" d="M 0 0 V -22.6576 H -29.4778"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">8</text></g><g class="a10 c2 m3 node n9 p0 s3" transform="translate(-29.4778 1.98569)"><g class="a9 i0 leaf node n0 p0 sample" transform="translate(-12.6333 84.123)"><path class="edge" d="M 0 0 V -84.123 H 12.6333"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">0</text></g><g class="a9 c2 m4 m6 node n7 p0 s3 s5" transform="translate(12.6333 28.9543)"><g class="a7 i0 leaf node n1 p0 sample" transform="translate(-8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">1</text></g><g class="a7 i2 leaf node n4 p0 sample" transform="translate(8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">4</text></g><path class="edge" d="M 0 0 V -28.9543 H -12.6333"></path><g class="mut m4 s3" transform="translate(0 -7.98068)"><line x1="0" x2="0" y1="0" y2="7.98068"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">4</text></g><g class="mut m6 s5" transform="translate(0 -4.3773)"><line x1="0" x2="0" y1="0" y2="4.3773"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">6</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">7</text></g><path class="edge" d="M 0 0 V -1.98569 H 29.4778"></path><g class="mut m3 s3" transform="translate(0 -1.37181)"><line x1="0" x2="0" y1="0" y2="1.37181"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab lft" transform="translate(-5 0)">3</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">9</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab" transform="translate(0 -11)">10</text></g></g></g><g class="tree t2" transform="translate(338.933 0)"><g class="plotbox"><g class="c2 node n11 p0 root" transform="translate(70.5333 26.8)"><g class="a11 c2 m8 node n8 p0 s7" transform="translate(29.4778 31.1489)"><g class="a8 i1 leaf node n3 p0 sample" transform="translate(12.6333 63.4511)"><path class="edge" d="M 0 0 V -63.4511 H -12.6333"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">3</text></g><g class="a8 c2 node n6 p0" transform="translate(-12.6333 22.7955)"><g class="a6 i1 leaf node n2 p0 sample" transform="translate(-8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">2</text></g><g class="a6 i2 leaf node n5 p0 sample" transform="translate(8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">5</text></g><path class="edge" d="M 0 0 V -22.7955 H 12.6333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">6</text></g><path class="edge" d="M 0 0 V -31.1489 H -29.4778"></path><g class="mut m8 s7" transform="translate(0 -12.4493)"><line x1="0" x2="0" y1="0" y2="12.4493"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">8</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">8</text></g><g class="a11 c2 node n9 p0" transform="translate(-29.4778 10.477)"><g class="a9 i0 leaf m7 m9 node n0 p0 s6 s8 sample" transform="translate(-12.6333 84.123)"><path class="edge" d="M 0 0 V -84.123 H 12.6333"></path><g class="mut m7 s6" transform="translate(0 -82.1448)"><line x1="0" x2="0" y1="0" y2="82.1448"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab lft" transform="translate(-5 0)">7</text></g><g class="mut m9 s8" transform="translate(0 -55.6922)"><line x1="0" x2="0" y1="0" y2="55.6922"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab lft" transform="translate(-5 0)">9</text></g><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">0</text></g><g class="a9 c2 node n7 p0" transform="translate(12.6333 28.9543)"><g class="a7 i0 leaf node n1 p0 sample" transform="translate(-8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">1</text></g><g class="a7 i2 leaf node n4 p0 sample" transform="translate(8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">4</text></g><path class="edge" d="M 0 0 V -28.9543 H -12.6333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">7</text></g><path class="edge" d="M 0 0 V -10.477 H 29.4778"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">9</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab" transform="translate(0 -11)">11</text></g></g></g></g></g>
</svg>
</div><div class="column" style="width:50%;">
<p>This is how we can encode genetic variation. Most genomic positions do not vary between genomes: usually we don’t bother tracking these.</p>
</div></div>
</section>
<section id="tskit-terminology-sites-and-mutations-1" class="slide level2 ultitle">
<h2>tskit terminology: sites and mutations</h2>
<div class="columns">
<div class="column" style="width:50%;">
<svg baseprofile="full" height="200" id="tsmut2" version="1.1" width="500" xmlns="http://www.w3.org/2000/svg" xmlns:ev="http://www.w3.org/2001/xml-events" xlink="http://www.w3.org/1999/xlink">
<defs>
<style type="text/css">.background path {fill: #808080; fill-opacity: 0}.background path:nth-child(odd) {fill-opacity: .1}.x-regions rect {fill: yellow; stroke: black; opacity: 0.5}.axes {font-size: 14px}.x-axis .tick .lab {font-weight: bold; dominant-baseline: hanging}.axes, .tree {font-size: 14px; text-anchor: middle}.axes line, .edge {stroke: black; fill: none}.axes .ax-skip {stroke-dasharray: 4}.y-axis .grid {stroke: #FAFAFA}.node > .sym {fill: black; stroke: none}.site > .sym {stroke: black}.mut text {fill: red; font-style: italic}.mut.extra text {fill: hotpink}.mut line {fill: none; stroke: none}.mut .sym {fill: none; stroke: red}.mut.extra .sym {stroke: hotpink}.node .mut .sym {stroke-width: 1.5px}.tree text, .tree-sequence text {dominant-baseline: central}.plotbox .lab.lft {text-anchor: end}.plotbox .lab.rgt {text-anchor: start}.polytomy line {stroke: black; stroke-dasharray: 1px, 1px}.polytomy text {paint-order:stroke;stroke-width:0.3em;stroke:white}#tsmut2 {.node > .lab {font-size: 75%} .x-axis {font-size: 75%} .y-axis {font-size: 75%} .mut .sym {stroke: none} .mut .lab {fill: none} .site  {stroke-width: 1px} .site.s0 .sym {stroke: #D55E00; stroke-width: 3px} }</style>
</defs><g class="tree-sequence"><g class="background"><path d="M56.8,0 l141.067,0 l0,138.2 l-11.1443,25 l0,5 l-129.922,0 l0,-5 l0,-25 l0,-138.2z"></path><path d="M197.867,0 l141.067,0 l0,138.2 l-42.1789,25 l0,5 l-110.032,0 l0,-5 l11.145,-25 l0,-138.2z"></path><path d="M338.933,0 l141.067,0 l0,138.2 l0,25 l0,5 l-183.246,0 l0,-5 l42.179,-25 l0,-138.2z"></path></g><g class="axes"><g class="x-axis"><g class="title" transform="translate(268.4 200)"><text class="lab" text-anchor="middle" transform="translate(0 -11)">Genome position</text></g><line class="ax-line" x1="56.8" x2="480" y1="163.2" y2="163.2"></line><g class="ticks"><g class="tick" transform="translate(56.8 163.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">0</text></g></g><g class="tick" transform="translate(186.722 163.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">307</text></g></g><g class="tick" transform="translate(296.754 163.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">567</text></g></g><g class="tick" transform="translate(480 163.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">1000</text></g></g></g><g class="site s0" transform="translate(78.8064 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m0"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s1" transform="translate(141.44 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m1"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s2" transform="translate(198.572 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m2"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s3" transform="translate(206.613 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m4"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g><g class="mut m3"><polyline class="sym" points="2.5,-10.5 0,-5.5 -2.5,-10.5"></polyline></g></g><g class="site s4" transform="translate(257.397 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m5"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s5" transform="translate(278.134 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m6"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s6" transform="translate(384.357 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m7"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s7" transform="translate(393.667 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m8"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s8" transform="translate(461.802 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m9"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g></g><g class="y-axis"><g class="title" transform="translate(0 65.7)"><text class="lab" text-anchor="middle" transform="translate(11) rotate(-90)">Time ago (generations)</text></g><line class="ax-line" x1="56.8" x2="56.8" y1="121.4" y2="10"></line><g class="ticks"><g class="tick" transform="translate(56.8 121.4)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">0</text></g></g><g class="tick" transform="translate(56.8 100.933)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">3</text></g></g><g class="tick" transform="translate(56.8 85.9974)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">10</text></g></g><g class="tick" transform="translate(56.8 70.7006)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">30</text></g></g><g class="tick" transform="translate(56.8 53.2623)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">100</text></g></g><g class="tick" transform="translate(56.8 37.1402)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">300</text></g></g><g class="tick" transform="translate(56.8 19.3991)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">1000</text></g></g></g></g></g><g class="plotbox trees"><g class="tree t0" transform="translate(56.8 0)"><g class="plotbox"><g class="c2 node n11 p0 root" transform="translate(75.7972 26.8)"><g class="a11 c2 node n7 p0" transform="translate(28.425 39.4313)"><g class="a7 i0 leaf node n1 p0 sample" transform="translate(-8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">1</text></g><g class="a7 i2 leaf node n4 p0 sample" transform="translate(8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">4</text></g><path class="edge" d="M 0 0 V -39.4313 H -28.425"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">7</text></g><g class="a11 c2 node n10 p0" transform="translate(-28.425 8.49131)"><g class="a10 i0 leaf m1 node n0 p0 s1 sample" transform="translate(-18.95 86.1087)"><path class="edge" d="M 0 0 V -86.1087 H 18.95"></path><g class="mut m1 s1" transform="translate(0 -75.8949)"><line x1="0" x2="0" y1="0" y2="75.8949"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab lft" transform="translate(-5 0)">1</text></g><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">0</text></g><g class="a10 c2 m0 node n8 p0 s0" transform="translate(18.95 22.6576)"><g class="a8 i1 leaf node n3 p0 sample" transform="translate(12.6333 63.4511)"><path class="edge" d="M 0 0 V -63.4511 H -12.6333"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">3</text></g><g class="a8 c2 node n6 p0" transform="translate(-12.6333 22.7955)"><g class="a6 i1 leaf node n2 p0 sample" transform="translate(-8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">2</text></g><g class="a6 i2 leaf node n5 p0 sample" transform="translate(8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">5</text></g><path class="edge" d="M 0 0 V -22.7955 H 12.6333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">6</text></g><path class="edge" d="M 0 0 V -22.6576 H -18.95"></path><g class="mut m0 s0" transform="translate(0 -18.0003)"><line x1="0" x2="0" y1="0" y2="18.0003"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">0</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">8</text></g><path class="edge" d="M 0 0 V -8.49131 H 28.425"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">10</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab" transform="translate(0 -11)">11</text></g></g></g><g class="tree t1" transform="translate(197.867 0)"><g class="plotbox"><g class="c2 node n10 p0 root" transform="translate(70.5333 35.2913)"><g class="a10 c2 node n8 p0" transform="translate(29.4778 22.6576)"><g class="a8 i1 leaf m2 m5 node n3 p0 s2 s4 sample" transform="translate(12.6333 63.4511)"><path class="edge" d="M 0 0 V -63.4511 H -12.6333"></path><g class="mut m5 s4" transform="translate(0 -55.7768)"><line x1="0" x2="0" y1="0" y2="55.7768"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">5</text></g><g class="mut m2 s2" transform="translate(0 -51.5519)"><line x1="0" x2="0" y1="0" y2="51.5519"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">2</text></g><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">3</text></g><g class="a8 c2 node n6 p0" transform="translate(-12.6333 22.7955)"><g class="a6 i1 leaf node n2 p0 sample" transform="translate(-8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">2</text></g><g class="a6 i2 leaf node n5 p0 sample" transform="translate(8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">5</text></g><path class="edge" d="M 0 0 V -22.7955 H 12.6333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">6</text></g><path class="edge" d="M 0 0 V -22.6576 H -29.4778"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">8</text></g><g class="a10 c2 m3 node n9 p0 s3" transform="translate(-29.4778 1.98569)"><g class="a9 i0 leaf node n0 p0 sample" transform="translate(-12.6333 84.123)"><path class="edge" d="M 0 0 V -84.123 H 12.6333"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">0</text></g><g class="a9 c2 m4 m6 node n7 p0 s3 s5" transform="translate(12.6333 28.9543)"><g class="a7 i0 leaf node n1 p0 sample" transform="translate(-8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">1</text></g><g class="a7 i2 leaf node n4 p0 sample" transform="translate(8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">4</text></g><path class="edge" d="M 0 0 V -28.9543 H -12.6333"></path><g class="mut m4 s3" transform="translate(0 -7.98068)"><line x1="0" x2="0" y1="0" y2="7.98068"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">4</text></g><g class="mut m6 s5" transform="translate(0 -4.3773)"><line x1="0" x2="0" y1="0" y2="4.3773"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">6</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">7</text></g><path class="edge" d="M 0 0 V -1.98569 H 29.4778"></path><g class="mut m3 s3" transform="translate(0 -1.37181)"><line x1="0" x2="0" y1="0" y2="1.37181"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab lft" transform="translate(-5 0)">3</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">9</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab" transform="translate(0 -11)">10</text></g></g></g><g class="tree t2" transform="translate(338.933 0)"><g class="plotbox"><g class="c2 node n11 p0 root" transform="translate(70.5333 26.8)"><g class="a11 c2 m8 node n8 p0 s7" transform="translate(29.4778 31.1489)"><g class="a8 i1 leaf node n3 p0 sample" transform="translate(12.6333 63.4511)"><path class="edge" d="M 0 0 V -63.4511 H -12.6333"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">3</text></g><g class="a8 c2 node n6 p0" transform="translate(-12.6333 22.7955)"><g class="a6 i1 leaf node n2 p0 sample" transform="translate(-8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">2</text></g><g class="a6 i2 leaf node n5 p0 sample" transform="translate(8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">5</text></g><path class="edge" d="M 0 0 V -22.7955 H 12.6333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">6</text></g><path class="edge" d="M 0 0 V -31.1489 H -29.4778"></path><g class="mut m8 s7" transform="translate(0 -12.4493)"><line x1="0" x2="0" y1="0" y2="12.4493"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">8</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">8</text></g><g class="a11 c2 node n9 p0" transform="translate(-29.4778 10.477)"><g class="a9 i0 leaf m7 m9 node n0 p0 s6 s8 sample" transform="translate(-12.6333 84.123)"><path class="edge" d="M 0 0 V -84.123 H 12.6333"></path><g class="mut m7 s6" transform="translate(0 -82.1448)"><line x1="0" x2="0" y1="0" y2="82.1448"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab lft" transform="translate(-5 0)">7</text></g><g class="mut m9 s8" transform="translate(0 -55.6922)"><line x1="0" x2="0" y1="0" y2="55.6922"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab lft" transform="translate(-5 0)">9</text></g><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">0</text></g><g class="a9 c2 node n7 p0" transform="translate(12.6333 28.9543)"><g class="a7 i0 leaf node n1 p0 sample" transform="translate(-8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">1</text></g><g class="a7 i2 leaf node n4 p0 sample" transform="translate(8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">4</text></g><path class="edge" d="M 0 0 V -28.9543 H -12.6333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">7</text></g><path class="edge" d="M 0 0 V -10.477 H 29.4778"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">9</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab" transform="translate(0 -11)">11</text></g></g></g></g></g>
</svg>
<div>
<p>We can create a <span class="cbptomato heavy">site</span> at a given genomic <span class="cbpgreen heavy">position</span> with a fixed <span class="cbpblue heavy">ancestral state</span>.</p>
<div class="dna smallr">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: right;">id</th>
<th style="text-align: right;">position</th>
<th style="text-align: right;">ancestral_state</th>
<th style="text-align: right;">metadata</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;"><span class="cbpgreen-bg">52</span></td>
<td style="text-align: right;"><span class="cbpblue-bg">C</span></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">A</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">335</td>
<td style="text-align: right;">A</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">354</td>
<td style="text-align: right;">A</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">474</td>
<td style="text-align: right;">G</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">523</td>
<td style="text-align: right;">A</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">774</td>
<td style="text-align: right;">C</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: right;">796</td>
<td style="text-align: right;">C</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">8</td>
<td style="text-align: right;">957</td>
<td style="text-align: right;">A</td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>This is how we can encode genetic variation. Most genomic positions do not vary between genomes: usually we don’t bother tracking these.</p>
</div></div>
</section>
<section id="tskit-terminology-sites-and-mutations-2" class="slide level2 ultitle">
<h2>tskit terminology: sites and mutations</h2>
<div class="columns">
<div class="column" style="width:50%;">
<svg baseprofile="full" height="200" id="tsmut3" version="1.1" width="500" xmlns="http://www.w3.org/2000/svg" xmlns:ev="http://www.w3.org/2001/xml-events" xlink="http://www.w3.org/1999/xlink">
<defs>
<style type="text/css">.background path {fill: #808080; fill-opacity: 0}.background path:nth-child(odd) {fill-opacity: .1}.x-regions rect {fill: yellow; stroke: black; opacity: 0.5}.axes {font-size: 14px}.x-axis .tick .lab {font-weight: bold; dominant-baseline: hanging}.axes, .tree {font-size: 14px; text-anchor: middle}.axes line, .edge {stroke: black; fill: none}.axes .ax-skip {stroke-dasharray: 4}.y-axis .grid {stroke: #FAFAFA}.node > .sym {fill: black; stroke: none}.site > .sym {stroke: black}.mut text {fill: red; font-style: italic}.mut.extra text {fill: hotpink}.mut line {fill: none; stroke: none}.mut .sym {fill: none; stroke: red}.mut.extra .sym {stroke: hotpink}.node .mut .sym {stroke-width: 1.5px}.tree text, .tree-sequence text {dominant-baseline: central}.plotbox .lab.lft {text-anchor: end}.plotbox .lab.rgt {text-anchor: start}.polytomy line {stroke: black; stroke-dasharray: 1px, 1px}.polytomy text {paint-order:stroke;stroke-width:0.3em;stroke:white}#tsmut3 {.node > .lab {font-size: 75%} .x-axis {font-size: 75%} .y-axis {font-size: 75%} .site  {stroke-width: 1px} .site.s0 .sym {stroke: #D55E00; stroke-width: 3px} }</style>
</defs><g class="tree-sequence"><g class="background"><path d="M56.8,0 l141.067,0 l0,138.2 l-11.1443,25 l0,5 l-129.922,0 l0,-5 l0,-25 l0,-138.2z"></path><path d="M197.867,0 l141.067,0 l0,138.2 l-42.1789,25 l0,5 l-110.032,0 l0,-5 l11.145,-25 l0,-138.2z"></path><path d="M338.933,0 l141.067,0 l0,138.2 l0,25 l0,5 l-183.246,0 l0,-5 l42.179,-25 l0,-138.2z"></path></g><g class="axes"><g class="x-axis"><g class="title" transform="translate(268.4 200)"><text class="lab" text-anchor="middle" transform="translate(0 -11)">Genome position</text></g><line class="ax-line" x1="56.8" x2="480" y1="163.2" y2="163.2"></line><g class="ticks"><g class="tick" transform="translate(56.8 163.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">0</text></g></g><g class="tick" transform="translate(186.722 163.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">307</text></g></g><g class="tick" transform="translate(296.754 163.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">567</text></g></g><g class="tick" transform="translate(480 163.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">1000</text></g></g></g><g class="site s0" transform="translate(78.8064 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m0"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s1" transform="translate(141.44 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m1"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s2" transform="translate(198.572 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m2"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s3" transform="translate(206.613 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m4"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g><g class="mut m3"><polyline class="sym" points="2.5,-10.5 0,-5.5 -2.5,-10.5"></polyline></g></g><g class="site s4" transform="translate(257.397 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m5"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s5" transform="translate(278.134 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m6"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s6" transform="translate(384.357 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m7"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s7" transform="translate(393.667 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m8"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g><g class="site s8" transform="translate(461.802 163.2)"><line class="sym" x1="0" x2="0" y1="0" y2="-10"></line><g class="mut m9"><polyline class="sym" points="2.5,-6.5 0,-1.5 -2.5,-6.5"></polyline></g></g></g><g class="y-axis"><g class="title" transform="translate(0 65.7)"><text class="lab" text-anchor="middle" transform="translate(11) rotate(-90)">Time ago (generations)</text></g><line class="ax-line" x1="56.8" x2="56.8" y1="121.4" y2="10"></line><g class="ticks"><g class="tick" transform="translate(56.8 121.4)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">0</text></g></g><g class="tick" transform="translate(56.8 100.933)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">3</text></g></g><g class="tick" transform="translate(56.8 85.9974)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">10</text></g></g><g class="tick" transform="translate(56.8 70.7006)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">30</text></g></g><g class="tick" transform="translate(56.8 53.2623)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">100</text></g></g><g class="tick" transform="translate(56.8 37.1402)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">300</text></g></g><g class="tick" transform="translate(56.8 19.3991)"><line class="grid" x1="0" x2="423.2" y1="0" y2="0"></line><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">1000</text></g></g></g></g></g><g class="plotbox trees"><g class="tree t0" transform="translate(56.8 0)"><g class="plotbox"><g class="c2 node n11 p0 root" transform="translate(75.7972 26.8)"><g class="a11 c2 node n7 p0" transform="translate(28.425 39.4313)"><g class="a7 i0 leaf node n1 p0 sample" transform="translate(-8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">1</text></g><g class="a7 i2 leaf node n4 p0 sample" transform="translate(8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">4</text></g><path class="edge" d="M 0 0 V -39.4313 H -28.425"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">7</text></g><g class="a11 c2 node n10 p0" transform="translate(-28.425 8.49131)"><g class="a10 i0 leaf m1 node n0 p0 s1 sample" transform="translate(-18.95 86.1087)"><path class="edge" d="M 0 0 V -86.1087 H 18.95"></path><g class="mut m1 s1" transform="translate(0 -75.8949)"><line x1="0" x2="0" y1="0" y2="75.8949"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab lft" transform="translate(-5 0)">1</text></g><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">0</text></g><g class="a10 c2 m0 node n8 p0 s0" transform="translate(18.95 22.6576)"><g class="a8 i1 leaf node n3 p0 sample" transform="translate(12.6333 63.4511)"><path class="edge" d="M 0 0 V -63.4511 H -12.6333"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">3</text></g><g class="a8 c2 node n6 p0" transform="translate(-12.6333 22.7955)"><g class="a6 i1 leaf node n2 p0 sample" transform="translate(-8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">2</text></g><g class="a6 i2 leaf node n5 p0 sample" transform="translate(8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">5</text></g><path class="edge" d="M 0 0 V -22.7955 H 12.6333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">6</text></g><path class="edge" d="M 0 0 V -22.6576 H -18.95"></path><g class="mut m0 s0" transform="translate(0 -18.0003)"><line x1="0" x2="0" y1="0" y2="18.0003"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">0</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">8</text></g><path class="edge" d="M 0 0 V -8.49131 H 28.425"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">10</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab" transform="translate(0 -11)">11</text></g></g></g><g class="tree t1" transform="translate(197.867 0)"><g class="plotbox"><g class="c2 node n10 p0 root" transform="translate(70.5333 35.2913)"><g class="a10 c2 node n8 p0" transform="translate(29.4778 22.6576)"><g class="a8 i1 leaf m2 m5 node n3 p0 s2 s4 sample" transform="translate(12.6333 63.4511)"><path class="edge" d="M 0 0 V -63.4511 H -12.6333"></path><g class="mut m5 s4" transform="translate(0 -55.7768)"><line x1="0" x2="0" y1="0" y2="55.7768"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">5</text></g><g class="mut m2 s2" transform="translate(0 -51.5519)"><line x1="0" x2="0" y1="0" y2="51.5519"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">2</text></g><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">3</text></g><g class="a8 c2 node n6 p0" transform="translate(-12.6333 22.7955)"><g class="a6 i1 leaf node n2 p0 sample" transform="translate(-8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">2</text></g><g class="a6 i2 leaf node n5 p0 sample" transform="translate(8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">5</text></g><path class="edge" d="M 0 0 V -22.7955 H 12.6333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">6</text></g><path class="edge" d="M 0 0 V -22.6576 H -29.4778"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">8</text></g><g class="a10 c2 m3 node n9 p0 s3" transform="translate(-29.4778 1.98569)"><g class="a9 i0 leaf node n0 p0 sample" transform="translate(-12.6333 84.123)"><path class="edge" d="M 0 0 V -84.123 H 12.6333"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">0</text></g><g class="a9 c2 m4 m6 node n7 p0 s3 s5" transform="translate(12.6333 28.9543)"><g class="a7 i0 leaf node n1 p0 sample" transform="translate(-8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">1</text></g><g class="a7 i2 leaf node n4 p0 sample" transform="translate(8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">4</text></g><path class="edge" d="M 0 0 V -28.9543 H -12.6333"></path><g class="mut m4 s3" transform="translate(0 -7.98068)"><line x1="0" x2="0" y1="0" y2="7.98068"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">4</text></g><g class="mut m6 s5" transform="translate(0 -4.3773)"><line x1="0" x2="0" y1="0" y2="4.3773"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">6</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">7</text></g><path class="edge" d="M 0 0 V -1.98569 H 29.4778"></path><g class="mut m3 s3" transform="translate(0 -1.37181)"><line x1="0" x2="0" y1="0" y2="1.37181"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab lft" transform="translate(-5 0)">3</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">9</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab" transform="translate(0 -11)">10</text></g></g></g><g class="tree t2" transform="translate(338.933 0)"><g class="plotbox"><g class="c2 node n11 p0 root" transform="translate(70.5333 26.8)"><g class="a11 c2 m8 node n8 p0 s7" transform="translate(29.4778 31.1489)"><g class="a8 i1 leaf node n3 p0 sample" transform="translate(12.6333 63.4511)"><path class="edge" d="M 0 0 V -63.4511 H -12.6333"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">3</text></g><g class="a8 c2 node n6 p0" transform="translate(-12.6333 22.7955)"><g class="a6 i1 leaf node n2 p0 sample" transform="translate(-8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">2</text></g><g class="a6 i2 leaf node n5 p0 sample" transform="translate(8.42222 40.6556)"><path class="edge" d="M 0 0 V -40.6556 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">5</text></g><path class="edge" d="M 0 0 V -22.7955 H 12.6333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">6</text></g><path class="edge" d="M 0 0 V -31.1489 H -29.4778"></path><g class="mut m8 s7" transform="translate(0 -12.4493)"><line x1="0" x2="0" y1="0" y2="12.4493"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab rgt" transform="translate(5 0)">8</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">8</text></g><g class="a11 c2 node n9 p0" transform="translate(-29.4778 10.477)"><g class="a9 i0 leaf m7 m9 node n0 p0 s6 s8 sample" transform="translate(-12.6333 84.123)"><path class="edge" d="M 0 0 V -84.123 H 12.6333"></path><g class="mut m7 s6" transform="translate(0 -82.1448)"><line x1="0" x2="0" y1="0" y2="82.1448"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab lft" transform="translate(-5 0)">7</text></g><g class="mut m9 s8" transform="translate(0 -55.6922)"><line x1="0" x2="0" y1="0" y2="55.6922"></line><path class="sym" d="M -3,-3 l 6,6 M -3,3 l 6,-6"></path><text class="lab lft" transform="translate(-5 0)">9</text></g><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">0</text></g><g class="a9 c2 node n7 p0" transform="translate(12.6333 28.9543)"><g class="a7 i0 leaf node n1 p0 sample" transform="translate(-8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H 8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">1</text></g><g class="a7 i2 leaf node n4 p0 sample" transform="translate(8.42222 55.1687)"><path class="edge" d="M 0 0 V -55.1687 H -8.42222"></path><rect class="sym" height="6" width="6" x="-3" y="-3"></rect><text class="lab" transform="translate(0 11)">4</text></g><path class="edge" d="M 0 0 V -28.9543 H -12.6333"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab rgt" transform="translate(3 -7)">7</text></g><path class="edge" d="M 0 0 V -10.477 H 29.4778"></path><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab lft" transform="translate(-3 -7)">9</text></g><circle class="sym" cx="0" cy="0" r="3"></circle><text class="lab" transform="translate(0 -11)">11</text></g></g></g></g></g>
</svg>
<div>
<p>We can create a <span class="cbptomato heavy">site</span> at a given genomic <span class="cbpgreen heavy">position</span> with a fixed <span class="cbpblue heavy">ancestral state</span>.</p>
<div class="dna smallr">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: right;">id</th>
<th style="text-align: right;">position</th>
<th style="text-align: right;">ancestral_state</th>
<th style="text-align: right;">metadata</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;"><span class="cbpgreen-bg">52</span></td>
<td style="text-align: right;"><span class="cbpblue-bg">C</span></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">A</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">335</td>
<td style="text-align: right;">A</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">354</td>
<td style="text-align: right;">A</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">474</td>
<td style="text-align: right;">G</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">523</td>
<td style="text-align: right;">A</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">774</td>
<td style="text-align: right;">C</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: right;">796</td>
<td style="text-align: right;">C</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">8</td>
<td style="text-align: right;">957</td>
<td style="text-align: right;">A</td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>This is how we can encode genetic variation. Most genomic positions do not vary between genomes: usually we don’t bother tracking these.</p>
<div>
<p>Normally, a site is created in order to place one or <span class="cbporange heavy">more</span> <span class="cbptomato heavy">mutations</span> at that site</p>
<div class="dna smallr">
<table class="caption-top">
<colgroup>
<col style="width: 5%">
<col style="width: 25%">
<col style="width: 7%">
<col style="width: 18%">
<col style="width: 19%">
<col style="width: 10%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">id</th>
<th style="text-align: right;">site</th>
<th style="text-align: right;">node</th>
<th style="text-align: right;">time</th>
<th style="text-align: right;">derived_state</th>
<th style="text-align: right;">parent</th>
<th style="text-align: right;">metadata</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">247.85988972</td>
<td style="text-align: right;">T</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">169.80687857</td>
<td style="text-align: right;">C</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">31.84262397</td>
<td style="text-align: right;">C</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;"><span class="cbporange-bg">3</span></td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">326.26095349</td>
<td style="text-align: right;">C</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;"><span class="cbporange-bg">3</span></td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">71.04212649</td>
<td style="text-align: right;">T</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">42.72352948</td>
<td style="text-align: right;">C</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">6</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">55.44045835</td>
<td style="text-align: right;">T</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">7</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">259.82567754</td>
<td style="text-align: right;">T</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">8</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">169.87040769</td>
<td style="text-align: right;">G</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">42.47396523</td>
<td style="text-align: right;">C</td>
<td style="text-align: right;">-1</td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div></div>
</section>
<section id="bibliography" class="slide level2 unnumbered unlisted smaller ultitle scrollable">
<h2>Bibliography</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-baumdicker_EfficientAncestryMutation_2022" class="csl-entry" role="listitem">
Baumdicker, F., Bisschop, G., Goldstein, D., Gower, G., Ragsdale, A. P., Tsambos, G., Zhu, S., Eldon, B., Ellerman, E. C., Galloway, J. G., Gladstein, A. L., Gorjanc, G., Guo, B., Jeffery, B., Kretzschumar, W. W., Lohse, K., Matschiner, M., Nelson, D., Pope, N. S., … Kelleher, J. (2022). Efficient ancestry and mutation simulation with msprime 1.0. <em>Genetics</em>, <em>220</em>(3), iyab229. <a href="https://doi.org/10.1093/genetics/iyab229">https://doi.org/10.1093/genetics/iyab229</a>
</div>
<div id="ref-hahn_MolecularPopulationGenetics_2019" class="csl-entry" role="listitem">
Hahn, M. (2019). <em>Molecular <span>Population Genetics</span></em> (First). <span>Oxford University Press</span>.
</div>
<div id="ref-hein2005gene" class="csl-entry" role="listitem">
Hein, J., Schierup, M. H., &amp; Wiuf, C. (2005). <em>Gene genealogies, variation and evolution: <span>A</span> primer in coalescent theory</em>. <span>Oxford University Press</span>. <a href="https://books.google.se/books?id=CCmLNAEACAAJ">https://books.google.se/books?id=CCmLNAEACAAJ</a>
</div>
<div id="ref-wakeley_CoalescentTheoryIntroduction_2008" class="csl-entry" role="listitem">
Wakeley, J. (2008). <em>Coalescent <span>Theory</span>: <span>An Introduction</span></em> (1st Edition edition). <span>Roberts and Company Publishers</span>.
</div>
</div>


<div class="reveal-header">
<div class="header-logo-left">
<a href="https://nbisweden.github.io/workshop-pgip-H25"><img data-src="../../site_libs/quarto-contrib/quarto-project/percyfal/nbis-quarto/assets/logo/nbislogo-green-teal.svg" style="height:50px;max-width:none;"></a>
</div>
<div class="header-logo-right">
<img data-src="../../site_libs/quarto-contrib/quarto-project/percyfal/nbis-quarto/assets/logo/SciLifeLab_symbol_green.png" style="height:50px;max-width:none;">
</div>
</div>
</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">
<p>Population Genomics in Practice</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': true,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1280,

        height: 720,

        // Factor of the display size that should remain empty around the content
        margin: 8.0e-2,

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/NBISweden\.github\.io\/workshop-pgip-H25\/");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    <script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
    (function() {
      let previousOnload = window.onload;
      window.onload = () => {
        if (previousOnload) {
          previousOnload();
        }
        lightboxQuarto.on('slide_before_load', (data) => {
          const { slideIndex, slideNode, slideConfig, player, trigger } = data;
          const href = trigger.getAttribute('href');
          if (href !== null) {
            const imgEl = window.document.querySelector(`a[href="${href}"] img`);
            if (imgEl !== null) {
              const srcAttr = imgEl.getAttribute("src");
              if (srcAttr && srcAttr.startsWith("data:")) {
                slideConfig.href = srcAttr;
              }
            }
          } 
        });
      
        lightboxQuarto.on('slide_after_load', (data) => {
          const { slideIndex, slideNode, slideConfig, player, trigger } = data;
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(slideNode);
          }
        });
      
      };
      
    })();
              </script>
    

</body></html>