<!DOCTYPE html>
<html lang="en"><head>
<link href="../../assets/logos/nbislogo-green.svg" rel="icon" type="image/svg+xml">
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-541d1840fe0299ec4c9bf9ceaf6b9fb6.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/quarto-contrib/reveal-logo-1.0.0/reveal-logo.js" defer="true"></script>
<link href="../../site_libs/quarto-contrib/reveal-logo-1.0.0/reveal-logo.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-1.2.0/all.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-1.2.0/latex-fontsize.css" rel="stylesheet">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.33">

  <meta name="author" content="Per Unneberg">
  <title>Population Genomics in Practice 2025 – Alleles and genealogies</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-dd75e976e0414ec343b1912506d158bc.css">
  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Alleles and genealogies</h1>
  <p class="subtitle">More descriptions of genetic data</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Per Unneberg 
</div>
</div>
</div>

</section>

<section id="alleles-as-algebraic-entities" class="slide level2 ultitle">
<h2>Alleles as algebraic entities</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>Recall: <strong>alleles</strong> refer to <em>different variants</em> of a sequence at a locus (genomic position).</p>
<div class="fragment">
<p>Whatever the underlying molecular nature (gene, chromosome, nucleotide, protein), let’s represent a locus by a letter, e.g., <span class="math inline">A</span> (<span class="math inline">B</span> if two loci, and so on)</p>
</div>
<div class="fragment">
<p>If locus has many alleles <span class="math inline">1, 2, ...</span> , could use indexing <span class="math inline">A_1, A_2, ...</span>.</p>
</div>
<div class="fragment">
<p>Will use combination <span class="math inline">A</span>, <span class="math inline">a</span> for <em>bi-allelic</em> loci from now on</p>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<div class="callout callout-important no-icon callout-titled callout-style-simple">
<div class="callout-body">
<div class="callout-title">
<p><strong>Example: gene coding for flower color</strong></p>
</div>
<div class="callout-content">
<div class="columns">
<div class="column" style="width:50%;">
<p><span style="color: #ff2a2a;"><i class="fa-solid fa-circle" aria-label="circle"></i></span> <span class="math inline">A</span> red color</p>
<p><i class="fa-regular fa-circle" aria-label="circle"></i> <span class="math inline">a</span> white color</p>
<div class="fragment">
<p><a href="https://en.wikipedia.org/wiki/Punnett_square">Punnett square</a></p>
<div style="display: grid; grid-template-columns: auto auto auto; grid-row-gap: 0px; grid-column-gap: 0px; text-align: center; align-items: center;">
<div>
<p><i class="fa-solid fa-venus" aria-label="venus"></i> \ <i class="fa-solid fa-mars" aria-label="mars"></i></p>
</div>
<div>
<p>A</p>
</div>
<div>
<p>a</p>
</div>
<div>
<p>A</p>
</div>
<div>
<p><a href="assets/images/flower-red.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img data-src="assets/images/flower-red.svg" width="75"></a></p>
</div>
<div>
<p><a href="assets/images/flower-pink.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img data-src="assets/images/flower-pink.svg" width="75"></a></p>
</div>
<div>
<p>a</p>
</div>
<div>
<p><a href="assets/images/flower-pink.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img data-src="assets/images/flower-pink.svg" width="75"></a></p>
</div>
<div>
<p><a href="assets/images/flower-white.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img data-src="assets/images/flower-white.svg" width="75"></a></p>
</div>
</div>
</div>
</div><div class="column" style="width:5%;">

</div><div class="column fragment" style="width:45%;">
<div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; grid-row-gap: 0px; grid-column-gap: 10px; text-align: center; align-items: center;">
<div>
<p>Genotype</p>
</div>
<div>
<p>aa</p>
</div>
<div>
<p>Aa</p>
</div>
<div>
<p>AA</p>
</div>
<div>
<p>Phenotype</p>
</div>
<div>
<p><a href="assets/images/flower-white.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img data-src="assets/images/flower-white.svg" width="100"></a></p>
</div>
<div>
<p><a href="assets/images/flower-pink.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img data-src="assets/images/flower-pink.svg" width="100"></a></p>
</div>
<div>
<p><a href="assets/images/flower-red.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img data-src="assets/images/flower-red.svg" width="100"></a></p>
</div>
</div>
<p>Heterozygote has intermediate color phenotype (pink).</p>
</div></div>
</div>
</div>
</div>
</div>
</div></div>
<aside class="notes">
<p>Until now the examples have been based on nucleotide sequences. However, much of population genetic theory was developed before the nature of heredity (DNA) was known. In these early days, an allele would refer to variant forms of a gene, observed as differences in phenotypes. Genes, or loci, would be denoted using alphabetic characters, such as <span class="math inline">A</span>, and allelic types could be referenced with indices, e.g., <span class="math inline">A_1, A_2, ..., A_n</span>.</p>
<p>To simplify calculations, we often look at one locus and we assume two alleles, whereby we skip the indices and denote the allelic pairs <span class="math inline">A</span> and <span class="math inline">a</span> (although note that notations differs from author to author; for instance <span class="citation" data-cites="gillespie_PopulationGeneticsConcise_2004">Gillespie (<a href="#/bibliography" role="doc-biblioref" onclick="">2004</a>)</span> uses <span class="math inline">A_1, A_2</span> for bi-allelic loci). For two-locus systems we simply denote the second allele with <span class="math inline">B, b</span>, and so on.</p>
<p>The example shows a hypothetical locus having two alleles <span class="math inline">A</span> and <span class="math inline">a</span> that have phenotypes red and white flower color, and where heterozygotes are colored pink. The <em>Punnett square</em> shows how gamete combinations form genotypes and their corresponding phenotypes.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="alleles-and-frequencies" class="slide level2 ultitle">
<h2>Alleles and frequencies</h2>
<p>We will be interested in looking at the dynamics of alleles, i.e., how their abundances in the population change over time. Therefore we want to measure the <em>frequencies</em> of alleles <span class="math inline">A</span> and <span class="math inline">a</span>.</p>
<div class="columns">
<div class="column" style="width:55%;">
<div class="fragment" data-fragment-index="1">
<div class="callout callout-important no-icon callout-titled callout-style-simple">
<div class="callout-body">
<div class="callout-title">
<p><strong>Example</strong></p>
</div>
<div class="callout-content">
<p>Assume following population (<span class="math inline">n=10</span>, with <span class="math inline">n_{AA}=5</span>, <span class="math inline">n_{Aa}=4</span>, <span class="math inline">n_{aa}=1</span>):</p>
<p><img data-src="assets/images/flower-red.svg" width="50"> <img data-src="assets/images/flower-red.svg" width="50"> <img data-src="assets/images/flower-red.svg" width="50"> <img data-src="assets/images/flower-red.svg" width="50"> <img data-src="assets/images/flower-red.svg" width="50"> <img data-src="assets/images/flower-pink.svg" width="50"> <img data-src="assets/images/flower-pink.svg" width="50"> <img data-src="assets/images/flower-pink.svg" width="50"> <img data-src="assets/images/flower-pink.svg" width="50"> <img data-src="assets/images/flower-white.svg" width="50"></p>
<div class="fragment" data-fragment-index="2">
<p>Let <strong><span class="math inline">p</span></strong> be frequency of <span class="math inline">A</span> alleles, <strong><span class="math inline">q=1-p</span></strong> frequency of <span class="math inline">a</span> alleles; then</p>
<p>5 <span class="math inline">AA</span> individuals, 4 <span class="math inline">Aa</span> individuals <span class="math inline">\Rightarrow p=\frac{5\cdot2 +
4\cdot1}{10\cdot2}=\frac{14}{20}=0.7</span></p>
<p>and <span class="math inline">q=1-p=\frac{6}{20}=0.3</span></p>
</div>
<div class="fragment" data-fragment-index="3">
<p>Inserting frequencies into <strong>Punnett square</strong> gives expected frequency of offspring genotypes.</p>
</div>
</div>
</div>
</div>
</div>
</div><div class="column" style="width:45%;">
<div class="fragment" data-fragment-index="4">
<div style="display: grid; grid-template-columns: auto auto auto; grid-row-gap: 0px; grid-column-gap: 0px; text-align: center; align-items: center; font-size: 0.8em;">
<div>
<p><i class="fa-solid fa-venus" aria-label="venus"></i> \ <i class="fa-solid fa-mars" aria-label="mars"></i></p>
</div>
<div>
<p><span class="math inline">A</span> (<span class="math inline">p=0.7</span>)</p>
</div>
<div>
<p><span class="math inline">a</span> (<span class="math inline">q=0.3</span>)</p>
</div>
<div>
<p><span class="math inline">A</span> (<span class="math inline">p=0.7</span>)</p>
</div>
<div>
<p><a href="assets/images/flower-red.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img data-src="assets/images/flower-red.svg" width="50"></a></p>
<p><span class="math inline">p\cdot p = 0.49</span></p>
</div>
<div>
<p><a href="assets/images/flower-pink.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img data-src="assets/images/flower-pink.svg" width="50"></a></p>
<p><span class="math inline">p\cdot q = 0.21</span></p>
</div>
<div>
<p><span class="math inline">a</span> (<span class="math inline">q=0.3</span>)</p>
</div>
<div>
<p><a href="assets/images/flower-pink.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img data-src="assets/images/flower-pink.svg" width="50"></a></p>
<p><span class="math inline">q\cdot p = 0.21</span></p>
</div>
<div>
<p><a href="assets/images/flower-white.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img data-src="assets/images/flower-white.svg" width="50"></a></p>
<p><span class="math inline">q\cdot q = 0.09</span></p>
</div>
</div>
</div>
<div class="fragment small" data-fragment-index="5">
<p><strong>Expected</strong> allele frequencies after mating: <span class="math inline">p=p^2 + pq=0.7</span>, <span class="math inline">q=1-p=0.3</span></p>
</div>
</div></div>
<aside class="notes">
<p>Given <span class="math inline">n</span> diploid individuals, there are <span class="math inline">2n</span> alleles in the population. The frequency of allele <span class="math inline">A</span> is then the homozygote <span class="math inline">AA</span> times two, plus one times the individuals carrying one <span class="math inline">A</span>.</p>
<p>The Punnett square shows that the expected homozygote frequencies are <span class="math inline">0.49</span> and <span class="math inline">0.09</span> for <span class="math inline">AA</span> and <span class="math inline">aa</span>, and hence, the frequency of <span class="math inline">Aa</span> is <span class="math inline">1 - 0.49 - 0.09 = 0.42 = 0.21 + 0.21 = 2pq</span></p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="in-absence-of-evolutionary-forces-alleles-are-in-equilibrium" class="slide level2 ultitle">
<h2>In absence of evolutionary forces alleles are in equilibrium</h2>
<h4 id="the-hardy-weinberg-equilibrium">The Hardy-Weinberg equilibrium</h4>
<p>For a locus, let <span class="math inline">A</span> and <span class="math inline">a</span> be two different alleles and let <span class="math inline">p</span> be the frequency of the <span class="math inline">A</span> allele and <span class="math inline">q=1-p</span> the frequency of the <span class="math inline">a</span> allele. In the <strong>absence</strong> of <strong>mutation</strong>, <strong>drift</strong>, <strong>migration</strong>, and other evolutionary processes, the equilibrium state is given by the <strong>Hardy-Weinberg equilibrium</strong> (<strong>HWE</strong>).</p>
<div class="{.columns=center}">
<div class="column" style="width:45%;">
<table class="caption-top">
<thead>
<tr class="header">
<th></th>
<th><span class="math inline">A</span> (<span class="math inline">p</span>)</th>
<th><span class="math inline">a</span> (<span class="math inline">q</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">A</span> (<span class="math inline">p</span>)</td>
<td><span class="math inline">p^2</span></td>
<td><span class="math inline">pq</span></td>
</tr>
<tr class="even">
<td><span class="math inline">a</span> (<span class="math inline">q</span>)</td>
<td><span class="math inline">qp</span></td>
<td><span class="math inline">q^2</span></td>
</tr>
</tbody>
</table>
</div><div class="column" style="width:45%;">
<table class="caption-top">
<tbody>
<tr class="odd">
<td>Genotype:</td>
<td><span class="math inline">AA</span></td>
<td><span class="math inline">Aa</span></td>
<td><span class="math inline">aa</span></td>
</tr>
<tr class="even">
<td>Frequency:</td>
<td><span class="math inline">p^2</span></td>
<td><span class="math inline">2pq</span></td>
<td><span class="math inline">q^2</span></td>
</tr>
<tr class="odd">
<td></td>
<td><span class="math inline">f_{AA}</span></td>
<td><span class="math inline">f_{Aa}</span></td>
<td><span class="math inline">f_{aa}</span></td>
</tr>
</tbody>
</table>
</div></div>
<div class="columns">
<div class="column" style="width:50%;">
<h4 id="hwe-assumption">HWE assumption</h4>
<p>Under <strong>HWE assumption</strong>, neither allele nor genotype frequencies change over time.</p>
<p>Importantly, we can calculate allele frequencies from genotype frequencies and vice versa.</p>
</div><div class="column" style="width:50%;">
<p><span class="math display">
p = f_{AA} + \frac{f_{Aa}}{2} = p^2 + pq\\
q = f_{aa} + \frac{f_{Aa}}{2} = q^2 + pq\\
</span></p>
</div></div>
<aside class="notes">
<p>Segue: apart from describing the variation via e.g., diversity measures, we want to model how allele frequencies <em>change</em> in time. As <span class="citation" data-cites="gillespie_PopulationGeneticsConcise_2004">(<a href="#/bibliography" role="doc-biblioref" onclick="">Gillespie, 2004</a>, preface p.&nbsp;xi)</span> points out, “While genotype frequencies are easily measured, their change is not”</p>
<p>IOW: describing variation fine, but where does it come from and how does it change?</p>
<p>If assumptions of HWE hold, we have no change of variation. However, we <strong>want</strong> to look at <strong>change</strong> of variation and disentangle the forces that impose change</p>
<p>HWE assumption gives us a way to calculate allele frequencies from genotype frequencies. How well do these assumptions hold in real data? See next slide.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="natural-populations-do-mate-randomly" class="slide level2 ultitle">
<h2>Natural populations do mate randomly?</h2>
<div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-hwe-1000genomes" class="quarto-float quarto-figure quarto-figure-center" data-fig-align="center">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-hwe-1000genomes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="assets/images/hwe-1000genomes.webp" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Figure&nbsp;1: Hardy-Weinberg proportions in 10,000 SNPs on chromosome 22 from three populations based on 1000 genomes data. For each SNP, genotypes are given as counts (minor/heterozygote/major), converted to frequencies and plotted on the y-axis. Allele frequencies are obtained from genotype frequencies and plotted on the x-axis. Most observations follow HWE proportions. Deviations from HWE can indicate sample QC issues, or that there is population structure. Illustration inspired by @cooplab_PopulationGeneticsCourse_2011. "><img data-src="assets/images/hwe-1000genomes.webp" class="quarto-figure quarto-figure-center" style="width:80.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hwe-1000genomes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Hardy-Weinberg proportions in 10,000 SNPs on chromosome 22 from three populations based on 1000 genomes data. For each SNP, genotypes are given as counts (minor/heterozygote/major), converted to frequencies and plotted on the y-axis. Allele frequencies are obtained from genotype frequencies and plotted on the x-axis. Most observations follow HWE proportions. Deviations from HWE can indicate sample QC issues, or that there is population structure. Illustration inspired by <span class="citation" data-cites="cooplab_PopulationGeneticsCourse_2011">cooplab (<a href="#/bibliography" role="doc-biblioref" onclick="">2011</a>)</span>. <a href="../../recipes/slides/index.html#sec-recipe-slides-hwe"><i class="fa-solid fa-rectangle-list" aria-label="rectangle-list"></i></a>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<aside class="notes">
<p>So how do the HWE assumptions hold up in real data? The figure shows three human populations from the 1000 genomes data, for which 10,000 SNPs have been selected. For each SNP, we know the genotype frequencies <span class="math inline">AA</span>, <span class="math inline">Aa</span>, <span class="math inline">aa</span> and can therefore calculate the allele frequencies for <span class="math inline">A</span> and <span class="math inline">a</span> using the equations on the preceding slide (e.g., <span class="math inline">p=p_{AA}+p_{Aa}/2</span>).</p>
<p>Note that 1000 genomes data have sorted genotype frequencies, so to produce nice symmetrical plots, half the genotype frequencies have been reversed (minor/het/major -&gt; major/het/minor).</p>
<!-- markdownlint-disable MD013 -->
<p>See <a href="https://stackoverflow.com/questions/26587940/ggplot2-different-legend-symbols-for-points-and-lines" class="uri">https://stackoverflow.com/questions/26587940/ggplot2-different-legend-symbols-for-points-and-lines</a> for legend customization.</p>
<!-- markdownlint-enable MD013 -->
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="the-wahlund-effect-and-population-substructure" class="slide level2 ultitle">
<h2>The Wahlund effect and population substructure</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>Population P1</p>
<div>
<p><img data-src="assets/images/flower-red.svg" width="50"> <img data-src="assets/images/flower-red.svg" width="50"> <img data-src="assets/images/flower-red.svg" width="50"> <img data-src="assets/images/flower-red.svg" width="50"> <img data-src="assets/images/flower-red.svg" width="50"></p>
</div>
<p><span class="math inline">p_A = 1 \Rightarrow p_A^2 = 1</span>, <span class="math inline">p_a^2=2p_Ap_a=0</span></p>
</div><div class="column" style="width:50%;">
<p>Population P1</p>
<div class="center">
<p><img data-src="assets/images/flower-white.svg" width="50"> <img data-src="assets/images/flower-white.svg" width="50"> <img data-src="assets/images/flower-white.svg" width="50"> <img data-src="assets/images/flower-white.svg" width="50"> <img data-src="assets/images/flower-white.svg" width="50"></p>
</div>
<p><span class="math inline">p_a = 1 \Rightarrow p_a^2 = 1</span>, <span class="math inline">p_A^2=2p_Ap_a=0</span></p>
</div><div class="fragment">
<p>Both subpopulations are in HWE!</p>
</div>
</div>
<div class="fragment">
<p>Population P1+P2:</p>
<p><span class="math inline">p_A=p_a=0.5</span> so we would expect 50% heterozygotes - but there are none!</p>
</div>
<div class="fragment">
<p>This is known as the <strong>Wahlund effect</strong> where the loss of heterozygosity is due to <em>population substructure</em>.</p>
</div>
</section>
<section id="summarising-allele-frequencies" class="slide level2 smaller ultitle">
<h2>Summarising allele frequencies</h2>
<p>Going back to the DNA example let’s tabulate the <strong>minor allele frequencies</strong> (MAFs):</p>
<!-- markdownlint-disable MD013 -->
<div class="dna">
<table class="caption-top" style="width:85%;">
<colgroup>
<col style="width: 10%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">1</th>
<th style="text-align: center;">2</th>
<th style="text-align: center;">3</th>
<th style="text-align: center;">4</th>
<th style="text-align: center;">5</th>
<th style="text-align: center;">6</th>
<th style="text-align: center;">7</th>
<th style="text-align: center;">8</th>
<th style="text-align: center;">9</th>
<th style="text-align: center;">10</th>
<th style="text-align: center;">11</th>
<th style="text-align: center;">12</th>
<th style="text-align: center;">13</th>
<th style="text-align: center;">14</th>
<th style="text-align: center;">15</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: center;">T</td>
<td style="text-align: center;">T</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">T</td>
<td style="text-align: center;"><strong>C</strong></td>
<td style="text-align: center;">C</td>
<td style="text-align: center;">G</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">T</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;">G</td>
<td style="text-align: center;">T</td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: center;">T</td>
<td style="text-align: center;">T</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;"><strong>G</strong></td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">T</td>
<td style="text-align: center;">G</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;">G</td>
<td style="text-align: center;"><strong>C</strong></td>
<td style="text-align: center;">T</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;">G</td>
<td style="text-align: center;">T</td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: center;">T</td>
<td style="text-align: center;"><strong>C</strong></td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">T</td>
<td style="text-align: center;">G</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;">G</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">T</td>
<td style="text-align: center;"><strong>G</strong></td>
<td style="text-align: center;">G</td>
<td style="text-align: center;"><strong>A</strong></td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: center;">T</td>
<td style="text-align: center;">T</td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;"><strong>G</strong></td>
<td style="text-align: center;">A</td>
<td style="text-align: center;">T</td>
<td style="text-align: center;">G</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;">G</td>
<td style="text-align: center;"><strong>C</strong></td>
<td style="text-align: center;">T</td>
<td style="text-align: center;">C</td>
<td style="text-align: center;">G</td>
<td style="text-align: center;">T</td>
</tr>
<tr class="odd">
<td style="text-align: center;">MAF</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
</div>
<!-- markdownlint-enable MD013 -->
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment">
<h4 id="site-frequency-spectrum-sfs">Site-frequency spectrum (SFS)</h4>
<p>We can count all the different frequency classes <span class="math inline">{x_0, x_1, x_2,
...}</span> and make a frequency table or plot it:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><a href="alleles_files/figure-revealjs/site-frequency-spectrum-graph-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img data-src="alleles_files/figure-revealjs/site-frequency-spectrum-graph-1.svg" style="width:50.0%"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<h4 id="genealogies-and-mutations">Genealogies and mutations</h4>
<p>Assuming we know how the samples are related and we know the <strong>ancestral</strong> sequence, we can plot the mutations (circles) on a genealogy.</p>
<p>Note the correspondence between frequency classes in the SFS and number of samples below a mutation.</p>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><a href="alleles_files/figure-revealjs/coalescent-tree-dna-variation-1.svg" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img data-src="alleles_files/figure-revealjs/coalescent-tree-dna-variation-1.svg" class="quarto-figure quarto-figure-center" style="width:70.0%"></a></p>
</figure>
</div>
</div>
</div>
</div></div>
</div>
</div></div>
</section>
<section id="the-obsession-of-population-genetics" class="slide level2 ultitle">
<h2>The obsession of population genetics</h2>
<p>Population genetics is about <span class="citation" data-cites="gillespie_PopulationGeneticsConcise_2004">(<a href="#/bibliography" role="doc-biblioref" onclick="">Gillespie, 2004</a>)</span></p>
<ol type="1">
<li>describing the genetic structure of populations</li>
<li>constructing theories on the forces that influence genetic variation</li>
</ol>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<p>Questions to ponder:</p>
<ul>
<li>why does variation look the way it does?</li>
<li>how is variation maintained?</li>
<li>how does variation change over time (<span class="math inline">\Delta p</span>)?</li>
<li>what forces shape the genetic structure of <em>populations</em>?</li>
</ul>
</div><div class="column fragment" style="width:50%;">
<div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr 1fr 1fr; grid-row-gap: 0px; grid-column-gap: 0px; align-items: center;">
<div>
<p><img data-src="assets/images/flower-red.svg" width="27"> <img data-src="assets/images/flower-white.svg" width="27"> <img data-src="assets/images/flower-white.svg" width="27"> <img data-src="assets/images/flower-white.svg" width="27"> <img data-src="assets/images/flower-white.svg" width="27"> <img data-src="assets/images/flower-white.svg" width="27"> <img data-src="assets/images/flower-white.svg" width="27"> <img data-src="assets/images/flower-white.svg" width="27"> <img data-src="assets/images/flower-white.svg" width="27"> <img data-src="assets/images/flower-white.svg" width="27"></p>
<p><span class="math display">p=0.1</span></p>
</div>
<div>
<p><span class="math display">\large\rightarrow</span></p>
</div>
<div>
<p><img data-src="assets/images/flower-red.svg" width="27"> <img data-src="assets/images/flower-red.svg" width="27"> <img data-src="assets/images/flower-red.svg" width="27"> <img data-src="assets/images/flower-red.svg" width="27"> <img data-src="assets/images/flower-red.svg" width="27"> <img data-src="assets/images/flower-white.svg" width="27"> <img data-src="assets/images/flower-white.svg" width="27"> <img data-src="assets/images/flower-white.svg" width="27"> <img data-src="assets/images/flower-white.svg" width="27"> <img data-src="assets/images/flower-white.svg" width="27"></p>
<p><span class="math display">p=0.5</span></p>
</div>
<div>
<p><span class="math display">\large\rightarrow</span></p>
</div>
<div>
<p><img data-src="assets/images/flower-red.svg" width="27"> <img data-src="assets/images/flower-red.svg" width="27"> <img data-src="assets/images/flower-red.svg" width="27"> <img data-src="assets/images/flower-red.svg" width="27"> <img data-src="assets/images/flower-red.svg" width="27"> <img data-src="assets/images/flower-red.svg" width="27"> <img data-src="assets/images/flower-red.svg" width="27"> <img data-src="assets/images/flower-red.svg" width="27"> <img data-src="assets/images/flower-red.svg" width="27"> <img data-src="assets/images/flower-white.svg" width="27"></p>
<p><span class="math display">p=0.9</span></p>
</div>
</div>
</div></div>
</div>
<aside class="notes">
<p>From HWE: we want to look a the creation, maintenance and loss of variation and what forces affect it</p>
<p>Goal: describe theory behind evolving populations. This has been an obsession for a long time, even before DNA was known. We need to get back to basics.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="bibliography" class="slide level2 unnumbered unlisted smaller ultitle scrollable">
<h2>Bibliography</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-cooplab_PopulationGeneticsCourse_2011" class="csl-entry" role="listitem">
cooplab. (2011). Population genetics course resources: <span>Hardy-Weinberg Eq</span>. In <em>gcbias</em>. <a href="https://gcbias.org/2011/10/13/population-genetics-course-resources-hardy-weinberg-eq/">https://gcbias.org/2011/10/13/population-genetics-course-resources-hardy-weinberg-eq/</a>
</div>
<div id="ref-gillespie_PopulationGeneticsConcise_2004" class="csl-entry" role="listitem">
Gillespie, J. H. (2004). <em>Population <span>Genetics</span>: <span>A Concise Guide</span></em> (2nd edition). <span>Johns Hopkins University Press</span>.
</div>
</div>


<div class="reveal-header">
<div class="header-logo-left">
<a href="https://nbisweden.github.io/workshop-pgip-H25"><img data-src="../../site_libs/quarto-contrib/quarto-project/percyfal/nbis-quarto/assets/logo/nbislogo-green-teal.svg" style="height:50px;max-width:none;"></a>
</div>
<div class="header-logo-right">
<img data-src="../../site_libs/quarto-contrib/quarto-project/percyfal/nbis-quarto/assets/logo/SciLifeLab_symbol_green.png" style="height:50px;max-width:none;">
</div>
</div>
</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">
<p>Foundations - alleles and genealogies</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1280,

        height: 720,

        // Factor of the display size that should remain empty around the content
        margin: 8.0e-2,

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/NBISweden\.github\.io\/workshop-pgip-H25\/");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    <script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
    (function() {
      let previousOnload = window.onload;
      window.onload = () => {
        if (previousOnload) {
          previousOnload();
        }
        lightboxQuarto.on('slide_before_load', (data) => {
          const { slideIndex, slideNode, slideConfig, player, trigger } = data;
          const href = trigger.getAttribute('href');
          if (href !== null) {
            const imgEl = window.document.querySelector(`a[href="${href}"] img`);
            if (imgEl !== null) {
              const srcAttr = imgEl.getAttribute("src");
              if (srcAttr && srcAttr.startsWith("data:")) {
                slideConfig.href = srcAttr;
              }
            }
          } 
        });
      
        lightboxQuarto.on('slide_after_load', (data) => {
          const { slideIndex, slideNode, slideConfig, player, trigger } = data;
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(slideNode);
          }
        });
      
      };
      
    })();
              </script>
    

</body></html>