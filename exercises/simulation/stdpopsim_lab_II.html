<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Per Unneberg">
<meta name="description" content="Simulations of more complex scenarios with stdpopsim">

<title>Simulating selection with stdpopsim – Population Genomics in Practice 2025</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../assets/logos/nbislogo-green.svg" rel="icon" type="image/svg+xml">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-e0fa960b084fe2c1b9e2a0a843ce9846.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-c99def4582b0a787bea15946fe8e6d6f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../assets/logos/nbislogo-green.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Population Genomics in Practice 2025</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../../slides/index.html" aria-current="page"> 
<span class="menu-text">Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../exercises/index.html"> 
<span class="menu-text">Exercises</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../recipes/index.html"> 
<span class="menu-text">Code recipes</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../exercises/index.html">Exercises</a></li><li class="breadcrumb-item"><a href="../../exercises/simulation/index.html">Simulation</a></li><li class="breadcrumb-item"><a href="../../exercises/simulation/stdpopsim_lab_II.html">Simulating selection with stdpopsim</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Slides</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Listing</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Introduction</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/pgip/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Population genomics in practice</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Population genetics foundations</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/foundations/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Listing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/foundations/data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data and definitions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/foundations/alleles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Alleles and genealogies</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/foundations/linkage.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linkage disequilibrium</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/foundations/wrightfisher.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Wright-Fisher model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/foundations/diversity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Genetic diversity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/foundations/selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Selection</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Variant calling</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/variant_calling/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Listing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/variant_calling/dna_sequencing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DNA sequencing data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/variant_calling/read_mapping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Read mapping</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/variant_calling/variant_calling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variant calling and genotyping</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/variant_calling/reproducibility.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variant calling workflows</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Variant filtering</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/variant_filtering/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Listing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/variant_filtering/variant_filtering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variant filtering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/variant_filtering/depth_filtering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Depth filtering</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">Genetic diversity</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/genetic_diversity/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Listing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/genetic_diversity/diversity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Genetic diversity</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">Population structure</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/population_structure/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Listing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/population_structure/pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Principal component analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/population_structure/admixture.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Admixture</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">Demography</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/demography/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Listing</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false">
 <span class="menu-text">Selection</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/selection/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Listing</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false">
 <span class="menu-text">Simulation</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/simulation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Listing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/simulation/stdpopsim.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Brief introduction to simulation packages and stdpopsim</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/simulation/coalescent.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Primer on the coalescent and forward simulation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/simulation/argintro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ancestral recombination graph inference</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true">
 <span class="menu-text">Exercises</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Listing</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false">
 <span class="menu-text">Data</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/compute_environment/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Compute environment</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/datasets/monkeyflowers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Monkeyflowers dataset</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false">
 <span class="menu-text">Variant calling</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/variant_calling/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Listing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/variant_calling/introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variant calling introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/variant_calling/data_qc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data quality control</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/variant_calling/read_mapping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Read mapping and duplicate removal</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/variant_calling/variant_calling_workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variant calling workflow</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="false">
 <span class="menu-text">Variant filtering</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/variant_filtering/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Listing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/variant_filtering/basic_filtering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basic variant filtering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/variant_filtering/depth_filtering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Depth filtering on invariant sites</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="false">
 <span class="menu-text">Recombination and linkage</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-15" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/recombination_linkage/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Listing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/recombination_linkage/ld_decay.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linkage disequilibrium decay</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" role="navigation" aria-expanded="false">
 <span class="menu-text">Genetic diversity</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-16" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/genetic_diversity/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Listing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/genetic_diversity/landscape.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Genetic diversity landscapes</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" role="navigation" aria-expanded="false">
 <span class="menu-text">Population structure</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-17" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/population_structure/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Listing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/population_structure/pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Principal component analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/population_structure/admixture.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Admixture</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/population_structure/dstats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">D-statistics</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-18" role="navigation" aria-expanded="true">
 <span class="menu-text">Simulation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-18" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-18" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/simulation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Listing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/simulation/howto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HOWTO</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/simulation/stdpopsim_lab.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to stdpopsim</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/simulation/stdpopsim_lab_II.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Simulating selection with stdpopsim</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../exercises/simulation/simulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to simulation with msprime</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-19" role="navigation" aria-expanded="true">
 <span class="menu-text">Code recipes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-19" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-19" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../recipes/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Code recipes</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#using-this-workbook" id="toc-using-this-workbook" class="nav-link" data-scroll-target="#using-this-workbook">Using this workbook</a></li>
  <li><a href="#simulating-selection-with-stdpopsim" id="toc-simulating-selection-with-stdpopsim" class="nav-link" data-scroll-target="#simulating-selection-with-stdpopsim">Simulating selection with stdpopsim</a></li>
  <li><a href="#setting-up-a-pan-troglodytes-model" id="toc-setting-up-a-pan-troglodytes-model" class="nav-link" data-scroll-target="#setting-up-a-pan-troglodytes-model">Setting up a <em>Pan troglodytes</em> model</a></li>
  <li><a href="#make-independent-populations-some-with-selective-sweeps" id="toc-make-independent-populations-some-with-selective-sweeps" class="nav-link" data-scroll-target="#make-independent-populations-some-with-selective-sweeps">Make independent populations, some with selective sweeps</a></li>
  <li><a href="#making-sense-of-the-simulations" id="toc-making-sense-of-the-simulations" class="nav-link" data-scroll-target="#making-sense-of-the-simulations">Making sense of the simulations</a></li>
  <li><a href="#trees-at-sweep-locations" id="toc-trees-at-sweep-locations" class="nav-link" data-scroll-target="#trees-at-sweep-locations">Trees at sweep locations</a></li>
  <li><a href="#haplotype-gnns" id="toc-haplotype-gnns" class="nav-link" data-scroll-target="#haplotype-gnns">Haplotype GNNs</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../exercises/index.html">Exercises</a></li><li class="breadcrumb-item"><a href="../../exercises/simulation/index.html">Simulation</a></li><li class="breadcrumb-item"><a href="../../exercises/simulation/stdpopsim_lab_II.html">Simulating selection with stdpopsim</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Simulating selection with stdpopsim</h1>
</div>

<div>
  <div class="description">
    Simulations of more complex scenarios with stdpopsim
  </div>
</div>


<div class="quarto-title-meta column-body">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Per Unneberg </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">18-Sep-2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<p>To access material for this workbook please execute the notebook cell immediately below (e.g.&nbsp;use the shortcut <code>+</code>). The cell should print out “Your notebook is ready to go!”</p>
<div id="980ab93f" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tskit</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> workshop</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>workbook <span class="op">=</span> workshop.StdpopsimII()</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>display(workbook.setup)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script src="https://d3js.org/d3.v7.min.js"></script><style>dl.exercise {
    border: #a7c947 1px solid;
    margin-top: 1em;
}
.exercise dt {
    color: #e9f2d1; background-color: #a7c947;
    padding: 6px; display: block;
}
.exercise dt::before {
    content: '🧐 ';
}
.exercise dd {
    padding: 6px;
}
</style>
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td style="text-align: left;">✅ Your notebook is ready to go!</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="using-this-workbook" class="level2">
<h2 class="anchored" data-anchor-id="using-this-workbook">Using this workbook</h2>
<p>This workbook is intended to be used by executing each cell as you go along. Code cells (like those above) can be modified and re-executed to perform different behaviour or additional analysis. You can use this to complete various programming exercises, some of which have associated questions to test your understanding. Exercises are marked like this:</p>
<dl class="exercise">
<dt>
Exercise XXX
</dt>
<dd>
Here is an exercise: normally there will be a code cell below this box for you to work in
</dd>
</dl>
</section>
<section id="simulating-selection-with-stdpopsim" class="level2">
<h2 class="anchored" data-anchor-id="simulating-selection-with-stdpopsim">Simulating selection with stdpopsim</h2>
<p>In the previous workbook we were introduced to stdpopsim, a package for making population genetic simulations. Here, we will build upon what we learned and make some more advanced models. We will look at a selective sweep model, and also simulate data from a nonmodel organism. We will make use of a sweep model that actually can be simulated with msprime (namely <a href="https://tskit.dev/msprime/docs/stable/api.html#msprime.SweepGenicSelection">msprime.SweepGenicSelection</a>), thus avoiding the need to rely on SLiM in this particular instance.</p>
</section>
<section id="setting-up-a-pan-troglodytes-model" class="level2">
<h2 class="anchored" data-anchor-id="setting-up-a-pan-troglodytes-model">Setting up a <em>Pan troglodytes</em> model</h2>
<p>Import the relevant libraries</p>
<div id="ef584897" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> msprime</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> stdpopsim</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tskit</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>and get a chimpanzee demographic model which includes a ghost population. We plot the demographic history with demesdraw as before to get an overview of the model.</p>
<div id="5ff43177" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>species <span class="op">=</span> stdpopsim.get_species(<span class="st">"PanTro"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> species.get_demographic_model(<span class="st">"BonoboGhost_4K19"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>msprime_demography <span class="op">=</span> model.model</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>contig <span class="op">=</span> species.get_contig(<span class="st">"chr3"</span>, mutation_rate<span class="op">=</span>model.mutation_rate)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>sample_sizes <span class="op">=</span> {<span class="st">"bonobo"</span>: <span class="dv">20</span>, <span class="st">"central"</span>: <span class="dv">20</span>, <span class="st">"western"</span>: <span class="dv">20</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="22825219" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> demesdraw</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>demesgraph <span class="op">=</span> msprime_demography.to_demes()</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>demesdraw.tubes(demesgraph)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="stdpopsim_lab_II_files/figure-html/cell-5-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="stdpopsim_lab_II_files/figure-html/cell-5-output-1.png" width="844" height="470" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>We specify a chromosome length and a time <span class="math inline">\(G\)</span> ago in generations, from which point we assume populations are isolated and of constant size. Furthermore, we define two loci that are subject to selective sweeps.</p>
<div id="4eeac9af" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> <span class="fl">10e6</span>  <span class="co"># Simulate 10 Mb</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> <span class="dv">4000</span>  <span class="co"># A time ago in generations: we assume populations from time</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>          <span class="co"># 0..G are isolated and of constant size</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>sweep_params <span class="op">=</span> {</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"bonobo"</span>: {<span class="st">"position"</span>: L<span class="op">//</span><span class="dv">3</span>, <span class="st">"s"</span>: <span class="fl">0.05</span>},</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"western"</span>: {<span class="st">"position"</span>: (<span class="dv">2</span> <span class="op">*</span> L)<span class="op">//</span><span class="dv">3</span>, <span class="st">"s"</span>: <span class="fl">0.1</span>},</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here we define a chromosome of length 10Mb with different sweep locations and selection parameters for populations <code>bonobo</code> and <code>western</code>.</p>
</section>
<section id="make-independent-populations-some-with-selective-sweeps" class="level2">
<h2 class="anchored" data-anchor-id="make-independent-populations-some-with-selective-sweeps">Make independent populations, some with selective sweeps</h2>
<p>Now that we have defined sweep parameters for <code>bonobo</code> and <code>western</code> populations we simulate sampled individuals from the populations with defined sample sizes in <code>sample_sizes</code>. Briefly, we loop through the populations defined by the model and initialize a population if it is defined in <code>sample_sizes</code>. Moreover, we specify different simulation functions (<code>SweepGenicSelection</code> vs <code>StandardCoalescent</code>) depending on settings in <code>sweep_params</code>. Finally, we add independent simulations to <code>independent_pop_ts</code> and combine the results tree sequence objects to <code>combined_ts</code>. Note that we here only simulate the ancestries (trees); mutations will be added on top later on.</p>
<div id="06bae0e9" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make independent populations, some with selective sweeps</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>independent_pop_ts <span class="op">=</span> []</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, pop <span class="kw">in</span> model.model.items():</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> name <span class="kw">in</span> sample_sizes:</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>        Ne <span class="op">=</span> pop.initial_size</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>        demog <span class="op">=</span> msprime.Demography()</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>        demog.add_population(name<span class="op">=</span>name, initial_size<span class="op">=</span>Ne)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> name <span class="kw">in</span> sweep_params:</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>            p <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">2</span> <span class="op">*</span> Ne)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>            freqs <span class="op">=</span> {<span class="st">"start_frequency"</span>: p, <span class="st">"end_frequency"</span>: <span class="dv">1</span> <span class="op">-</span> p, <span class="st">"dt"</span>: <span class="dv">1</span> <span class="op">/</span> (<span class="dv">40</span> <span class="op">*</span> Ne)}</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>            sweep_model <span class="op">=</span> msprime.SweepGenicSelection(<span class="op">**</span>freqs, <span class="op">**</span>sweep_params[name])</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>            models <span class="op">=</span> (sweep_model, msprime.StandardCoalescent())</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"Adding </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss"> population to demographic model, "</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>                  <span class="ss">f"sweep at </span><span class="sc">{</span><span class="bu">int</span>(sweep_params[name][<span class="st">'position'</span>])<span class="sc">}</span><span class="ss">bp, "</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>                  <span class="ss">f"selection coefficient s=</span><span class="sc">{</span>sweep_params[name][<span class="st">'s'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>            models <span class="op">=</span> msprime.StandardCoalescent()</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"Adding </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss"> population to demographic model, neutral"</span>)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>        independent_pop_ts.append(msprime.sim_ancestry(</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>            sample_sizes[name],</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>            model<span class="op">=</span>models,</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>            demography<span class="op">=</span>demog,</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>            recombination_rate<span class="op">=</span>contig.recombination_map.<span class="bu">slice</span>(right<span class="op">=</span>L, trim<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>            sequence_length<span class="op">=</span>L,</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>            end_time<span class="op">=</span>G,</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>            random_seed<span class="op">=</span><span class="dv">123</span>,</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>        ))</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>combined_ts <span class="op">=</span> independent_pop_ts[<span class="dv">0</span>]</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ts <span class="kw">in</span> independent_pop_ts[<span class="dv">1</span>:]:</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>    combined_ts <span class="op">=</span> combined_ts.union(ts, node_mapping<span class="op">=</span>np.full(ts.num_nodes, tskit.NULL))</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Now recapitate: initial_state uses the population names in the</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a><span class="co"># combined_ts to figure out which are which</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>ts <span class="op">=</span> msprime.sim_mutations(</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>    msprime.sim_ancestry(initial_state<span class="op">=</span>combined_ts,</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>                         demography<span class="op">=</span>msprime_demography, random_seed<span class="op">=</span><span class="dv">123</span>).simplify(),</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>    rate<span class="op">=</span>model.mutation_rate,</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>    random_seed<span class="op">=</span><span class="dv">123</span>,</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Simulated under a complex demography: </span><span class="sc">{</span>ts<span class="sc">.</span>num_sites<span class="sc">}</span><span class="ss"> "</span>,</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>      <span class="ss">f"sites for </span><span class="sc">{</span>ts<span class="sc">.</span>num_samples<span class="sc">}</span><span class="ss"> genomes"</span>)</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>treesfile <span class="op">=</span> <span class="st">"data/chimp_selection.trees"</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="kw">not</span> os.path.exists(treesfile):</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"dumping </span><span class="sc">{</span>treesfile<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>    ts.dump(treesfile)  <span class="co"># or could save a smaller file using tszip.compress(ts, "chimp_selection.tsz")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Adding western population to demographic model, sweep at 6666666bp, selection coefficient s=0.1
Adding central population to demographic model, neutral
Adding bonobo population to demographic model, sweep at 3333333bp, selection coefficient s=0.05
Simulated under a complex demography: 134640  sites for 120 genomes
dumping data/chimp_selection.trees</code></pre>
</div>
</div>
<p>As noted, the assumption above was that populations were isolated. We used the parameter <span class="math inline">\(G\)</span> to <a href="https://tskit.dev/msprime/docs/stable/ancestry.html#stopping-simulations-early">stop the simulation early</a>; this means we simulate backwards <span class="math inline">\(G\)</span> generations, but the populations do not coalesce. We end by adding history backwards in time to the three populations until coalescence with the function <code>msprime.sim_ancestry</code> using the stdpopsim model specifications in <code>model</code>. (which, as you will see if you print the <code>msprime_demography</code> object, has mass migration events defined 4003 and 6202 generations ago). Finally, we add mutations with <code>msprime.sim_mutations</code>.</p>
<dl class="exercise">
<dt>
Exercise 1.
</dt>
<dd>
Display the <code>msprime_demography</code> object.
</dd>
</dl>
<div id="40c82742" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use this cell to display the msprime_demography object</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="4ef59233" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>workbook.question(<span class="st">"msprime_demography"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="qzEAkXHYYXSu" data-shufflequestions="False" data-shuffleanswers="True" data-preserveresponses="false" data-numquestions="1000000" data-maxwidth="600" style="border-radius: 10px; text-align: left"><style>
#qzEAkXHYYXSu {
   --jq-multiple-choice-bg: #a7c947;
   --jq-mc-button-bg: #c0d6d8;
   --jq-mc-button-border: #82aeb2;
   --jq-mc-button-inset-shadow: #43858b;
   --jq-many-choice-bg: #a7c947;
   --jq-numeric-bg: #a7c947;
   --jq-numeric-input-bg: #bdd775;
   --jq-numeric-input-label: #a7c947;
   --jq-numeric-input-shadow: #bdd775;
   --jq-string-bg: #4c1a57;
   --jq-incorrect-color: #491f53;
   --jq-correct-color: #82aeb2;
   --jq-text-color: #e9f2d1;
}

.Quiz {
    max-width: 600px;
    margin-top: 15px;
    margin-left: auto;
    margin-right: auto;
/*    margin-bottom: 15px;*/
/*    padding-bottom: 4px;*/
    padding-top: 4px;
    line-height: 1.1;
    font-size: 16pt;
    border-radius: inherit;
}

.QuizCode {
    font-size: 14pt;
    margin-top: 10px;
    margin-left: 20px;
    margin-right: 20px;
}

.QuizCode>pre {
    padding: 4px;
}

.Quiz code {
    background-color: lightgray;
    color: black;
}

.Quiz .QuizCode code {
    background-color: inherit;
    color: inherit;
}


.Quiz .MCButton code {
    background-color: inherit;
    color: inherit;
}

.MCButton .QuizCode {
    text-align: left;
}




.Answer {
    border-radius: inherit;
    display: grid;
    grid-gap: 10px;
    grid-template-columns: 1fr 1fr;
    margin: 10px 0;
}

@media only screen and (max-width:480px) {
    .Answer {
        grid-template-columns: 1fr;
    }

}

.Feedback {
    font-size: 16pt;
    text-align: center;
/*    min-height: 2em;*/
}

.Input {
    align: left;
    font-size: 20pt;
}

.Input-text {
    display: block;
    margin: 10px;
    color: inherit;
    width: unset;
    min-width: 140px;
    max-width: 93%;
    field-sizing: content;
    background-color: var(--jq-numeric-input-bg);
    color: var(--jq-text-color);
    padding: 5px;
    padding-left: 10px;
    font-family: inherit;
    font-size: 20px;
    font-weight: inherit;
    line-height: 20pt;
    border: none;
    border-radius: 0.2rem;
    transition: box-shadow 0.1s);
}

.Input-text:focus {
    /*outline: none;*/
    background-color: var(--jq-numeric-input-bg);
    box-shadow: 0.6rem 0.8rem 1.4rem -0.5rem var(--jq-numeric-input-shadow);
}

.MCButton {
    background: var(--jq-mc-button-bg);
    border: 1px solid var(--jq-mc-button-border);
    border-radius: inherit;
    color: #333333;
    padding: 10px;
    font-size: 16px;
    cursor: pointer;
    text-align: center;
    display: flex;
    align-items: center;
    justify-content: center;
}

.MCButton p {
    color: inherit;
}

.MultipleChoiceQn {
    padding: 10px;
    background: var(--jq-multiple-choice-bg);
    color: var(--jq-text-color);
    border-radius: inherit;
}

.ManyChoiceQn {
    padding: 10px;
    background: var(--jq-many-choice-bg);
    color: var(--jq-text-color);
    border-radius: inherit;
}

.NumericQn {
    background: var(--jq-numeric-bg);
    border-radius: inherit;
    color: var(--jq-text-color);
    padding: 10px;
}

.NumericQn p {
    color: inherit;
}

.StringQn {
    background: var(--jq-string-bg);
    border-radius: inherit;
    color: var(--jq-text-color);
    padding: 10px;
}

.StringQn p {
    color: inherit;
}


.InpLabel {
    color: var(--jq-numeric-input-label);
    float: left;
    font-size: 15pt;
    line-height: 34px;
    margin-right: 10px;
}

.incorrect {
    color: var(--jq-incorrect-color);
}

.correct {
    color: var(--jq-correct-color);
}

.correctButton {
    /*
    background: var(--jq-correct-color);
   */
    animation: correct-anim 0.6s ease;
    animation-fill-mode: forwards;
    box-shadow: inset 0 0 5px var(--jq-mc-button-inset-shadow);
    color: var(--jq-text-color);
    /*outline: none;*/
}

.incorrectButton {
    animation: incorrect-anim 0.8s ease;
    animation-fill-mode: forwards;
    box-shadow: inset 0 0 5px var(--jq-mc-button-inset-shadow);
    color: var(--jq-text-color);
    /*outline: none;*/
}

@keyframes incorrect-anim {
    100% {
        background-color: var(--jq-incorrect-color);
    }
}

@keyframes correct-anim {
    100% {
        background-color: var(--jq-correct-color);
    }
}
</style>
</div>
<div class="cell-output cell-output-display">
<script type="application/javascript">
var questionsqzEAkXHYYXSu=[{"question": "At what most recent time point is there a mass migration event\nbetween the western and central populations?\n", "type": "numeric", "answers": [{"value": 4003, "correct": true}]}, {"question": "At what most recent time point is there a mass migration event\nbetween the western and central populations?\n", "type": "numeric", "answers": [{"value": 6202, "correct": true}]}];

if (typeof Question === 'undefined') {
// Make a random ID
function makeid(length) {
    var result = [];
    var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
    var charactersLength = characters.length;
    for (var i = 0; i < length; i++) {
        result.push(characters.charAt(Math.floor(Math.random() * charactersLength)));
    }
    return result.join('');
}
// Convert LaTeX delimiters and markdown links to HTML
function jaxify(string) {
    let mystring = string;
    let count = 0, count2 = 0;
    let loc = mystring.search(/([^\\]|^)(\$)/);
    let loc2 = mystring.search(/([^\\]|^)(\$\$)/);
    while (loc >= 0 || loc2 >= 0) {
        if (loc2 >= 0) {
            mystring = mystring.replace(/([^\\]|^)(\$\$)/, count2 % 2 ? '$1\\]' : '$1\\[');
            count2++;
        } else {
            mystring = mystring.replace(/([^\\]|^)(\$)/, count % 2 ? '$1\\)' : '$1\\(');
            count++;
        }
        loc = mystring.search(/([^\\]|^)(\$)/);
        loc2 = mystring.search(/([^\\]|^)(\$\$)/);
    }
    // Replace markdown links
    mystring = mystring.replace(/<http(.*?)>/g, '<a href="http$1" target="_blank" class="Link">http$1</a>');
    mystring = mystring.replace(/\[(.*?)\]\((.*?)\)/g, '<a href="$2" target="_blank" class="Link">$1</a>');
    return mystring;
}

// Base class for question types
class Question {
    static registry = {};
    static register(type, cls) {
        Question.registry[type] = cls;
    }
    static create(qa, id, index, options, rootDiv) {
        const Cls = Question.registry[qa.type];
        if (!Cls) {
            console.error(`No question class registered for type "${qa.type}"`);
            return;
        }
        const q = new Cls(qa, id, index, options, rootDiv);
        q.render();
    }

    constructor(qa, id, index, options, rootDiv) {
        this.qa = qa;
        this.id = id;
        this.index = index;
        this.options = options;
        this.rootDiv = rootDiv;
        // wrapper
        this.wrapper = document.createElement('div');
        this.wrapper.id = `quizWrap${id}`;
        this.wrapper.className = 'Quiz';
        this.wrapper.dataset.qnum = index;
        this.wrapper.style.maxWidth = `${options.maxWidth}px`;
        rootDiv.appendChild(this.wrapper);
        // question container
        this.outerqDiv = document.createElement('div');
        this.outerqDiv.id = `OuterquizQn${id}${index}`;
        this.wrapper.appendChild(this.outerqDiv);
        // question text
        this.qDiv = document.createElement('div');
        this.qDiv.id = `quizQn${id}${index}`;
        if (qa.question) {
            this.qDiv.innerHTML = jaxify(qa.question);
            this.outerqDiv.appendChild(this.qDiv);
        }
        // code block
        if (qa.code) {
            const codeDiv = document.createElement('div');
            codeDiv.id = `code${id}${index}`;
            codeDiv.className = 'QuizCode';
            const pre = document.createElement('pre');
            const codeEl = document.createElement('code');
            codeEl.innerHTML = qa.code;
            pre.appendChild(codeEl);
            codeDiv.appendChild(pre);
            this.outerqDiv.appendChild(codeDiv);
        }
        // answer container
        this.aDiv = document.createElement('div');
        this.aDiv.id = `quizAns${id}${index}`;
        this.aDiv.className = 'Answer';
        this.wrapper.appendChild(this.aDiv);
        // feedback container (append after answers)
        this.fbDiv = document.createElement('div');
        this.fbDiv.id = `fb${id}`;
        this.fbDiv.className = 'Feedback';
        this.fbDiv.dataset.answeredcorrect = 0;
    }

    render() {
        throw new Error('render() not implemented');
    }

    preserveResponse(val) {
        if (!this.options.preserveResponses) return;
        const resp = document.getElementById(`responses${this.rootDiv.id}`);
        if (!resp) return;
        const arr = JSON.parse(resp.dataset.responses);
        arr[this.index] = val;
        resp.dataset.responses = JSON.stringify(arr);
        printResponses(resp);
    }

    typeset(container) {
        if (typeof MathJax !== 'undefined') {
            const v = MathJax.version;
            if (v[0] === '2') {
                MathJax.Hub.Queue(['Typeset', MathJax.Hub]);
            } else {
                MathJax.typeset([container]);
            }
        }
    }
}

// Choose a random subset of an array. Can also be used to shuffle the array
function getRandomSubarray(arr, size) {
    var shuffled = arr.slice(0), i = arr.length, temp, index;
    while (i--) {
        index = Math.floor((i + 1) * Math.random());
        temp = shuffled[index];
        shuffled[index] = shuffled[i];
        shuffled[i] = temp;
    }
    return shuffled.slice(0, size);
}

function printResponses(responsesContainer) {
    var responses=JSON.parse(responsesContainer.dataset.responses);
    var stringResponses='<B>IMPORTANT!</B>To preserve this answer sequence for submission, when you have finalized your answers: <ol> <li> Copy the text in this cell below "Answer String"</li> <li> Double click on the cell directly below the Answer String, labeled "Replace Me"</li> <li> Select the whole "Replace Me" text</li> <li> Paste in your answer string and press shift-Enter.</li><li>Save the notebook using the save icon or File->Save Notebook menu item</li></ul><br><br><br><b>Answer String:</b><br> ';
    console.log(responses);
    responses.forEach((response, index) => {
        if (response) {
            console.log(index + ': ' + response);
            stringResponses+= index + ': ' + response +"<BR>";
        }
    });
    responsesContainer.innerHTML=stringResponses;
}
/* Callback function to determine whether a selected multiple-choice
   button corresponded to a correct answer and to provide feedback
   based on the answer */
function check_mc() {
    var id = this.id.split('-')[0];
    //var response = this.id.split('-')[1];
    //console.log(response);
    //console.log("In check_mc(), id="+id);
    //console.log(event.srcElement.id)           
    //console.log(event.srcElement.dataset.correct)   
    //console.log(event.srcElement.dataset.feedback)

    var label = event.srcElement;
    //console.log(label, label.nodeName);
    var depth = 0;
    while ((label.nodeName != "LABEL") && (depth < 20)) {
        label = label.parentElement;
        console.log(depth, label);
        depth++;
    }



    var answers = label.parentElement.children;
    //console.log(answers);

    // Split behavior based on multiple choice vs many choice:
    var fb = document.getElementById("fb" + id);



    /* Multiple choice (1 answer). Allow for 0 correct
       answers as an edge case */
    if (fb.dataset.numcorrect <= 1) {
        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            //console.log(responsesContainer);
            var response = label.firstChild.innerText;
            if (label.querySelector(".QuizCode")){
                response+= label.querySelector(".QuizCode").firstChild.innerText;
            }
            console.log(response);
            //console.log(document.getElementById("quizWrap"+id));
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            console.log(responses);
            responses[qnum]= response;
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End code to preserve responses

        for (var i = 0; i < answers.length; i++) {
            var child = answers[i];
            //console.log(child);
            child.className = "MCButton";
        }



        if (label.dataset.correct == "true") {
            // console.log("Correct action");
            if ("feedback" in label.dataset) {
                fb.innerHTML = jaxify(label.dataset.feedback);
            } else {
                fb.innerHTML = "Correct!";
            }
            label.classList.add("correctButton");

            fb.className = "Feedback";
            fb.classList.add("correct");

        } else {
            if ("feedback" in label.dataset) {
                fb.innerHTML = jaxify(label.dataset.feedback);
            } else {
                fb.innerHTML = "Incorrect -- try again.";
            }
            //console.log("Error action");
            label.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }
    }
    else { /* Many choice (more than 1 correct answer) */
        var reset = false;
        var feedback;
         if (label.dataset.correct == "true") {
            if ("feedback" in label.dataset) {
                feedback = jaxify(label.dataset.feedback);
            } else {
                feedback = "Correct!";
            }
            if (label.dataset.answered <= 0) {
                if (fb.dataset.answeredcorrect < 0) {
                    fb.dataset.answeredcorrect = 1;
                    reset = true;
                } else {
                    fb.dataset.answeredcorrect++;
                }
                if (reset) {
                    for (var i = 0; i < answers.length; i++) {
                        var child = answers[i];
                        child.className = "MCButton";
                        child.dataset.answered = 0;
                    }
                }
                label.classList.add("correctButton");
                label.dataset.answered = 1;
                fb.className = "Feedback";
                fb.classList.add("correct");

            }
        } else {
            if ("feedback" in label.dataset) {
                feedback = jaxify(label.dataset.feedback);
            } else {
                feedback = "Incorrect -- try again.";
            }
            if (fb.dataset.answeredcorrect > 0) {
                fb.dataset.answeredcorrect = -1;
                reset = true;
            } else {
                fb.dataset.answeredcorrect--;
            }

            if (reset) {
                for (var i = 0; i < answers.length; i++) {
                    var child = answers[i];
                    child.className = "MCButton";
                    child.dataset.answered = 0;
                }
            }
            label.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }
        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            //console.log(responsesContainer);
            var response = label.firstChild.innerText;
            if (label.querySelector(".QuizCode")){
                response+= label.querySelector(".QuizCode").firstChild.innerText;
            }
            console.log(response);
            //console.log(document.getElementById("quizWrap"+id));
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            if (label.dataset.correct == "true") {
                if (typeof(responses[qnum]) == "object"){
                    if (!responses[qnum].includes(response))
                        responses[qnum].push(response);
                } else{
                    responses[qnum]= [ response ];
                }
            } else {
                responses[qnum]= response;
            }
            console.log(responses);
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End save responses stuff



        var numcorrect = fb.dataset.numcorrect;
        var answeredcorrect = fb.dataset.answeredcorrect;
        if (answeredcorrect >= 0) {
            fb.innerHTML = feedback + " [" + answeredcorrect + "/" + numcorrect + "]";
        } else {
            fb.innerHTML = feedback + " [" + 0 + "/" + numcorrect + "]";
        }


    }

    if (typeof MathJax != 'undefined') {
        var version = MathJax.version;
        console.log('MathJax version', version);
        if (version[0] == "2") {
            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        } else if (version[0] == "3") {
            MathJax.typeset([fb]);
        }
    } else {
        console.log('MathJax not detected');
    }

}


/* Function to produce the HTML buttons for a multiple choice/
   many choice question  and to update the CSS tags based on
   the question type */
function make_mc(qa, shuffle_answers, outerqDiv, qDiv, aDiv, id) {

    var shuffled;
    if (shuffle_answers == true) {
        //console.log(shuffle_answers+" read as true");
        shuffled = getRandomSubarray(qa.answers, qa.answers.length);
    } else {
        //console.log(shuffle_answers+" read as false");
        shuffled = qa.answers;
    }


    var num_correct = 0;

    shuffled.forEach((item, index, ans_array) => {
        //console.log(answer);

        // Make input element
        var inp = document.createElement("input");
        inp.type = "radio";
        inp.id = "quizo" + id + index;
        inp.style = "display:none;";
        aDiv.append(inp);

        //Make label for input element
        var lab = document.createElement("label");
        lab.className = "MCButton";
        lab.id = id + '-' + index;
        lab.onclick = check_mc;
        var aSpan = document.createElement('span');
        aSpan.classsName = "";
        //qDiv.id="quizQn"+id+index;
        if ("answer" in item) {
            aSpan.innerHTML = jaxify(item.answer);
            //aSpan.innerHTML=item.answer;
        }
        lab.append(aSpan);

        // Create div for code inside question
        var codeSpan;
        if ("code" in item) {
            codeSpan = document.createElement('span');
            codeSpan.id = "code" + id + index;
            codeSpan.className = "QuizCode";
            var codePre = document.createElement('pre');
            codeSpan.append(codePre);
            var codeCode = document.createElement('code');
            codePre.append(codeCode);
            codeCode.innerHTML = item.code;
            lab.append(codeSpan);
            //console.log(codeSpan);
        }

        //lab.textContent=item.answer;

        // Set the data attributes for the answer
        lab.setAttribute('data-correct', item.correct);
        if (item.correct) {
            num_correct++;
        }
        if ("feedback" in item) {
            lab.setAttribute('data-feedback', item.feedback);
        }
        lab.setAttribute('data-answered', 0);

        aDiv.append(lab);

    });

    if (num_correct > 1) {
        outerqDiv.className = "ManyChoiceQn";
    } else {
        outerqDiv.className = "MultipleChoiceQn";
    }

    return num_correct;

}
// Object-oriented wrapper for MC/MANY choice
class MCQuestion extends Question {
    constructor(qa, id, idx, opts, rootDiv) { super(qa, id, idx, opts, rootDiv); }
    render() {
        //console.log("options.shuffleAnswers " + this.options.shuffleAnswers);
        const numCorrect = make_mc(
            this.qa,
            this.options.shuffleAnswers,
            this.outerqDiv,
            this.qDiv,
            this.aDiv,
            this.id
        );
        if ('answer_cols' in this.qa) {
            this.aDiv.style.gridTemplateColumns =
                'repeat(' + this.qa.answer_cols + ', 1fr)';
        }
        this.fbDiv.dataset.numcorrect = numCorrect;
        this.wrapper.appendChild(this.fbDiv);
    }
}
Question.register('multiple_choice', MCQuestion);
Question.register('many_choice', MCQuestion);
function check_numeric(ths, event) {

    if (event.keyCode === 13) {
        ths.blur();

        var id = ths.id.split('-')[0];

        var submission = ths.value;
        if (submission.indexOf('/') != -1) {
            var sub_parts = submission.split('/');
            //console.log(sub_parts);
            submission = sub_parts[0] / sub_parts[1];
        }
        //console.log("Reader entered", submission);

        if ("precision" in ths.dataset) {
            var precision = ths.dataset.precision;
            submission = Number(Number(submission).toPrecision(precision));
        }


        //console.log("In check_numeric(), id="+id);
        //console.log(event.srcElement.id)           
        //console.log(event.srcElement.dataset.feedback)

        var fb = document.getElementById("fb" + id);
        fb.style.display = "none";
        fb.innerHTML = "Incorrect -- try again.";

        var answers = JSON.parse(ths.dataset.answers);
        //console.log(answers);

        var defaultFB = "Incorrect. Try again.";
        var correct;
        var done = false;
        answers.every(answer => {
            //console.log(answer.type);

            correct = false;
            // if (answer.type=="value"){
            if ('value' in answer) {
                var value;
                if ("precision" in ths.dataset) {
                    value = answer.value.toPrecision(ths.dataset.precision);
                } else {
                    value = answer.value;
                }
                if (submission == value) {
                    if ("feedback" in answer) {
                        fb.innerHTML = jaxify(answer.feedback);
                    } else {
                        fb.innerHTML = jaxify("Correct");
                    }
                    correct = answer.correct;
                    //console.log(answer.correct);
                    done = true;
                }

                // } else if (answer.type=="range") {
            } else if ('range' in answer) {
                console.log(answer.range);
                console.log(submission, submission >=answer.range[0], submission < answer.range[1])
                if ((submission >= answer.range[0]) && (submission < answer.range[1])) {
                    fb.innerHTML = jaxify(answer.feedback);
                    correct = answer.correct;
                    console.log(answer.correct);
                    done = true;
                }
            } else if (answer.type == "default") {
                if ("feedback" in answer) {
                    defaultFB = answer.feedback;
                } 
            }
            if (done) {
                return false; // Break out of loop if this has been marked correct
            } else {
                return true; // Keep looking for case that includes this as a correct answer
            }
        });
        console.log("done:", done);

        if ((!done) && (defaultFB != "")) {
            fb.innerHTML = jaxify(defaultFB);
            //console.log("Default feedback", defaultFB);
        }

        fb.style.display = "block";
        if (correct) {
            ths.className = "Input-text";
            ths.classList.add("correctButton");
            fb.className = "Feedback";
            fb.classList.add("correct");
        } else {
            ths.className = "Input-text";
            ths.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }

        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            console.log(submission);
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            //console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            console.log(responses);
            if (submission == ths.value){
                responses[qnum]= submission;
            } else {
                responses[qnum]= ths.value + "(" + submission +")";
            }
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End code to preserve responses

        if (typeof MathJax != 'undefined') {
            var version = MathJax.version;
            console.log('MathJax version', version);
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([fb]);
            }
        } else {
            console.log('MathJax not detected');
        }
        // After correct answer, if next JupyterQuiz question exists and has a text input, scroll by current question height
        if (correct) {
            // find the current question wrapper
            var wrapper = ths.closest('.Quiz');
            if (wrapper) {
                var nextWrapper = wrapper.nextElementSibling;
                if (nextWrapper && nextWrapper.classList.contains('Quiz')) {
                    var nextInput = nextWrapper.querySelector('input.Input-text');
                    if (nextInput) {
                        var height = wrapper.getBoundingClientRect().height;
                        console.log(height);
                        nextInput.focus();
                    }
                }
            }
        }
        return false;
    }

}
// Object-oriented wrapper for numeric questions
class NumericQuestion extends Question {
    constructor(qa, id, idx, opts, rootDiv) {
        super(qa, id, idx, opts, rootDiv);
    }
    render() {
        make_numeric(this.qa, this.outerqDiv, this.qDiv, this.aDiv, this.id);
        this.wrapper.appendChild(this.fbDiv);
    }
}
Question.register('numeric', NumericQuestion);

function isValid(el, charC) {
    //console.log("Input char: ", charC);
    if (charC == 46) {
        if (el.value.indexOf('.') === -1) {
            return true;
        } else if (el.value.indexOf('/') != -1) {
            var parts = el.value.split('/');
            if (parts[1].indexOf('.') === -1) {
                return true;
            }
        }
        else {
            return false;
        }
    } else if (charC == 47) {
        if (el.value.indexOf('/') === -1) {
            if ((el.value != "") && (el.value != ".")) {
                return true;
            } else {
                return false;
            }
        } else {
            return false;
        }
    } else if (charC == 45) {
        var edex = el.value.indexOf('e');
        if (edex == -1) {
            edex = el.value.indexOf('E');
        }

        if (el.value == "") {
            return true;
        } else if (edex == (el.value.length - 1)) { // If just after e or E
            return true;
        } else {
            return false;
        }
    } else if (charC == 101) { // "e"
        if ((el.value.indexOf('e') === -1) && (el.value.indexOf('E') === -1) && (el.value.indexOf('/') == -1)) {
            // Prev symbol must be digit or decimal point:
            if (el.value.slice(-1).search(/\d/) >= 0) {
                return true;
            } else if (el.value.slice(-1).search(/\./) >= 0) {
                return true;
            } else {
                return false;
            }
        } else {
            return false;
        }
    } else {
        if (charC > 31 && (charC < 48 || charC > 57))
            return false;
    }
    return true;
}

function numeric_keypress(evnt) {
    var charC = (evnt.which) ? evnt.which : evnt.keyCode;

    if (charC == 13) {
        check_numeric(this, evnt);
    } else {
        return isValid(this, charC);
    }
}





function make_numeric(qa, outerqDiv, qDiv, aDiv, id) {



    //console.log(answer);


    outerqDiv.className = "NumericQn";
    aDiv.style.display = 'block';

    var lab = document.createElement("label");
    lab.className = "InpLabel";
    lab.innerHTML = "Type numeric answer here:";
    aDiv.append(lab);

    var inp = document.createElement("input");
    inp.type = "text";
    //inp.id="input-"+id;
    inp.id = id + "-0";
    inp.className = "Input-text";
    inp.setAttribute('data-answers', JSON.stringify(qa.answers));
    if ("precision" in qa) {
        inp.setAttribute('data-precision', qa.precision);
    }
    aDiv.append(inp);
    //console.log(inp);

    //inp.addEventListener("keypress", check_numeric);
    //inp.addEventListener("keypress", numeric_keypress);
    /*
    inp.addEventListener("keypress", function(event) {
        return numeric_keypress(this, event);
    }
                        );
                        */
    //inp.onkeypress="return numeric_keypress(this, event)";
    inp.onkeypress = numeric_keypress;
    inp.onpaste = event => false;

    inp.addEventListener("focus", function (event) {
        this.value = "";
        return false;
    }
    );


}
// Override show_questions to use object-oriented Question API
function show_questions(json, container) {
    // Accept container element or element ID
    if (typeof container === 'string') {
        container = document.getElementById(container);
    }
    if (!container) {
        console.error('show_questions: invalid container', container);
        return;
    }

    const shuffleQuestions = container.dataset.shufflequestions === 'True';
    const shuffleAnswers = container.dataset.shuffleanswers === 'True';
    const preserveResponses = container.dataset.preserveresponses === 'true';
    const maxWidth = parseInt(container.dataset.maxwidth, 10) || 0;
    let numQuestions = parseInt(container.dataset.numquestions, 10) || json.length;
    if (numQuestions > json.length) numQuestions = json.length;

    let questions = json;
    if (shuffleQuestions || numQuestions < json.length) {
        questions = getRandomSubarray(json, numQuestions);
    }

    questions.forEach((qa, index) => {
        const id = makeid(8);
        const options = {
            shuffleAnswers: shuffleAnswers,
            preserveResponses: preserveResponses,
            maxWidth: maxWidth
        };
        Question.create(qa, id, index, options, container);
    });

    if (preserveResponses) {
        const respDiv = document.createElement('div');
        respDiv.id = 'responses' + container.id;
        respDiv.className = 'JCResponses';
        respDiv.dataset.responses = JSON.stringify([]);
        respDiv.innerHTML = '<b>Select your answers and then follow the directions that will appear here.</b>';
        container.appendChild(respDiv);
    }

    // Trigger MathJax typesetting if available
    if (typeof MathJax != 'undefined') {
        console.log("MathJax version", MathJax.version);
        var version = MathJax.version;
        setTimeout(function(){
            var version = MathJax.version;
            console.log('After sleep, MathJax version', version);
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                if (MathJax.hasOwnProperty('typeset') ) {
                    MathJax.typeset([container]);
                } else {
                    console.log('WARNING: Trying to force load MathJax 3');
                    window.MathJax = {
                        tex: {
                            inlineMath: [['$', '$'], ['\\(', '\\)']]
                        },
                        svg: {
                            fontCache: 'global'
                        }
                    };

                    (function () {
                        var script = document.createElement('script');
                        script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js';
                        script.async = true;
                        document.head.appendChild(script);
                    })();
                }
            }
        }, 500);
if (typeof version == 'undefined') {
        } else
        {
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                if (MathJax.hasOwnProperty('typeset') ) {
                    MathJax.typeset([container]);
                } else {
                    console.log('WARNING: Trying to force load MathJax 3');
                    window.MathJax = {
                        tex: {
                            inlineMath: [['$', '$'], ['\\(', '\\)']]
                        },
                        svg: {
                            fontCache: 'global'
                        }
                    };

                    (function () {
                        var script = document.createElement('script');
                        script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js';
                        script.async = true;
                        document.head.appendChild(script);
                    })();
                }
            } else {
                console.log("MathJax not found");
            }
        }
    }
    // if (typeof MathJax !== 'undefined') {
    //     const v = MathJax.version;
    //     if (v[0] === '2') {
    //         MathJax.Hub.Queue(['Typeset', MathJax.Hub]);
    //     } else if (v[0] === '3') {
    //         MathJax.typeset([container]);
    //     }
    // }

    // Prevent link clicks from bubbling up
    Array.from(container.getElementsByClassName('Link')).forEach(link => {
        link.addEventListener('click', e => e.stopPropagation());
    });
}
function levenshteinDistance(a, b) {
    if (a.length === 0) return b.length;
    if (b.length === 0) return a.length;

    const matrix = Array(b.length + 1).fill(null).map(() => Array(a.length + 1).fill(null));

    for (let i = 0; i <= a.length; i++) {
        matrix[0][i] = i;
    }

    for (let j = 0; j <= b.length; j++) {
        matrix[j][0] = j;
    }

    for (let j = 1; j <= b.length; j++) {
        for (let i = 1; i <= a.length; i++) {
            const cost = a[i - 1] === b[j - 1] ? 0 : 1;
            matrix[j][i] = Math.min(
                matrix[j - 1][i] + 1, // Deletion
                matrix[j][i - 1] + 1, // Insertion
                matrix[j - 1][i - 1] + cost // Substitution
            );
        }
    }
    return matrix[b.length][a.length];
}
// Object-oriented wrapper for string input questions
class StringQuestion extends Question {
    constructor(qa, id, idx, opts, rootDiv) {
        super(qa, id, idx, opts, rootDiv);
    }
    render() {
        make_string(this.qa, this.outerqDiv, this.qDiv, this.aDiv, this.id);
        this.wrapper.appendChild(this.fbDiv);
    }
}
Question.register('string', StringQuestion);

function check_string(ths, event) {
    if (event.keyCode === 13) {
        ths.blur();

        var id = ths.id.split('-')[0];
        var submission = ths.value.trim();
        var fb = document.getElementById("fb" + id);
        fb.style.display = "none";
        fb.innerHTML = "Incorrect -- try again.";

        var answers = JSON.parse(ths.dataset.answers);
        var defaultFB = "Incorrect. Try again.";
        var correct;
        var done = false;

        // Handle default answer pattern: filter out and capture default feedback
        var filteredAnswers = [];
        answers.forEach(answer => {
            if (answer.type === "default") {
                defaultFB = answer.feedback;
            } else {
                filteredAnswers.push(answer);
            }
        });
        answers = filteredAnswers;

        answers.every(answer => {
            correct = false;

            let match = false;
            if (answer.match_case) {
                match = submission === answer.answer;
            } else {
                match = submission.toLowerCase() === answer.answer.toLowerCase();
            }
            console.log(submission);
            console.log(answer.answer);
            console.log(match);

            if (match) {
                if ("feedback" in answer) {
                    fb.innerHTML = jaxify(answer.feedback);
                } else {
                    fb.innerHTML = jaxify("Correct");
                }
                correct = answer.correct;
                done = true;
            } else if (answer.fuzzy_threshold) {
                var max_length = Math.max(submission.length, answer.answer.length);
                var ratio;
                if (answer.match_case) {
                    ratio = 1- (levenshteinDistance(submission, answer.answer) / max_length);
                } else {
                    ratio = 1- (levenshteinDistance(submission.toLowerCase(),
                                                    answer.answer.toLowerCase()) / max_length);
                }
                if (ratio >= answer.fuzzy_threshold) {
                    if ("feedback" in answer) {
                        fb.innerHTML = jaxify("(Fuzzy) " + answer.feedback);
                    } else {
                        fb.innerHTML = jaxify("Correct");
                    }
                    correct = answer.correct;
                    done = true;
                }

            }

            if (done) {
                return false;
            } else {
                return true;
            }
        });

        if ((!done) && (defaultFB != "")) {
            fb.innerHTML = jaxify(defaultFB);
        }

        fb.style.display = "block";
        if (correct) {
            ths.className = "Input-text";
            ths.classList.add("correctButton");
            fb.className = "Feedback";
            fb.classList.add("correct");
        } else {
            ths.className = "Input-text";
            ths.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }

        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            var qnum = document.getElementById("quizWrap" + id).dataset.qnum;
            var responses = JSON.parse(responsesContainer.dataset.responses);
            responses[qnum] = submission;
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }

        if (typeof MathJax != 'undefined') {
            var version = MathJax.version;
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([fb]);
            }
        } else {
            console.log('MathJax not detected');
        }
        // After correct answer, if next JupyterQuiz question exists and has a text input, scroll by current question height
        if (correct) {
            var wrapper = ths.closest('.Quiz');
            if (wrapper) {
                var nextWrapper = wrapper.nextElementSibling;
                if (nextWrapper && nextWrapper.classList.contains('Quiz')) {
                    var nextInput = nextWrapper.querySelector('input.Input-text');
                    if (nextInput) {
                        var height = wrapper.getBoundingClientRect().height;
                        nextInput.focus();
                    }
                }
            }
        }
        return false;
    }
}

function string_keypress(evnt) {
    var charC = (evnt.which) ? evnt.which : evnt.keyCode;

    if (charC == 13) {
        check_string(this, evnt);
    } 
}


function make_string(qa, outerqDiv, qDiv, aDiv, id) {
    outerqDiv.className = "StringQn";
    aDiv.style.display = 'block';

    var lab = document.createElement("label");
    lab.className = "InpLabel";
    lab.innerHTML = "Type your answer here:";
    aDiv.append(lab);

    var inp = document.createElement("input");
    inp.type = "text";
    inp.id = id + "-0";
    inp.className = "Input-text";
    inp.setAttribute('data-answers', JSON.stringify(qa.answers));
    // Apply optional input width (approx. number of characters, in em units)
    if (qa.input_width != null) {
        inp.style['min-width'] = qa.input_width + 'em';
    }
    aDiv.append(inp);

    inp.onkeypress = string_keypress;
    inp.onpaste = event => false;

    inp.addEventListener("focus", function (event) {
        this.value = "";
        return false;
    });
}
/*
 * Handle asynchrony issues when re-running quizzes in Jupyter notebooks.
 * Ensures show_questions is called after the container div is in the DOM.
 */
function try_show() {
  if (document.getElementById("qzEAkXHYYXSu")) {
    show_questions(questionsqzEAkXHYYXSu, qzEAkXHYYXSu);
  } else {
    setTimeout(try_show, 200);
  }
};
// Invoke immediately
{
  try_show();
}
}

</script>
</div>
</div>
</div></section>
<section id="making-sense-of-the-simulations" class="level2">
<h2 class="anchored" data-anchor-id="making-sense-of-the-simulations">Making sense of the simulations</h2>
<p>Before proceeding, let’s make some sanity checks to confirm that the results make sense. We expect the central population to have undergone neutral evolution, whereas bonobo and western have selective sweep signatures at different loci (at 3.33Mb and 6.67Mb, respectively). We can investigate the effect on nucleotide diversity by making windowed plots along the chromosome.</p>
<p>Import matplotlib, setup color schemes and plotting parameters and finally plot diversity in 100kb windows.</p>
<div id="a4ea75df" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.colors <span class="im">as</span> mcolors</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>mpl_colors <span class="op">=</span> mcolors.TABLEAU_COLORS</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>ts <span class="op">=</span> tskit.load(treesfile)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Make population metadata dict, skipping non-sampled ghost population</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>popmd <span class="op">=</span> {p.<span class="bu">id</span>:p.metadata <span class="cf">for</span> p <span class="kw">in</span> ts.populations() <span class="cf">if</span> p.<span class="bu">id</span> <span class="op">!=</span> <span class="dv">3</span>}</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add all samples as extra sample set</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>popmd[<span class="bu">len</span>(popmd)] <span class="op">=</span> {<span class="st">'description'</span>: <span class="st">'All samples'</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'id'</span>: <span class="st">'ALL'</span>, <span class="st">'name'</span>: <span class="st">'ALL'</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'sampling_time'</span>: <span class="dv">0</span>}</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Use same colors for populations as in demesdraw graph</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>demesdraw_colors <span class="op">=</span> [<span class="st">"tab:red"</span>, <span class="st">"tab:green"</span>, <span class="st">"tab:orange"</span>, <span class="st">"tab:blue"</span>]</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> pop, color <span class="kw">in</span> <span class="bu">zip</span>(popmd, demesdraw_colors):</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    popmd[pop][<span class="st">"color"</span>] <span class="op">=</span> color</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    popmd[pop][<span class="st">"mpl_color"</span>] <span class="op">=</span> mpl_colors[color]</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>sample_sets <span class="op">=</span> [ts.samples(i) <span class="cf">for</span> i <span class="kw">in</span> popmd <span class="cf">if</span> i <span class="op">!=</span> <span class="dv">3</span>] <span class="op">+</span> [ts.samples()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="4e5b5329" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>num_windows <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>window_size <span class="op">=</span> ts.sequence_length <span class="op">/</span> num_windows</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>windows <span class="op">=</span> np.linspace(<span class="dv">0</span>, ts.sequence_length, num_windows <span class="op">+</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="432d0388" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>pi_win <span class="op">=</span> ts.diversity(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    sample_sets<span class="op">=</span>sample_sets,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    windows<span class="op">=</span>windows</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="315c7a3b" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">7</span>))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    plt.stairs(pi_win[:, i], windows, label<span class="op">=</span>popmd[i][<span class="st">"name"</span>], color<span class="op">=</span>popmd[i][<span class="st">"mpl_color"</span>])</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>plt.axvline(ts.sequence_length <span class="op">/</span> <span class="dv">3</span>, color<span class="op">=</span>popmd[<span class="dv">2</span>][<span class="st">"mpl_color"</span>], linestyle<span class="op">=</span><span class="st">"dashed"</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>plt.axvline(<span class="dv">2</span> <span class="op">*</span> ts.sequence_length <span class="op">/</span> <span class="dv">3</span>, color<span class="op">=</span>popmd[<span class="dv">0</span>][<span class="st">"mpl_color"</span>], linestyle<span class="op">=</span><span class="st">"dashed"</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>plt.legend(bbox_to_anchor<span class="op">=</span>(<span class="dv">1</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="st">"upper left"</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Genomic position (bp)"</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Diversity (pi)"</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="stdpopsim_lab_II_files/figure-html/cell-13-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="stdpopsim_lab_II_files/figure-html/cell-13-output-1.png" width="1094" height="577" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>For clarity, we added the locations of sweeps (dashed lines) for both populations. There is a clear drop in diversity at both sites (and for the correct populations too!), so the simulations make intuitive sense. We could also zoom in on one of the sweep locations for increased resolution:</p>
<div id="d7943744" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>num_windows <span class="op">=</span> <span class="dv">2_000</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>windows <span class="op">=</span> np.linspace(<span class="dv">0</span>, ts.sequence_length, num_windows <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>pi_win_zoom <span class="op">=</span> ts.diversity(sample_sets<span class="op">=</span>sample_sets, windows<span class="op">=</span>windows)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="652bc9d2" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>pad <span class="op">=</span> <span class="fl">0.03</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">5</span>))</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    plt.stairs(pi_win_zoom[:, i], windows, label<span class="op">=</span>popmd[i][<span class="st">"name"</span>], color<span class="op">=</span>popmd[i][<span class="st">"mpl_color"</span>])</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>plt.axvline(L <span class="op">/</span> <span class="dv">3</span>, color<span class="op">=</span>popmd[<span class="dv">2</span>][<span class="st">"mpl_color"</span>], linestyle<span class="op">=</span><span class="st">"dashed"</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>plt.axvline(<span class="dv">2</span> <span class="op">*</span> L <span class="op">/</span> <span class="dv">3</span>, color<span class="op">=</span>popmd[<span class="dv">0</span>][<span class="st">"mpl_color"</span>], linestyle<span class="op">=</span><span class="st">"dashed"</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="dv">2</span> <span class="op">*</span> L <span class="op">/</span> <span class="dv">3</span> <span class="op">-</span> L <span class="op">*</span> pad, <span class="dv">2</span> <span class="op">*</span> L <span class="op">/</span> <span class="dv">3</span> <span class="op">+</span> L <span class="op">*</span> pad)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>plt.legend(bbox_to_anchor<span class="op">=</span>(<span class="dv">1</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="st">"upper left"</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Genomic position (bp)"</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Diversity (pi)"</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Nucleotide diversity, site statistics"</span>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="stdpopsim_lab_II_files/figure-html/cell-15-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="stdpopsim_lab_II_files/figure-html/cell-15-output-1.png" width="1103" height="449" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>Here the pattern of reduced diversity is more prominent for the western population - in particular there is a stretch of windows where it is consistently low. For comparison’s sake, we reproduce the plot but using branch length statistics.</p>
<div id="8885525f" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>pi_win_branch <span class="op">=</span> ts.diversity(sample_sets<span class="op">=</span>sample_sets, windows<span class="op">=</span>windows, mode<span class="op">=</span><span class="st">"branch"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="991e6d79" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>pad <span class="op">=</span> <span class="fl">0.05</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">5</span>))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    plt.stairs(pi_win_branch[:, i], windows, label<span class="op">=</span>popmd[i][<span class="st">"name"</span>], color<span class="op">=</span>popmd[i][<span class="st">"mpl_color"</span>])</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>plt.axvline(L <span class="op">/</span> <span class="dv">3</span>, color<span class="op">=</span>popmd[<span class="dv">2</span>][<span class="st">"mpl_color"</span>], linestyle<span class="op">=</span><span class="st">"dashed"</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>plt.axvline(<span class="dv">2</span> <span class="op">*</span> L <span class="op">/</span> <span class="dv">3</span>, color<span class="op">=</span>popmd[<span class="dv">0</span>][<span class="st">"mpl_color"</span>], linestyle<span class="op">=</span><span class="st">"dashed"</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="dv">2</span> <span class="op">*</span> L <span class="op">/</span> <span class="dv">3</span> <span class="op">-</span> L <span class="op">*</span> pad, <span class="dv">2</span> <span class="op">*</span> L <span class="op">/</span> <span class="dv">3</span> <span class="op">+</span> L <span class="op">*</span> pad)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>plt.legend(bbox_to_anchor<span class="op">=</span>(<span class="dv">1</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="st">"upper left"</span>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Genomic position (bp)"</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Diversity (pi)"</span>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Nucleotide diversity, branch statistics"</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="stdpopsim_lab_II_files/figure-html/cell-17-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="stdpopsim_lab_II_files/figure-html/cell-17-output-1.png" width="1099" height="449" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>As we alluded to earlier, the plots are now smoother since the stochastic noise added by mutations has been eliminated.</p>
</section>
<section id="trees-at-sweep-locations" class="level2">
<h2 class="anchored" data-anchor-id="trees-at-sweep-locations">Trees at sweep locations</h2>
<p>Selective sweeps are mutations that spread quickly in a population and they leave characteristic traces in the tree sequences surrounding a sweep. Let’s investigate the patterns by plotting trees around the sweep location. We first load the necessary python library and define color styles that apply relevant colors to the populations.</p>
<div id="4f247b5d" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> SVG</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="5ea30df3" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>styles <span class="op">=</span> []</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> ts.population(i)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> <span class="ss">f".node.p</span><span class="sc">{</span>p<span class="sc">.</span><span class="bu">id</span><span class="sc">}</span><span class="ss"> &gt; .sym "</span> <span class="op">+</span> <span class="st">"{"</span> <span class="op">+</span> <span class="ss">f"fill: </span><span class="sc">{</span>popmd[i][<span class="st">'mpl_color'</span>]<span class="sc">}</span><span class="ss">"</span> <span class="op">+</span> <span class="st">"}"</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    styles.append(s)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f'"</span><span class="sc">{</span>s<span class="sc">}</span><span class="ss">" applies to nodes from population </span><span class="sc">{</span>popmd[i][<span class="st">"name"</span>]<span class="sc">}</span><span class="ss"> (id </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">)'</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>css_string <span class="op">=</span> <span class="st">" "</span>.join(styles)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'CSS string applied:</span><span class="ch">\n</span><span class="ss">    "</span><span class="sc">{</span>css_string<span class="sc">}</span><span class="ss">"'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>".node.p0 &gt; .sym {fill: #d62728}" applies to nodes from population western (id 0)
".node.p1 &gt; .sym {fill: #2ca02c}" applies to nodes from population central (id 1)
".node.p2 &gt; .sym {fill: #ff7f0e}" applies to nodes from population bonobo (id 2)
CSS string applied:
    ".node.p0 &gt; .sym {fill: #d62728} .node.p1 &gt; .sym {fill: #2ca02c} .node.p2 &gt; .sym {fill: #ff7f0e}"</code></pre>
</div>
</div>
<p>First we plot a tree at a locus that is not under selection, just to get an idea of what a general tree would look like. You can plot a tree at a specific genomic coordinate using the <a href="https://tskit.dev/tskit/docs/stable/python-api.html#tskit.TreeSequence.at">ts.at</a> syntax.</p>
<dl class="exercise">
<dt>
Exercise 2.
</dt>
<dd>
Plot the tree at locus <code>L / 10</code>.
</dd>
</dl>
<div id="49703d2b" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the tree at L / 10</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>kw <span class="op">=</span> {<span class="st">"size"</span>: (<span class="dv">1200</span>, <span class="dv">400</span>), <span class="st">"y_axis"</span>: <span class="va">True</span>, <span class="st">"node_labels"</span>: {},</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>      <span class="st">"x_axis"</span>: <span class="va">True</span>, <span class="st">"y_ticks"</span>: [<span class="dv">0</span>, <span class="dv">50_000</span>, <span class="dv">100_000</span>], <span class="st">"style"</span>: css_string}</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ts.at( enter locus here ).draw_svg(**kw)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="ff013a76" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>workbook.question(<span class="st">"neutral_locus"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="xbNILjhRfahk" data-shufflequestions="False" data-shuffleanswers="True" data-preserveresponses="false" data-numquestions="1000000" data-maxwidth="600" style="border-radius: 10px; text-align: left"><style>
#xbNILjhRfahk {
   --jq-multiple-choice-bg: #a7c947;
   --jq-mc-button-bg: #c0d6d8;
   --jq-mc-button-border: #82aeb2;
   --jq-mc-button-inset-shadow: #43858b;
   --jq-many-choice-bg: #a7c947;
   --jq-numeric-bg: #a7c947;
   --jq-numeric-input-bg: #bdd775;
   --jq-numeric-input-label: #a7c947;
   --jq-numeric-input-shadow: #bdd775;
   --jq-string-bg: #4c1a57;
   --jq-incorrect-color: #491f53;
   --jq-correct-color: #82aeb2;
   --jq-text-color: #e9f2d1;
}

.Quiz {
    max-width: 600px;
    margin-top: 15px;
    margin-left: auto;
    margin-right: auto;
/*    margin-bottom: 15px;*/
/*    padding-bottom: 4px;*/
    padding-top: 4px;
    line-height: 1.1;
    font-size: 16pt;
    border-radius: inherit;
}

.QuizCode {
    font-size: 14pt;
    margin-top: 10px;
    margin-left: 20px;
    margin-right: 20px;
}

.QuizCode>pre {
    padding: 4px;
}

.Quiz code {
    background-color: lightgray;
    color: black;
}

.Quiz .QuizCode code {
    background-color: inherit;
    color: inherit;
}


.Quiz .MCButton code {
    background-color: inherit;
    color: inherit;
}

.MCButton .QuizCode {
    text-align: left;
}




.Answer {
    border-radius: inherit;
    display: grid;
    grid-gap: 10px;
    grid-template-columns: 1fr 1fr;
    margin: 10px 0;
}

@media only screen and (max-width:480px) {
    .Answer {
        grid-template-columns: 1fr;
    }

}

.Feedback {
    font-size: 16pt;
    text-align: center;
/*    min-height: 2em;*/
}

.Input {
    align: left;
    font-size: 20pt;
}

.Input-text {
    display: block;
    margin: 10px;
    color: inherit;
    width: unset;
    min-width: 140px;
    max-width: 93%;
    field-sizing: content;
    background-color: var(--jq-numeric-input-bg);
    color: var(--jq-text-color);
    padding: 5px;
    padding-left: 10px;
    font-family: inherit;
    font-size: 20px;
    font-weight: inherit;
    line-height: 20pt;
    border: none;
    border-radius: 0.2rem;
    transition: box-shadow 0.1s);
}

.Input-text:focus {
    /*outline: none;*/
    background-color: var(--jq-numeric-input-bg);
    box-shadow: 0.6rem 0.8rem 1.4rem -0.5rem var(--jq-numeric-input-shadow);
}

.MCButton {
    background: var(--jq-mc-button-bg);
    border: 1px solid var(--jq-mc-button-border);
    border-radius: inherit;
    color: #333333;
    padding: 10px;
    font-size: 16px;
    cursor: pointer;
    text-align: center;
    display: flex;
    align-items: center;
    justify-content: center;
}

.MCButton p {
    color: inherit;
}

.MultipleChoiceQn {
    padding: 10px;
    background: var(--jq-multiple-choice-bg);
    color: var(--jq-text-color);
    border-radius: inherit;
}

.ManyChoiceQn {
    padding: 10px;
    background: var(--jq-many-choice-bg);
    color: var(--jq-text-color);
    border-radius: inherit;
}

.NumericQn {
    background: var(--jq-numeric-bg);
    border-radius: inherit;
    color: var(--jq-text-color);
    padding: 10px;
}

.NumericQn p {
    color: inherit;
}

.StringQn {
    background: var(--jq-string-bg);
    border-radius: inherit;
    color: var(--jq-text-color);
    padding: 10px;
}

.StringQn p {
    color: inherit;
}


.InpLabel {
    color: var(--jq-numeric-input-label);
    float: left;
    font-size: 15pt;
    line-height: 34px;
    margin-right: 10px;
}

.incorrect {
    color: var(--jq-incorrect-color);
}

.correct {
    color: var(--jq-correct-color);
}

.correctButton {
    /*
    background: var(--jq-correct-color);
   */
    animation: correct-anim 0.6s ease;
    animation-fill-mode: forwards;
    box-shadow: inset 0 0 5px var(--jq-mc-button-inset-shadow);
    color: var(--jq-text-color);
    /*outline: none;*/
}

.incorrectButton {
    animation: incorrect-anim 0.8s ease;
    animation-fill-mode: forwards;
    box-shadow: inset 0 0 5px var(--jq-mc-button-inset-shadow);
    color: var(--jq-text-color);
    /*outline: none;*/
}

@keyframes incorrect-anim {
    100% {
        background-color: var(--jq-incorrect-color);
    }
}

@keyframes correct-anim {
    100% {
        background-color: var(--jq-correct-color);
    }
}
</style>
</div>
<div class="cell-output cell-output-display">
<script type="application/javascript">
var questionsxbNILjhRfahk=[{"question": "The populations roughly form three groups. What is true\nregarding the branch lengths of bonobo (orange) compared to\nthe other populations?\n", "type": "many_choice", "answers": [{"answer": "They are roughly equal.\n", "correct": true, "feedback": "Correct! Since the locus is evolving neutrally in all\npopulations, all trees should have similar coalescence\npatterns, reflected by similar branch lengths. There may\nof course be large variation, but here there is no\ndiscernible difference.\n"}, {"answer": "The branch lengths of western and central populations are\nlonger\n", "correct": false}, {"answer": "The branch lengths of bonobo are longer\n", "correct": false}]}];

if (typeof Question === 'undefined') {
// Make a random ID
function makeid(length) {
    var result = [];
    var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
    var charactersLength = characters.length;
    for (var i = 0; i < length; i++) {
        result.push(characters.charAt(Math.floor(Math.random() * charactersLength)));
    }
    return result.join('');
}
// Convert LaTeX delimiters and markdown links to HTML
function jaxify(string) {
    let mystring = string;
    let count = 0, count2 = 0;
    let loc = mystring.search(/([^\\]|^)(\$)/);
    let loc2 = mystring.search(/([^\\]|^)(\$\$)/);
    while (loc >= 0 || loc2 >= 0) {
        if (loc2 >= 0) {
            mystring = mystring.replace(/([^\\]|^)(\$\$)/, count2 % 2 ? '$1\\]' : '$1\\[');
            count2++;
        } else {
            mystring = mystring.replace(/([^\\]|^)(\$)/, count % 2 ? '$1\\)' : '$1\\(');
            count++;
        }
        loc = mystring.search(/([^\\]|^)(\$)/);
        loc2 = mystring.search(/([^\\]|^)(\$\$)/);
    }
    // Replace markdown links
    mystring = mystring.replace(/<http(.*?)>/g, '<a href="http$1" target="_blank" class="Link">http$1</a>');
    mystring = mystring.replace(/\[(.*?)\]\((.*?)\)/g, '<a href="$2" target="_blank" class="Link">$1</a>');
    return mystring;
}

// Base class for question types
class Question {
    static registry = {};
    static register(type, cls) {
        Question.registry[type] = cls;
    }
    static create(qa, id, index, options, rootDiv) {
        const Cls = Question.registry[qa.type];
        if (!Cls) {
            console.error(`No question class registered for type "${qa.type}"`);
            return;
        }
        const q = new Cls(qa, id, index, options, rootDiv);
        q.render();
    }

    constructor(qa, id, index, options, rootDiv) {
        this.qa = qa;
        this.id = id;
        this.index = index;
        this.options = options;
        this.rootDiv = rootDiv;
        // wrapper
        this.wrapper = document.createElement('div');
        this.wrapper.id = `quizWrap${id}`;
        this.wrapper.className = 'Quiz';
        this.wrapper.dataset.qnum = index;
        this.wrapper.style.maxWidth = `${options.maxWidth}px`;
        rootDiv.appendChild(this.wrapper);
        // question container
        this.outerqDiv = document.createElement('div');
        this.outerqDiv.id = `OuterquizQn${id}${index}`;
        this.wrapper.appendChild(this.outerqDiv);
        // question text
        this.qDiv = document.createElement('div');
        this.qDiv.id = `quizQn${id}${index}`;
        if (qa.question) {
            this.qDiv.innerHTML = jaxify(qa.question);
            this.outerqDiv.appendChild(this.qDiv);
        }
        // code block
        if (qa.code) {
            const codeDiv = document.createElement('div');
            codeDiv.id = `code${id}${index}`;
            codeDiv.className = 'QuizCode';
            const pre = document.createElement('pre');
            const codeEl = document.createElement('code');
            codeEl.innerHTML = qa.code;
            pre.appendChild(codeEl);
            codeDiv.appendChild(pre);
            this.outerqDiv.appendChild(codeDiv);
        }
        // answer container
        this.aDiv = document.createElement('div');
        this.aDiv.id = `quizAns${id}${index}`;
        this.aDiv.className = 'Answer';
        this.wrapper.appendChild(this.aDiv);
        // feedback container (append after answers)
        this.fbDiv = document.createElement('div');
        this.fbDiv.id = `fb${id}`;
        this.fbDiv.className = 'Feedback';
        this.fbDiv.dataset.answeredcorrect = 0;
    }

    render() {
        throw new Error('render() not implemented');
    }

    preserveResponse(val) {
        if (!this.options.preserveResponses) return;
        const resp = document.getElementById(`responses${this.rootDiv.id}`);
        if (!resp) return;
        const arr = JSON.parse(resp.dataset.responses);
        arr[this.index] = val;
        resp.dataset.responses = JSON.stringify(arr);
        printResponses(resp);
    }

    typeset(container) {
        if (typeof MathJax !== 'undefined') {
            const v = MathJax.version;
            if (v[0] === '2') {
                MathJax.Hub.Queue(['Typeset', MathJax.Hub]);
            } else {
                MathJax.typeset([container]);
            }
        }
    }
}

// Choose a random subset of an array. Can also be used to shuffle the array
function getRandomSubarray(arr, size) {
    var shuffled = arr.slice(0), i = arr.length, temp, index;
    while (i--) {
        index = Math.floor((i + 1) * Math.random());
        temp = shuffled[index];
        shuffled[index] = shuffled[i];
        shuffled[i] = temp;
    }
    return shuffled.slice(0, size);
}

function printResponses(responsesContainer) {
    var responses=JSON.parse(responsesContainer.dataset.responses);
    var stringResponses='<B>IMPORTANT!</B>To preserve this answer sequence for submission, when you have finalized your answers: <ol> <li> Copy the text in this cell below "Answer String"</li> <li> Double click on the cell directly below the Answer String, labeled "Replace Me"</li> <li> Select the whole "Replace Me" text</li> <li> Paste in your answer string and press shift-Enter.</li><li>Save the notebook using the save icon or File->Save Notebook menu item</li></ul><br><br><br><b>Answer String:</b><br> ';
    console.log(responses);
    responses.forEach((response, index) => {
        if (response) {
            console.log(index + ': ' + response);
            stringResponses+= index + ': ' + response +"<BR>";
        }
    });
    responsesContainer.innerHTML=stringResponses;
}
/* Callback function to determine whether a selected multiple-choice
   button corresponded to a correct answer and to provide feedback
   based on the answer */
function check_mc() {
    var id = this.id.split('-')[0];
    //var response = this.id.split('-')[1];
    //console.log(response);
    //console.log("In check_mc(), id="+id);
    //console.log(event.srcElement.id)           
    //console.log(event.srcElement.dataset.correct)   
    //console.log(event.srcElement.dataset.feedback)

    var label = event.srcElement;
    //console.log(label, label.nodeName);
    var depth = 0;
    while ((label.nodeName != "LABEL") && (depth < 20)) {
        label = label.parentElement;
        console.log(depth, label);
        depth++;
    }



    var answers = label.parentElement.children;
    //console.log(answers);

    // Split behavior based on multiple choice vs many choice:
    var fb = document.getElementById("fb" + id);



    /* Multiple choice (1 answer). Allow for 0 correct
       answers as an edge case */
    if (fb.dataset.numcorrect <= 1) {
        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            //console.log(responsesContainer);
            var response = label.firstChild.innerText;
            if (label.querySelector(".QuizCode")){
                response+= label.querySelector(".QuizCode").firstChild.innerText;
            }
            console.log(response);
            //console.log(document.getElementById("quizWrap"+id));
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            console.log(responses);
            responses[qnum]= response;
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End code to preserve responses

        for (var i = 0; i < answers.length; i++) {
            var child = answers[i];
            //console.log(child);
            child.className = "MCButton";
        }



        if (label.dataset.correct == "true") {
            // console.log("Correct action");
            if ("feedback" in label.dataset) {
                fb.innerHTML = jaxify(label.dataset.feedback);
            } else {
                fb.innerHTML = "Correct!";
            }
            label.classList.add("correctButton");

            fb.className = "Feedback";
            fb.classList.add("correct");

        } else {
            if ("feedback" in label.dataset) {
                fb.innerHTML = jaxify(label.dataset.feedback);
            } else {
                fb.innerHTML = "Incorrect -- try again.";
            }
            //console.log("Error action");
            label.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }
    }
    else { /* Many choice (more than 1 correct answer) */
        var reset = false;
        var feedback;
         if (label.dataset.correct == "true") {
            if ("feedback" in label.dataset) {
                feedback = jaxify(label.dataset.feedback);
            } else {
                feedback = "Correct!";
            }
            if (label.dataset.answered <= 0) {
                if (fb.dataset.answeredcorrect < 0) {
                    fb.dataset.answeredcorrect = 1;
                    reset = true;
                } else {
                    fb.dataset.answeredcorrect++;
                }
                if (reset) {
                    for (var i = 0; i < answers.length; i++) {
                        var child = answers[i];
                        child.className = "MCButton";
                        child.dataset.answered = 0;
                    }
                }
                label.classList.add("correctButton");
                label.dataset.answered = 1;
                fb.className = "Feedback";
                fb.classList.add("correct");

            }
        } else {
            if ("feedback" in label.dataset) {
                feedback = jaxify(label.dataset.feedback);
            } else {
                feedback = "Incorrect -- try again.";
            }
            if (fb.dataset.answeredcorrect > 0) {
                fb.dataset.answeredcorrect = -1;
                reset = true;
            } else {
                fb.dataset.answeredcorrect--;
            }

            if (reset) {
                for (var i = 0; i < answers.length; i++) {
                    var child = answers[i];
                    child.className = "MCButton";
                    child.dataset.answered = 0;
                }
            }
            label.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }
        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            //console.log(responsesContainer);
            var response = label.firstChild.innerText;
            if (label.querySelector(".QuizCode")){
                response+= label.querySelector(".QuizCode").firstChild.innerText;
            }
            console.log(response);
            //console.log(document.getElementById("quizWrap"+id));
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            if (label.dataset.correct == "true") {
                if (typeof(responses[qnum]) == "object"){
                    if (!responses[qnum].includes(response))
                        responses[qnum].push(response);
                } else{
                    responses[qnum]= [ response ];
                }
            } else {
                responses[qnum]= response;
            }
            console.log(responses);
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End save responses stuff



        var numcorrect = fb.dataset.numcorrect;
        var answeredcorrect = fb.dataset.answeredcorrect;
        if (answeredcorrect >= 0) {
            fb.innerHTML = feedback + " [" + answeredcorrect + "/" + numcorrect + "]";
        } else {
            fb.innerHTML = feedback + " [" + 0 + "/" + numcorrect + "]";
        }


    }

    if (typeof MathJax != 'undefined') {
        var version = MathJax.version;
        console.log('MathJax version', version);
        if (version[0] == "2") {
            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        } else if (version[0] == "3") {
            MathJax.typeset([fb]);
        }
    } else {
        console.log('MathJax not detected');
    }

}


/* Function to produce the HTML buttons for a multiple choice/
   many choice question  and to update the CSS tags based on
   the question type */
function make_mc(qa, shuffle_answers, outerqDiv, qDiv, aDiv, id) {

    var shuffled;
    if (shuffle_answers == true) {
        //console.log(shuffle_answers+" read as true");
        shuffled = getRandomSubarray(qa.answers, qa.answers.length);
    } else {
        //console.log(shuffle_answers+" read as false");
        shuffled = qa.answers;
    }


    var num_correct = 0;

    shuffled.forEach((item, index, ans_array) => {
        //console.log(answer);

        // Make input element
        var inp = document.createElement("input");
        inp.type = "radio";
        inp.id = "quizo" + id + index;
        inp.style = "display:none;";
        aDiv.append(inp);

        //Make label for input element
        var lab = document.createElement("label");
        lab.className = "MCButton";
        lab.id = id + '-' + index;
        lab.onclick = check_mc;
        var aSpan = document.createElement('span');
        aSpan.classsName = "";
        //qDiv.id="quizQn"+id+index;
        if ("answer" in item) {
            aSpan.innerHTML = jaxify(item.answer);
            //aSpan.innerHTML=item.answer;
        }
        lab.append(aSpan);

        // Create div for code inside question
        var codeSpan;
        if ("code" in item) {
            codeSpan = document.createElement('span');
            codeSpan.id = "code" + id + index;
            codeSpan.className = "QuizCode";
            var codePre = document.createElement('pre');
            codeSpan.append(codePre);
            var codeCode = document.createElement('code');
            codePre.append(codeCode);
            codeCode.innerHTML = item.code;
            lab.append(codeSpan);
            //console.log(codeSpan);
        }

        //lab.textContent=item.answer;

        // Set the data attributes for the answer
        lab.setAttribute('data-correct', item.correct);
        if (item.correct) {
            num_correct++;
        }
        if ("feedback" in item) {
            lab.setAttribute('data-feedback', item.feedback);
        }
        lab.setAttribute('data-answered', 0);

        aDiv.append(lab);

    });

    if (num_correct > 1) {
        outerqDiv.className = "ManyChoiceQn";
    } else {
        outerqDiv.className = "MultipleChoiceQn";
    }

    return num_correct;

}
// Object-oriented wrapper for MC/MANY choice
class MCQuestion extends Question {
    constructor(qa, id, idx, opts, rootDiv) { super(qa, id, idx, opts, rootDiv); }
    render() {
        //console.log("options.shuffleAnswers " + this.options.shuffleAnswers);
        const numCorrect = make_mc(
            this.qa,
            this.options.shuffleAnswers,
            this.outerqDiv,
            this.qDiv,
            this.aDiv,
            this.id
        );
        if ('answer_cols' in this.qa) {
            this.aDiv.style.gridTemplateColumns =
                'repeat(' + this.qa.answer_cols + ', 1fr)';
        }
        this.fbDiv.dataset.numcorrect = numCorrect;
        this.wrapper.appendChild(this.fbDiv);
    }
}
Question.register('multiple_choice', MCQuestion);
Question.register('many_choice', MCQuestion);
function check_numeric(ths, event) {

    if (event.keyCode === 13) {
        ths.blur();

        var id = ths.id.split('-')[0];

        var submission = ths.value;
        if (submission.indexOf('/') != -1) {
            var sub_parts = submission.split('/');
            //console.log(sub_parts);
            submission = sub_parts[0] / sub_parts[1];
        }
        //console.log("Reader entered", submission);

        if ("precision" in ths.dataset) {
            var precision = ths.dataset.precision;
            submission = Number(Number(submission).toPrecision(precision));
        }


        //console.log("In check_numeric(), id="+id);
        //console.log(event.srcElement.id)           
        //console.log(event.srcElement.dataset.feedback)

        var fb = document.getElementById("fb" + id);
        fb.style.display = "none";
        fb.innerHTML = "Incorrect -- try again.";

        var answers = JSON.parse(ths.dataset.answers);
        //console.log(answers);

        var defaultFB = "Incorrect. Try again.";
        var correct;
        var done = false;
        answers.every(answer => {
            //console.log(answer.type);

            correct = false;
            // if (answer.type=="value"){
            if ('value' in answer) {
                var value;
                if ("precision" in ths.dataset) {
                    value = answer.value.toPrecision(ths.dataset.precision);
                } else {
                    value = answer.value;
                }
                if (submission == value) {
                    if ("feedback" in answer) {
                        fb.innerHTML = jaxify(answer.feedback);
                    } else {
                        fb.innerHTML = jaxify("Correct");
                    }
                    correct = answer.correct;
                    //console.log(answer.correct);
                    done = true;
                }

                // } else if (answer.type=="range") {
            } else if ('range' in answer) {
                console.log(answer.range);
                console.log(submission, submission >=answer.range[0], submission < answer.range[1])
                if ((submission >= answer.range[0]) && (submission < answer.range[1])) {
                    fb.innerHTML = jaxify(answer.feedback);
                    correct = answer.correct;
                    console.log(answer.correct);
                    done = true;
                }
            } else if (answer.type == "default") {
                if ("feedback" in answer) {
                    defaultFB = answer.feedback;
                } 
            }
            if (done) {
                return false; // Break out of loop if this has been marked correct
            } else {
                return true; // Keep looking for case that includes this as a correct answer
            }
        });
        console.log("done:", done);

        if ((!done) && (defaultFB != "")) {
            fb.innerHTML = jaxify(defaultFB);
            //console.log("Default feedback", defaultFB);
        }

        fb.style.display = "block";
        if (correct) {
            ths.className = "Input-text";
            ths.classList.add("correctButton");
            fb.className = "Feedback";
            fb.classList.add("correct");
        } else {
            ths.className = "Input-text";
            ths.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }

        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            console.log(submission);
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            //console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            console.log(responses);
            if (submission == ths.value){
                responses[qnum]= submission;
            } else {
                responses[qnum]= ths.value + "(" + submission +")";
            }
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End code to preserve responses

        if (typeof MathJax != 'undefined') {
            var version = MathJax.version;
            console.log('MathJax version', version);
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([fb]);
            }
        } else {
            console.log('MathJax not detected');
        }
        // After correct answer, if next JupyterQuiz question exists and has a text input, scroll by current question height
        if (correct) {
            // find the current question wrapper
            var wrapper = ths.closest('.Quiz');
            if (wrapper) {
                var nextWrapper = wrapper.nextElementSibling;
                if (nextWrapper && nextWrapper.classList.contains('Quiz')) {
                    var nextInput = nextWrapper.querySelector('input.Input-text');
                    if (nextInput) {
                        var height = wrapper.getBoundingClientRect().height;
                        console.log(height);
                        nextInput.focus();
                    }
                }
            }
        }
        return false;
    }

}
// Object-oriented wrapper for numeric questions
class NumericQuestion extends Question {
    constructor(qa, id, idx, opts, rootDiv) {
        super(qa, id, idx, opts, rootDiv);
    }
    render() {
        make_numeric(this.qa, this.outerqDiv, this.qDiv, this.aDiv, this.id);
        this.wrapper.appendChild(this.fbDiv);
    }
}
Question.register('numeric', NumericQuestion);

function isValid(el, charC) {
    //console.log("Input char: ", charC);
    if (charC == 46) {
        if (el.value.indexOf('.') === -1) {
            return true;
        } else if (el.value.indexOf('/') != -1) {
            var parts = el.value.split('/');
            if (parts[1].indexOf('.') === -1) {
                return true;
            }
        }
        else {
            return false;
        }
    } else if (charC == 47) {
        if (el.value.indexOf('/') === -1) {
            if ((el.value != "") && (el.value != ".")) {
                return true;
            } else {
                return false;
            }
        } else {
            return false;
        }
    } else if (charC == 45) {
        var edex = el.value.indexOf('e');
        if (edex == -1) {
            edex = el.value.indexOf('E');
        }

        if (el.value == "") {
            return true;
        } else if (edex == (el.value.length - 1)) { // If just after e or E
            return true;
        } else {
            return false;
        }
    } else if (charC == 101) { // "e"
        if ((el.value.indexOf('e') === -1) && (el.value.indexOf('E') === -1) && (el.value.indexOf('/') == -1)) {
            // Prev symbol must be digit or decimal point:
            if (el.value.slice(-1).search(/\d/) >= 0) {
                return true;
            } else if (el.value.slice(-1).search(/\./) >= 0) {
                return true;
            } else {
                return false;
            }
        } else {
            return false;
        }
    } else {
        if (charC > 31 && (charC < 48 || charC > 57))
            return false;
    }
    return true;
}

function numeric_keypress(evnt) {
    var charC = (evnt.which) ? evnt.which : evnt.keyCode;

    if (charC == 13) {
        check_numeric(this, evnt);
    } else {
        return isValid(this, charC);
    }
}





function make_numeric(qa, outerqDiv, qDiv, aDiv, id) {



    //console.log(answer);


    outerqDiv.className = "NumericQn";
    aDiv.style.display = 'block';

    var lab = document.createElement("label");
    lab.className = "InpLabel";
    lab.innerHTML = "Type numeric answer here:";
    aDiv.append(lab);

    var inp = document.createElement("input");
    inp.type = "text";
    //inp.id="input-"+id;
    inp.id = id + "-0";
    inp.className = "Input-text";
    inp.setAttribute('data-answers', JSON.stringify(qa.answers));
    if ("precision" in qa) {
        inp.setAttribute('data-precision', qa.precision);
    }
    aDiv.append(inp);
    //console.log(inp);

    //inp.addEventListener("keypress", check_numeric);
    //inp.addEventListener("keypress", numeric_keypress);
    /*
    inp.addEventListener("keypress", function(event) {
        return numeric_keypress(this, event);
    }
                        );
                        */
    //inp.onkeypress="return numeric_keypress(this, event)";
    inp.onkeypress = numeric_keypress;
    inp.onpaste = event => false;

    inp.addEventListener("focus", function (event) {
        this.value = "";
        return false;
    }
    );


}
// Override show_questions to use object-oriented Question API
function show_questions(json, container) {
    // Accept container element or element ID
    if (typeof container === 'string') {
        container = document.getElementById(container);
    }
    if (!container) {
        console.error('show_questions: invalid container', container);
        return;
    }

    const shuffleQuestions = container.dataset.shufflequestions === 'True';
    const shuffleAnswers = container.dataset.shuffleanswers === 'True';
    const preserveResponses = container.dataset.preserveresponses === 'true';
    const maxWidth = parseInt(container.dataset.maxwidth, 10) || 0;
    let numQuestions = parseInt(container.dataset.numquestions, 10) || json.length;
    if (numQuestions > json.length) numQuestions = json.length;

    let questions = json;
    if (shuffleQuestions || numQuestions < json.length) {
        questions = getRandomSubarray(json, numQuestions);
    }

    questions.forEach((qa, index) => {
        const id = makeid(8);
        const options = {
            shuffleAnswers: shuffleAnswers,
            preserveResponses: preserveResponses,
            maxWidth: maxWidth
        };
        Question.create(qa, id, index, options, container);
    });

    if (preserveResponses) {
        const respDiv = document.createElement('div');
        respDiv.id = 'responses' + container.id;
        respDiv.className = 'JCResponses';
        respDiv.dataset.responses = JSON.stringify([]);
        respDiv.innerHTML = '<b>Select your answers and then follow the directions that will appear here.</b>';
        container.appendChild(respDiv);
    }

    // Trigger MathJax typesetting if available
    if (typeof MathJax != 'undefined') {
        console.log("MathJax version", MathJax.version);
        var version = MathJax.version;
        setTimeout(function(){
            var version = MathJax.version;
            console.log('After sleep, MathJax version', version);
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                if (MathJax.hasOwnProperty('typeset') ) {
                    MathJax.typeset([container]);
                } else {
                    console.log('WARNING: Trying to force load MathJax 3');
                    window.MathJax = {
                        tex: {
                            inlineMath: [['$', '$'], ['\\(', '\\)']]
                        },
                        svg: {
                            fontCache: 'global'
                        }
                    };

                    (function () {
                        var script = document.createElement('script');
                        script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js';
                        script.async = true;
                        document.head.appendChild(script);
                    })();
                }
            }
        }, 500);
if (typeof version == 'undefined') {
        } else
        {
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                if (MathJax.hasOwnProperty('typeset') ) {
                    MathJax.typeset([container]);
                } else {
                    console.log('WARNING: Trying to force load MathJax 3');
                    window.MathJax = {
                        tex: {
                            inlineMath: [['$', '$'], ['\\(', '\\)']]
                        },
                        svg: {
                            fontCache: 'global'
                        }
                    };

                    (function () {
                        var script = document.createElement('script');
                        script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js';
                        script.async = true;
                        document.head.appendChild(script);
                    })();
                }
            } else {
                console.log("MathJax not found");
            }
        }
    }
    // if (typeof MathJax !== 'undefined') {
    //     const v = MathJax.version;
    //     if (v[0] === '2') {
    //         MathJax.Hub.Queue(['Typeset', MathJax.Hub]);
    //     } else if (v[0] === '3') {
    //         MathJax.typeset([container]);
    //     }
    // }

    // Prevent link clicks from bubbling up
    Array.from(container.getElementsByClassName('Link')).forEach(link => {
        link.addEventListener('click', e => e.stopPropagation());
    });
}
function levenshteinDistance(a, b) {
    if (a.length === 0) return b.length;
    if (b.length === 0) return a.length;

    const matrix = Array(b.length + 1).fill(null).map(() => Array(a.length + 1).fill(null));

    for (let i = 0; i <= a.length; i++) {
        matrix[0][i] = i;
    }

    for (let j = 0; j <= b.length; j++) {
        matrix[j][0] = j;
    }

    for (let j = 1; j <= b.length; j++) {
        for (let i = 1; i <= a.length; i++) {
            const cost = a[i - 1] === b[j - 1] ? 0 : 1;
            matrix[j][i] = Math.min(
                matrix[j - 1][i] + 1, // Deletion
                matrix[j][i - 1] + 1, // Insertion
                matrix[j - 1][i - 1] + cost // Substitution
            );
        }
    }
    return matrix[b.length][a.length];
}
// Object-oriented wrapper for string input questions
class StringQuestion extends Question {
    constructor(qa, id, idx, opts, rootDiv) {
        super(qa, id, idx, opts, rootDiv);
    }
    render() {
        make_string(this.qa, this.outerqDiv, this.qDiv, this.aDiv, this.id);
        this.wrapper.appendChild(this.fbDiv);
    }
}
Question.register('string', StringQuestion);

function check_string(ths, event) {
    if (event.keyCode === 13) {
        ths.blur();

        var id = ths.id.split('-')[0];
        var submission = ths.value.trim();
        var fb = document.getElementById("fb" + id);
        fb.style.display = "none";
        fb.innerHTML = "Incorrect -- try again.";

        var answers = JSON.parse(ths.dataset.answers);
        var defaultFB = "Incorrect. Try again.";
        var correct;
        var done = false;

        // Handle default answer pattern: filter out and capture default feedback
        var filteredAnswers = [];
        answers.forEach(answer => {
            if (answer.type === "default") {
                defaultFB = answer.feedback;
            } else {
                filteredAnswers.push(answer);
            }
        });
        answers = filteredAnswers;

        answers.every(answer => {
            correct = false;

            let match = false;
            if (answer.match_case) {
                match = submission === answer.answer;
            } else {
                match = submission.toLowerCase() === answer.answer.toLowerCase();
            }
            console.log(submission);
            console.log(answer.answer);
            console.log(match);

            if (match) {
                if ("feedback" in answer) {
                    fb.innerHTML = jaxify(answer.feedback);
                } else {
                    fb.innerHTML = jaxify("Correct");
                }
                correct = answer.correct;
                done = true;
            } else if (answer.fuzzy_threshold) {
                var max_length = Math.max(submission.length, answer.answer.length);
                var ratio;
                if (answer.match_case) {
                    ratio = 1- (levenshteinDistance(submission, answer.answer) / max_length);
                } else {
                    ratio = 1- (levenshteinDistance(submission.toLowerCase(),
                                                    answer.answer.toLowerCase()) / max_length);
                }
                if (ratio >= answer.fuzzy_threshold) {
                    if ("feedback" in answer) {
                        fb.innerHTML = jaxify("(Fuzzy) " + answer.feedback);
                    } else {
                        fb.innerHTML = jaxify("Correct");
                    }
                    correct = answer.correct;
                    done = true;
                }

            }

            if (done) {
                return false;
            } else {
                return true;
            }
        });

        if ((!done) && (defaultFB != "")) {
            fb.innerHTML = jaxify(defaultFB);
        }

        fb.style.display = "block";
        if (correct) {
            ths.className = "Input-text";
            ths.classList.add("correctButton");
            fb.className = "Feedback";
            fb.classList.add("correct");
        } else {
            ths.className = "Input-text";
            ths.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }

        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            var qnum = document.getElementById("quizWrap" + id).dataset.qnum;
            var responses = JSON.parse(responsesContainer.dataset.responses);
            responses[qnum] = submission;
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }

        if (typeof MathJax != 'undefined') {
            var version = MathJax.version;
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([fb]);
            }
        } else {
            console.log('MathJax not detected');
        }
        // After correct answer, if next JupyterQuiz question exists and has a text input, scroll by current question height
        if (correct) {
            var wrapper = ths.closest('.Quiz');
            if (wrapper) {
                var nextWrapper = wrapper.nextElementSibling;
                if (nextWrapper && nextWrapper.classList.contains('Quiz')) {
                    var nextInput = nextWrapper.querySelector('input.Input-text');
                    if (nextInput) {
                        var height = wrapper.getBoundingClientRect().height;
                        nextInput.focus();
                    }
                }
            }
        }
        return false;
    }
}

function string_keypress(evnt) {
    var charC = (evnt.which) ? evnt.which : evnt.keyCode;

    if (charC == 13) {
        check_string(this, evnt);
    } 
}


function make_string(qa, outerqDiv, qDiv, aDiv, id) {
    outerqDiv.className = "StringQn";
    aDiv.style.display = 'block';

    var lab = document.createElement("label");
    lab.className = "InpLabel";
    lab.innerHTML = "Type your answer here:";
    aDiv.append(lab);

    var inp = document.createElement("input");
    inp.type = "text";
    inp.id = id + "-0";
    inp.className = "Input-text";
    inp.setAttribute('data-answers', JSON.stringify(qa.answers));
    // Apply optional input width (approx. number of characters, in em units)
    if (qa.input_width != null) {
        inp.style['min-width'] = qa.input_width + 'em';
    }
    aDiv.append(inp);

    inp.onkeypress = string_keypress;
    inp.onpaste = event => false;

    inp.addEventListener("focus", function (event) {
        this.value = "";
        return false;
    });
}
/*
 * Handle asynchrony issues when re-running quizzes in Jupyter notebooks.
 * Ensures show_questions is called after the container div is in the DOM.
 */
function try_show() {
  if (document.getElementById("xbNILjhRfahk")) {
    show_questions(questionsxbNILjhRfahk, xbNILjhRfahk);
  } else {
    setTimeout(try_show, 200);
  }
};
// Invoke immediately
{
  try_show();
}
}

</script>
</div>
</div>
<p>The genealogical tree of this chromosome interval (<code>999629-1000346</code>) reflects the demographic history of the model. The bonobo population (orange) forms its own distinct clade, whereas western (red) and central (green) share a common ancestor and show little signs of admixture. There are three distinct groups from around 40000 generations ago and looking forward in time.</p>
<p>We now draw the tree at the sweep location:</p>
<dl class="exercise">
<dt>
Exercise 3.
</dt>
<dd>
Plot the tree at the bonobo sweep locus (position <code>L / 3</code>).
</dd>
</dl>
<div id="83cc5f2e" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use this cell to plot the tree at position L / 3 (see previous example code block)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The plot clearly shows how samples belonging to the <code>bonobo</code> population (orange) coalesce much faster than other samples. In fact, all samples have coalesced within the last 4000 generations. If we calculate the sum of the branch lengths for the different populations, we see that they are much smaller for bonobo:</p>
<div id="3106d7a5" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>sweep_pos <span class="op">=</span> L <span class="op">/</span> <span class="dv">3</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> pop <span class="kw">in</span> <span class="bu">list</span>(ts.populations())[:<span class="op">-</span><span class="dv">1</span>]:  <span class="co"># Omit ghost population</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># For a subtree consisting of samples in population pop.id at</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># sweep position, get total branch length</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    branch_length <span class="op">=</span> ts.simplify(ts.samples(population<span class="op">=</span>pop.<span class="bu">id</span>)).at(</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>        sweep_pos).total_branch_length</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>pop<span class="sc">.</span>metadata[<span class="st">'name'</span>]<span class="sc">}</span><span class="ss"> total branch length: </span><span class="sc">{</span>branch_length<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>western total branch length: 178735.7176787648
central total branch length: 618502.9193431295
bonobo total branch length: 20450.64999999551</code></pre>
</div>
</div>
<p>With <a href="https://tskit.dev/tskit/docs/stable/python-api.html#tskit.TreeSequence.simplify">ts.simplify</a> we can subset a tree sequence to a list of samples (here corresponding to the samples of each population), and then we, once again, look at the tree at the sweep position and retrieve the total branch length of that tree.</p>
<p>For illustration purposes, we also make a boxplot of branch lengths.</p>
<div id="f240d70b" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> []</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> pop <span class="kw">in</span> <span class="bu">list</span>(ts.populations())[:<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get a subtree at sweep position for samples in pop.id only</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    tstmp <span class="op">=</span> ts.simplify(ts.samples(pop.<span class="bu">id</span>)).at(sweep_pos)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add all branch lengths for the nodes of the subtree</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    x.append([tstmp.branch_length(u) <span class="cf">for</span> u <span class="kw">in</span> tstmp.nodes()])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="850460b2" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [popmd[i][<span class="st">"mpl_color"</span>] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>)]</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'branch length'</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [popmd[i][<span class="st">"name"</span>] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>)]</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>bplot <span class="op">=</span> ax.boxplot(x,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>                   patch_artist<span class="op">=</span><span class="va">True</span>,  <span class="co"># fill with color</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>                   tick_labels<span class="op">=</span>labels)  <span class="co"># will be used to label x-ticks</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> patch, col <span class="kw">in</span> <span class="bu">zip</span>(bplot[<span class="st">'boxes'</span>], colors):</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    patch.set_facecolor(col)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="stdpopsim_lab_II_files/figure-html/cell-25-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="stdpopsim_lab_II_files/figure-html/cell-25-output-1.png" width="610" height="411" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>This hints at a way to design a test for sweeps based on branch lengths being much shorter than the background around the sweep locus.</p>
<p>We can also illustrate what happens to trees as we move away from the sweep locus. The intuition is that as recombination breaks down linkage to the sweep locus, genomic segments further away will evolve neutrally and the coalescence times of the samples will increase, leading to trees with longer terminal branches and larger total branch length.</p>
<div id="a4361e0b" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;slideshow&quot;,&quot;value&quot;:{&quot;slide_type&quot;:&quot;fragment&quot;}}" data-execution_count="25">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>tslist <span class="op">=</span> []</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>delta <span class="op">=</span> <span class="dv">50_000</span>  <span class="co"># Look this distance left and right</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>poslist <span class="op">=</span> np.linspace(sweep_pos <span class="op">-</span> delta, sweep_pos <span class="op">+</span> delta, <span class="dv">7</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>tslist <span class="op">=</span> [ts.simplify(ts.samples(population<span class="op">=</span><span class="dv">2</span>), filter_nodes<span class="op">=</span><span class="va">False</span>).at(pos) <span class="cf">for</span> pos <span class="kw">in</span> poslist]</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>max_time <span class="op">=</span> <span class="dv">15_000</span>  <span class="co"># Find suitable max time to rescale plots</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>ticks <span class="op">=</span> np.linspace(<span class="dv">0</span>, max_time, num<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>ticks <span class="op">=</span> {t: <span class="ss">f"</span><span class="sc">{</span>t<span class="op">/</span><span class="dv">1_000</span><span class="sc">:.0f}</span><span class="ss">k"</span> <span class="cf">for</span> t <span class="kw">in</span> ticks}</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> HTML</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>HTML(<span class="st">""</span>.join(</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    tree.draw_svg(</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>        max_time<span class="op">=</span>max_time,</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>        size<span class="op">=</span>(<span class="dv">200</span>, <span class="dv">350</span>),</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>        node_labels<span class="op">=</span>{},</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>        symbol_size<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>        y_axis<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>        y_ticks<span class="op">=</span>ticks,</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>        x_axis<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>        style<span class="op">=</span>css_string,</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>        mutation_labels<span class="op">=</span>{},</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>        omit_sites<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>        root_svg_attributes<span class="op">=</span>{<span class="st">"style"</span>:<span class="st">"display: inline-block"</span>},</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> tree <span class="kw">in</span> tslist</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<svg baseprofile="full" height="350" style="display: inline-block" version="1.1" width="200" xmlns="http://www.w3.org/2000/svg" xmlns:ev="http://www.w3.org/2001/xml-events" xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css">.background path {fill: #808080; fill-opacity: 0}.background path:nth-child(odd) {fill-opacity: .1}.x-regions rect {fill: yellow; stroke: black; opacity: 0.5}.axes {font-size: 14px}.x-axis .tick .lab {font-weight: bold; dominant-baseline: hanging}.axes, .tree {font-size: 14px; text-anchor: middle}.axes line, .edge {stroke: black; fill: none}.axes .ax-skip {stroke-dasharray: 4}.y-axis .grid {stroke: #FAFAFA}.node > .sym {fill: black; stroke: none}.site > .sym {stroke: black}.mut text {fill: red; font-style: italic}.mut.extra text {fill: hotpink}.mut line {fill: none; stroke: none}.mut .sym {fill: none; stroke: red}.mut.extra .sym {stroke: hotpink}.node .mut .sym {stroke-width: 1.5px}.tree text, .tree-sequence text {dominant-baseline: central}.plotbox .lab.lft {text-anchor: end}.plotbox .lab.rgt {text-anchor: start}.polytomy line {stroke: black; stroke-dasharray: 1px, 1px}.polytomy text {paint-order:stroke;stroke-width:0.3em;stroke:white}.node.p0 > .sym {fill: #d62728} .node.p1 > .sym {fill: #2ca02c} .node.p2 > .sym {fill: #ff7f0e}</style></defs><g class="tree t3445"><g class="axes"><g class="x-axis"><g class="title" transform="translate(118.4 350)"><text class="lab" text-anchor="middle" transform="translate(0 -11)">Genome position</text></g><line class="ax-line" x1="56.8" x2="180" y1="313.2" y2="313.2"></line><g class="ticks"><g class="tick" transform="translate(56.8 313.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">3272765</text></g></g><g class="tick" transform="translate(180 313.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">3285877</text></g></g></g></g><g class="y-axis"><g class="title" transform="translate(0 145.7)"><text class="lab" text-anchor="middle" transform="translate(11) rotate(-90)">Time ago (generations)</text></g><line class="ax-line" x1="56.8" x2="56.8" y1="281.4" y2="10"></line><g class="ticks"><g class="tick" transform="translate(56.8 281.4)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">0k</text></g></g><g class="tick" transform="translate(56.8 230.48)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">3k</text></g></g><g class="tick" transform="translate(56.8 179.56)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">6k</text></g></g><g class="tick" transform="translate(56.8 128.64)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">9k</text></g></g><g class="tick" transform="translate(56.8 77.72)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">12k</text></g></g><g class="tick" transform="translate(56.8 26.8)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">15k</text></g></g></g></g></g><g class="plotbox"><g class="c2 node n13082 p2 root" transform="translate(110.673 -234.056)"><g class="a13082 c2 node n1452 p2" transform="translate(-27.4764 504.525)"><g class="a1452 c2 node n1339 p2" transform="translate(16.1941 0.726459)"><g class="a1339 i57 leaf node n115 p2 sample" transform="translate(5.14937 10.2052)"><path class="edge" d="M 0 0 V -10.2052 H -5.14937"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1339 c2 node n1262 p2" transform="translate(-5.14937 0.583883)"><g class="a1262 c2 node n1233 p2" transform="translate(-7.21875 0.207923)"><g class="a1233 c2 node n1135 p2" transform="translate(-6.3525 0.621224)"><g class="a1135 i51 leaf node n103 p2 sample" transform="translate(2.31 8.79219)"><path class="edge" d="M 0 0 V -8.79219 H -2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1135 c2 node n1104 p2" transform="translate(-2.31 0.167187)"><g class="a1104 i43 leaf node n86 p2 sample" transform="translate(-1.54 8.625)"><path class="edge" d="M 0 0 V -8.625 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1104 i47 leaf node n95 p2 sample" transform="translate(1.54 8.625)"><path class="edge" d="M 0 0 V -8.625 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.167187 H 2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.621224 H 6.3525"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1233 c2 node n1164 p2" transform="translate(6.3525 0.450642)"><g class="a1164 c2 node n989 p2" transform="translate(3.465 0.975118)"><g class="a989 i51 leaf node n102 p2 sample" transform="translate(1.54 7.98765)"><path class="edge" d="M 0 0 V -7.98765 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a989 i48 leaf node n97 p2 sample" transform="translate(-1.54 7.98765)"><path class="edge" d="M 0 0 V -7.98765 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.975118 H -3.465"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1164 c2 node n1145 p2" transform="translate(-3.465 0.0975967)"><g class="a1145 i59 leaf node n119 p2 sample" transform="translate(2.31 8.86517)"><path class="edge" d="M 0 0 V -8.86517 H -2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1145 c2 node n1038 p2" transform="translate(-2.31 0.615283)"><g class="a1038 i46 leaf node n92 p2 sample" transform="translate(-1.54 8.24989)"><path class="edge" d="M 0 0 V -8.24989 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1038 i56 leaf node n112 p2 sample" transform="translate(1.54 8.24989)"><path class="edge" d="M 0 0 V -8.24989 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.615283 H 2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.0975967 H 3.465"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.450642 H -6.3525"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.207923 H 7.21875"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1262 i50 leaf node n100 p2 sample" transform="translate(7.21875 9.62133)"><path class="edge" d="M 0 0 V -9.62133 H -7.21875"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.583883 H 5.14937"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.726459 H -16.1941"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1452 c2 node n1302 p2" transform="translate(-16.1941 0.99294)"><g class="a1302 c2 node n1184 p2" transform="translate(5.1975 0.799444)"><g class="a1184 i44 leaf node n89 p2 sample" transform="translate(1.54 9.13929)"><path class="edge" d="M 0 0 V -9.13929 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1184 i42 leaf node n85 p2 sample" transform="translate(-1.54 9.13929)"><path class="edge" d="M 0 0 V -9.13929 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.799444 H -5.1975"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1302 c2 node n1197 p2" transform="translate(-5.1975 0.727307)"><g class="a1197 i40 leaf node n80 p2 sample" transform="translate(-3.465 9.21143)"><path class="edge" d="M 0 0 V -9.21143 H 3.465"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1197 c2 node n977 p2" transform="translate(3.465 1.34174)"><g class="a977 i58 leaf node n116 p2 sample" transform="translate(2.31 7.86969)"><path class="edge" d="M 0 0 V -7.86969 H -2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a977 c2 node n180 p2" transform="translate(-2.31 6.29796)"><g class="a180 i42 leaf node n84 p2 sample" transform="translate(-1.54 1.57173)"><path class="edge" d="M 0 0 V -1.57173 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a180 i54 leaf node n108 p2 sample" transform="translate(1.54 1.57173)"><path class="edge" d="M 0 0 V -1.57173 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -6.29796 H 2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.34174 H -3.465"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.727307 H 5.1975"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.99294 H 16.1941"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -504.525 H 27.4764"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a13082 c2 node n12691 p2" transform="translate(27.4764 431.081)"><g class="a12691 c2 node n1605 p2" transform="translate(23.9843 72.2432)"><g class="a1605 c2 node n1523 p2" transform="translate(-14.7864 0.627165)"><g class="a1523 c2 node n1442 p2" transform="translate(-14.3172 0.633105)"><g class="a1442 c2 node n1436 p2" transform="translate(7.7 0.0424333)"><g class="a1436 i54 leaf node n109 p2 sample" transform="translate(3.85 10.829)"><path class="edge" d="M 0 0 V -10.829 H -3.85"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1436 c2 node n1301 p2" transform="translate(-3.85 0.918257)"><g class="a1301 c2 node n131 p2" transform="translate(-3.08 9.17748)"><g class="a131 i49 leaf node n99 p2 sample" transform="translate(-1.54 0.733248)"><path class="edge" d="M 0 0 V -0.733248 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a131 i58 leaf node n117 p2 sample" transform="translate(1.54 0.733248)"><path class="edge" d="M 0 0 V -0.733248 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -9.17748 H 3.08"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1301 c2 node n1225 p2" transform="translate(3.08 0.527871)"><g class="a1225 i53 leaf node n107 p2 sample" transform="translate(-1.54 9.38286)"><path class="edge" d="M 0 0 V -9.38286 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1225 i55 leaf node n111 p2 sample" transform="translate(1.54 9.38286)"><path class="edge" d="M 0 0 V -9.38286 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.527871 H -3.08"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.918257 H 3.85"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.0424333 H -7.7"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1442 c2 node n1272 p2" transform="translate(-7.7 1.15843)"><g class="a1272 i43 leaf node n87 p2 sample" transform="translate(-2.31 9.71299)"><path class="edge" d="M 0 0 V -9.71299 H 2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1272 c2 node n1048 p2" transform="translate(2.31 1.41473)"><g class="a1048 i47 leaf node n94 p2 sample" transform="translate(-1.54 8.29826)"><path class="edge" d="M 0 0 V -8.29826 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1048 i57 leaf node n114 p2 sample" transform="translate(1.54 8.29826)"><path class="edge" d="M 0 0 V -8.29826 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -1.41473 H -2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.15843 H 7.7"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.633105 H 14.3172"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1523 c2 node n1267 p2" transform="translate(14.3172 1.83057)"><g class="a1267 c2 node n868 p2" transform="translate(9.09562 2.52393)"><g class="a868 i45 leaf node n91 p2 sample" transform="translate(-1.54 7.15002)"><path class="edge" d="M 0 0 V -7.15002 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a868 i55 leaf node n110 p2 sample" transform="translate(1.54 7.15002)"><path class="edge" d="M 0 0 V -7.15002 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -2.52393 H -9.09562"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1267 c2 node n1220 p2" transform="translate(-9.09563 0.312309)"><g class="a1220 i44 leaf node n88 p2 sample" transform="translate(-4.90875 9.36164)"><path class="edge" d="M 0 0 V -9.36164 H 4.90875"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1220 c2 node n1195 p2" transform="translate(4.90875 0.151063)"><g class="a1195 c2 node n1160 p2" transform="translate(5.1975 0.269876)"><g class="a1160 i52 leaf node n104 p2 sample" transform="translate(3.465 8.9407)"><path class="edge" d="M 0 0 V -8.9407 H -3.465"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1160 c2 node n1146 p2" transform="translate(-3.465 0.071288)"><g class="a1146 i46 leaf node n93 p2 sample" transform="translate(-2.31 8.86942)"><path class="edge" d="M 0 0 V -8.86942 H 2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1146 c2 node n920 p2" transform="translate(2.31 1.43764)"><g class="a920 i52 leaf node n105 p2 sample" transform="translate(-1.54 7.43177)"><path class="edge" d="M 0 0 V -7.43177 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a920 i56 leaf node n113 p2 sample" transform="translate(1.54 7.43177)"><path class="edge" d="M 0 0 V -7.43177 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -1.43764 H -2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.071288 H 3.465"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.269876 H -5.1975"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1195 c2 node n943 p2" transform="translate(-5.1975 1.59295)"><g class="a943 i45 leaf node n90 p2 sample" transform="translate(-1.54 7.61763)"><path class="edge" d="M 0 0 V -7.61763 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a943 i50 leaf node n101 p2 sample" transform="translate(1.54 7.61763)"><path class="edge" d="M 0 0 V -7.61763 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -1.59295 H 5.1975"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.151063 H -4.90875"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.312309 H 9.09563"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.83057 H -14.3172"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.627165 H 14.7864"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1605 c2 node n825 p2" transform="translate(14.7864 5.27701)"><g class="a825 i49 leaf node n98 p2 sample" transform="translate(-1.54 6.85468)"><path class="edge" d="M 0 0 V -6.85468 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a825 i59 leaf node n118 p2 sample" transform="translate(1.54 6.85468)"><path class="edge" d="M 0 0 V -6.85468 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -5.27701 H -14.7864"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -72.2432 H -23.9843"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a12691 c2 node n12674 p2" transform="translate(-23.9843 1.08202)"><g class="a12674 c2 node n628 p2" transform="translate(4.235 77.9811)"><g class="a628 i41 leaf node n83 p2 sample" transform="translate(-1.54 5.3118)"><path class="edge" d="M 0 0 V -5.3118 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a628 i48 leaf node n96 p2 sample" transform="translate(1.54 5.3118)"><path class="edge" d="M 0 0 V -5.3118 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -77.9811 H -4.235"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a12674 c2 node n1082 p2" transform="translate(-4.235 74.8436)"><g class="a1082 i40 leaf node n81 p2 sample" transform="translate(-2.31 8.44933)"><path class="edge" d="M 0 0 V -8.44933 H 2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1082 c2 node n664 p2" transform="translate(2.31 2.85067)"><g class="a664 i41 leaf node n82 p2 sample" transform="translate(-1.54 5.59865)"><path class="edge" d="M 0 0 V -5.59865 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a664 i53 leaf node n106 p2 sample" transform="translate(1.54 5.59865)"><path class="edge" d="M 0 0 V -5.59865 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -2.85067 H -2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -74.8436 H 4.235"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.08202 H 23.9843"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -431.081 H -27.4764"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab" transform="translate(0 -13.5)"></text></g></g></g></svg><svg baseprofile="full" height="350" style="display: inline-block" version="1.1" width="200" xmlns="http://www.w3.org/2000/svg" xmlns:ev="http://www.w3.org/2001/xml-events" xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css">.background path {fill: #808080; fill-opacity: 0}.background path:nth-child(odd) {fill-opacity: .1}.x-regions rect {fill: yellow; stroke: black; opacity: 0.5}.axes {font-size: 14px}.x-axis .tick .lab {font-weight: bold; dominant-baseline: hanging}.axes, .tree {font-size: 14px; text-anchor: middle}.axes line, .edge {stroke: black; fill: none}.axes .ax-skip {stroke-dasharray: 4}.y-axis .grid {stroke: #FAFAFA}.node > .sym {fill: black; stroke: none}.site > .sym {stroke: black}.mut text {fill: red; font-style: italic}.mut.extra text {fill: hotpink}.mut line {fill: none; stroke: none}.mut .sym {fill: none; stroke: red}.mut.extra .sym {stroke: hotpink}.node .mut .sym {stroke-width: 1.5px}.tree text, .tree-sequence text {dominant-baseline: central}.plotbox .lab.lft {text-anchor: end}.plotbox .lab.rgt {text-anchor: start}.polytomy line {stroke: black; stroke-dasharray: 1px, 1px}.polytomy text {paint-order:stroke;stroke-width:0.3em;stroke:white}.node.p0 > .sym {fill: #d62728} .node.p1 > .sym {fill: #2ca02c} .node.p2 > .sym {fill: #ff7f0e}</style></defs><g class="tree t3452"><g class="axes"><g class="x-axis"><g class="title" transform="translate(118.4 350)"><text class="lab" text-anchor="middle" transform="translate(0 -11)">Genome position</text></g><line class="ax-line" x1="56.8" x2="180" y1="313.2" y2="313.2"></line><g class="ticks"><g class="tick" transform="translate(56.8 313.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">3295191</text></g></g><g class="tick" transform="translate(180 313.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">3301705</text></g></g></g></g><g class="y-axis"><g class="title" transform="translate(0 145.7)"><text class="lab" text-anchor="middle" transform="translate(11) rotate(-90)">Time ago (generations)</text></g><line class="ax-line" x1="56.8" x2="56.8" y1="281.4" y2="10"></line><g class="ticks"><g class="tick" transform="translate(56.8 281.4)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">0k</text></g></g><g class="tick" transform="translate(56.8 230.48)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">3k</text></g></g><g class="tick" transform="translate(56.8 179.56)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">6k</text></g></g><g class="tick" transform="translate(56.8 128.64)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">9k</text></g></g><g class="tick" transform="translate(56.8 77.72)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">12k</text></g></g><g class="tick" transform="translate(56.8 26.8)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">15k</text></g></g></g></g></g><g class="plotbox"><g class="c2 node n13082 p2 root" transform="translate(117.75 -234.056)"><g class="a13082 c2 node n12994 p2" transform="translate(21.5901 364.107)"><g class="a12994 c2 node n664 p2" transform="translate(-24.0204 145.751)"><g class="a664 i41 leaf node n82 p2 sample" transform="translate(-1.54 5.59865)"><path class="edge" d="M 0 0 V -5.59865 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a664 i53 leaf node n106 p2 sample" transform="translate(1.54 5.59865)"><path class="edge" d="M 0 0 V -5.59865 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -145.751 H 24.0204"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a12994 c2 node n1605 p2" transform="translate(24.0204 139.218)"><g class="a1605 c2 node n1523 p2" transform="translate(-15.0992 0.627165)"><g class="a1523 c2 node n1442 p2" transform="translate(-16.4828 0.633105)"><g class="a1442 c2 node n1436 p2" transform="translate(-5.29375 0.0424333)"><g class="a1436 i54 leaf node n109 p2 sample" transform="translate(2.695 10.829)"><path class="edge" d="M 0 0 V -10.829 H -2.695"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1436 c2 node n1225 p2" transform="translate(-2.695 1.44613)"><g class="a1225 i53 leaf node n107 p2 sample" transform="translate(2.31 9.38286)"><path class="edge" d="M 0 0 V -9.38286 H -2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1225 c2 node n758 p2" transform="translate(-2.31 2.96185)"><g class="a758 i42 leaf node n85 p2 sample" transform="translate(-1.54 6.42101)"><path class="edge" d="M 0 0 V -6.42101 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a758 i55 leaf node n111 p2 sample" transform="translate(1.54 6.42101)"><path class="edge" d="M 0 0 V -6.42101 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -2.96185 H 2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.44613 H 2.695"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.0424333 H 5.29375"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1442 c2 node n1272 p2" transform="translate(5.29375 1.15843)"><g class="a1272 i43 leaf node n87 p2 sample" transform="translate(-4.8125 9.71299)"><path class="edge" d="M 0 0 V -9.71299 H 4.8125"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1272 c2 node n1048 p2" transform="translate(4.8125 1.41473)"><g class="a1048 c2 node n1001 p2" transform="translate(4.235 0.245265)"><g class="a1001 i49 leaf node n98 p2 sample" transform="translate(-1.54 8.053)"><path class="edge" d="M 0 0 V -8.053 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1001 i57 leaf node n114 p2 sample" transform="translate(1.54 8.053)"><path class="edge" d="M 0 0 V -8.053 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.245265 H -4.235"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1048 c2 node n948 p2" transform="translate(-4.235 0.664506)"><g class="a948 i47 leaf node n94 p2 sample" transform="translate(-2.31 7.63376)"><path class="edge" d="M 0 0 V -7.63376 H 2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a948 c2 node n131 p2" transform="translate(2.31 6.90051)"><g class="a131 i49 leaf node n99 p2 sample" transform="translate(-1.54 0.733248)"><path class="edge" d="M 0 0 V -0.733248 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a131 i58 leaf node n117 p2 sample" transform="translate(1.54 0.733248)"><path class="edge" d="M 0 0 V -0.733248 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -6.90051 H -2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.664506 H 4.235"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.41473 H -4.8125"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.15843 H -5.29375"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.633105 H 16.4828"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1523 c2 node n1267 p2" transform="translate(16.4828 1.83057)"><g class="a1267 c2 node n868 p2" transform="translate(9.09563 2.52393)"><g class="a868 i45 leaf node n91 p2 sample" transform="translate(-1.54 7.15002)"><path class="edge" d="M 0 0 V -7.15002 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a868 i55 leaf node n110 p2 sample" transform="translate(1.54 7.15002)"><path class="edge" d="M 0 0 V -7.15002 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -2.52393 H -9.09563"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1267 c2 node n1220 p2" transform="translate(-9.09562 0.312309)"><g class="a1220 i44 leaf node n88 p2 sample" transform="translate(-4.90875 9.36164)"><path class="edge" d="M 0 0 V -9.36164 H 4.90875"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1220 c2 node n1195 p2" transform="translate(4.90875 0.151063)"><g class="a1195 c2 node n1160 p2" transform="translate(5.1975 0.269876)"><g class="a1160 i52 leaf node n104 p2 sample" transform="translate(3.465 8.9407)"><path class="edge" d="M 0 0 V -8.9407 H -3.465"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1160 c2 node n1146 p2" transform="translate(-3.465 0.071288)"><g class="a1146 i46 leaf node n93 p2 sample" transform="translate(-2.31 8.86942)"><path class="edge" d="M 0 0 V -8.86942 H 2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1146 c2 node n920 p2" transform="translate(2.31 1.43764)"><g class="a920 i52 leaf node n105 p2 sample" transform="translate(-1.54 7.43177)"><path class="edge" d="M 0 0 V -7.43177 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a920 i56 leaf node n113 p2 sample" transform="translate(1.54 7.43177)"><path class="edge" d="M 0 0 V -7.43177 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -1.43764 H -2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.071288 H 3.465"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.269876 H -5.1975"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1195 c2 node n943 p2" transform="translate(-5.1975 1.59295)"><g class="a943 i45 leaf node n90 p2 sample" transform="translate(-1.54 7.61763)"><path class="edge" d="M 0 0 V -7.61763 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a943 i50 leaf node n101 p2 sample" transform="translate(1.54 7.61763)"><path class="edge" d="M 0 0 V -7.61763 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -1.59295 H 5.1975"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.151063 H -4.90875"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.312309 H 9.09562"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.83057 H -16.4828"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.627165 H 15.0992"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1605 i59 leaf node n118 p2 sample" transform="translate(15.0992 12.1317)"><path class="edge" d="M 0 0 V -12.1317 H -15.0992"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -139.218 H -24.0204"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -364.107 H -21.5901"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a13082 c2 node n13038 p2" transform="translate(-21.5901 297.667)"><g class="a13038 c2 node n628 p2" transform="translate(12.9998 212.477)"><g class="a628 i41 leaf node n83 p2 sample" transform="translate(-1.54 5.3118)"><path class="edge" d="M 0 0 V -5.3118 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a628 i48 leaf node n96 p2 sample" transform="translate(1.54 5.3118)"><path class="edge" d="M 0 0 V -5.3118 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -212.477 H -12.9998"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a13038 c2 node n1452 p2" transform="translate(-12.9998 206.857)"><g class="a1452 c2 node n1339 p2" transform="translate(16.928 0.726459)"><g class="a1339 i57 leaf node n115 p2 sample" transform="translate(4.45156 10.2052)"><path class="edge" d="M 0 0 V -10.2052 H -4.45156"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1339 c2 node n1262 p2" transform="translate(-4.45156 0.583883)"><g class="a1262 c2 node n1233 p2" transform="translate(-5.82313 0.207923)"><g class="a1233 c2 node n1135 p2" transform="translate(6.25625 0.621224)"><g class="a1135 i51 leaf node n103 p2 sample" transform="translate(2.31 8.79219)"><path class="edge" d="M 0 0 V -8.79219 H -2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1135 c2 node n1104 p2" transform="translate(-2.31 0.167187)"><g class="a1104 i43 leaf node n86 p2 sample" transform="translate(-1.54 8.625)"><path class="edge" d="M 0 0 V -8.625 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1104 i47 leaf node n95 p2 sample" transform="translate(1.54 8.625)"><path class="edge" d="M 0 0 V -8.625 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.167187 H 2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.621224 H -6.25625"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1233 c2 node n1164 p2" transform="translate(-6.25625 0.450642)"><g class="a1164 c2 node n989 p2" transform="translate(4.0425 0.975118)"><g class="a989 i51 leaf node n102 p2 sample" transform="translate(1.54 7.98765)"><path class="edge" d="M 0 0 V -7.98765 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a989 i48 leaf node n97 p2 sample" transform="translate(-1.54 7.98765)"><path class="edge" d="M 0 0 V -7.98765 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.975118 H -4.0425"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1164 c2 node n1145 p2" transform="translate(-4.0425 0.0975967)"><g class="a1145 i59 leaf node n119 p2 sample" transform="translate(3.465 8.86517)"><path class="edge" d="M 0 0 V -8.86517 H -3.465"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1145 c2 node n1085 p2" transform="translate(-3.465 0.398873)"><g class="a1085 i40 leaf node n81 p2 sample" transform="translate(-2.31 8.4663)"><path class="edge" d="M 0 0 V -8.4663 H 2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1085 c2 node n1038 p2" transform="translate(2.31 0.21641)"><g class="a1038 i46 leaf node n92 p2 sample" transform="translate(-1.54 8.24989)"><path class="edge" d="M 0 0 V -8.24989 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1038 i56 leaf node n112 p2 sample" transform="translate(1.54 8.24989)"><path class="edge" d="M 0 0 V -8.24989 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.21641 H -2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.398873 H 3.465"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.0975967 H 4.0425"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.450642 H 6.25625"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.207923 H 5.82313"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1262 i50 leaf node n100 p2 sample" transform="translate(5.82313 9.62133)"><path class="edge" d="M 0 0 V -9.62133 H -5.82313"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.583883 H 4.45156"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.726459 H -16.928"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1452 c2 node n1302 p2" transform="translate(-16.928 0.99294)"><g class="a1302 c2 node n1197 p2" transform="translate(-4.4275 0.727307)"><g class="a1197 i40 leaf node n80 p2 sample" transform="translate(-3.465 9.21143)"><path class="edge" d="M 0 0 V -9.21143 H 3.465"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1197 c2 node n977 p2" transform="translate(3.465 1.34174)"><g class="a977 i58 leaf node n116 p2 sample" transform="translate(2.31 7.86969)"><path class="edge" d="M 0 0 V -7.86969 H -2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a977 c2 node n180 p2" transform="translate(-2.31 6.29796)"><g class="a180 i42 leaf node n84 p2 sample" transform="translate(-1.54 1.57173)"><path class="edge" d="M 0 0 V -1.57173 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a180 i54 leaf node n108 p2 sample" transform="translate(1.54 1.57173)"><path class="edge" d="M 0 0 V -1.57173 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -6.29796 H 2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.34174 H -3.465"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.727307 H 4.4275"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1302 i44 leaf node n89 p2 sample" transform="translate(4.4275 9.93874)"><path class="edge" d="M 0 0 V -9.93874 H -4.4275"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.99294 H 16.928"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -206.857 H 12.9998"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -297.667 H 21.5901"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab" transform="translate(0 -13.5)"></text></g></g></g></svg><svg baseprofile="full" height="350" style="display: inline-block" version="1.1" width="200" xmlns="http://www.w3.org/2000/svg" xmlns:ev="http://www.w3.org/2001/xml-events" xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css">.background path {fill: #808080; fill-opacity: 0}.background path:nth-child(odd) {fill-opacity: .1}.x-regions rect {fill: yellow; stroke: black; opacity: 0.5}.axes {font-size: 14px}.x-axis .tick .lab {font-weight: bold; dominant-baseline: hanging}.axes, .tree {font-size: 14px; text-anchor: middle}.axes line, .edge {stroke: black; fill: none}.axes .ax-skip {stroke-dasharray: 4}.y-axis .grid {stroke: #FAFAFA}.node > .sym {fill: black; stroke: none}.site > .sym {stroke: black}.mut text {fill: red; font-style: italic}.mut.extra text {fill: hotpink}.mut line {fill: none; stroke: none}.mut .sym {fill: none; stroke: red}.mut.extra .sym {stroke: hotpink}.node .mut .sym {stroke-width: 1.5px}.tree text, .tree-sequence text {dominant-baseline: central}.plotbox .lab.lft {text-anchor: end}.plotbox .lab.rgt {text-anchor: start}.polytomy line {stroke: black; stroke-dasharray: 1px, 1px}.polytomy text {paint-order:stroke;stroke-width:0.3em;stroke:white}.node.p0 > .sym {fill: #d62728} .node.p1 > .sym {fill: #2ca02c} .node.p2 > .sym {fill: #ff7f0e}</style></defs><g class="tree t3458"><g class="axes"><g class="x-axis"><g class="title" transform="translate(118.4 350)"><text class="lab" text-anchor="middle" transform="translate(0 -11)">Genome position</text></g><line class="ax-line" x1="56.8" x2="180" y1="313.2" y2="313.2"></line><g class="ticks"><g class="tick" transform="translate(56.8 313.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">3316233</text></g></g><g class="tick" transform="translate(180 313.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">3317067</text></g></g></g></g><g class="y-axis"><g class="title" transform="translate(0 145.7)"><text class="lab" text-anchor="middle" transform="translate(11) rotate(-90)">Time ago (generations)</text></g><line class="ax-line" x1="56.8" x2="56.8" y1="281.4" y2="10"></line><g class="ticks"><g class="tick" transform="translate(56.8 281.4)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">0k</text></g></g><g class="tick" transform="translate(56.8 230.48)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">3k</text></g></g><g class="tick" transform="translate(56.8 179.56)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">6k</text></g></g><g class="tick" transform="translate(56.8 128.64)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">9k</text></g></g><g class="tick" transform="translate(56.8 77.72)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">12k</text></g></g><g class="tick" transform="translate(56.8 26.8)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">15k</text></g></g></g></g></g><g class="plotbox"><g class="c2 node n13063 p2 root" transform="translate(128.966 -4.0527)"><g class="a13063 c2 node n1605 p2" transform="translate(34.3943 273.321)"><g class="a1605 c2 node n1523 p2" transform="translate(-15.0992 0.627165)"><g class="a1523 c2 node n1442 p2" transform="translate(-16.4828 0.633105)"><g class="a1442 c2 node n1436 p2" transform="translate(-5.29375 0.0424333)"><g class="a1436 i54 leaf node n109 p2 sample" transform="translate(2.695 10.829)"><path class="edge" d="M 0 0 V -10.829 H -2.695"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1436 c2 node n1225 p2" transform="translate(-2.695 1.44613)"><g class="a1225 i53 leaf node n107 p2 sample" transform="translate(2.31 9.38286)"><path class="edge" d="M 0 0 V -9.38286 H -2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1225 c2 node n758 p2" transform="translate(-2.31 2.96185)"><g class="a758 i42 leaf node n85 p2 sample" transform="translate(-1.54 6.42101)"><path class="edge" d="M 0 0 V -6.42101 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a758 i55 leaf node n111 p2 sample" transform="translate(1.54 6.42101)"><path class="edge" d="M 0 0 V -6.42101 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -2.96185 H 2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.44613 H 2.695"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.0424333 H 5.29375"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1442 c2 node n1272 p2" transform="translate(5.29375 1.15843)"><g class="a1272 i43 leaf node n87 p2 sample" transform="translate(-4.8125 9.71299)"><path class="edge" d="M 0 0 V -9.71299 H 4.8125"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1272 c2 node n1048 p2" transform="translate(4.8125 1.41473)"><g class="a1048 c2 node n1001 p2" transform="translate(4.235 0.245265)"><g class="a1001 i49 leaf node n98 p2 sample" transform="translate(-1.54 8.053)"><path class="edge" d="M 0 0 V -8.053 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1001 i57 leaf node n114 p2 sample" transform="translate(1.54 8.053)"><path class="edge" d="M 0 0 V -8.053 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.245265 H -4.235"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1048 c2 node n948 p2" transform="translate(-4.235 0.664506)"><g class="a948 i47 leaf node n94 p2 sample" transform="translate(-2.31 7.63376)"><path class="edge" d="M 0 0 V -7.63376 H 2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a948 c2 node n131 p2" transform="translate(2.31 6.90051)"><g class="a131 i49 leaf node n99 p2 sample" transform="translate(-1.54 0.733248)"><path class="edge" d="M 0 0 V -0.733248 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a131 i58 leaf node n117 p2 sample" transform="translate(1.54 0.733248)"><path class="edge" d="M 0 0 V -0.733248 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -6.90051 H -2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.664506 H 4.235"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.41473 H -4.8125"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.15843 H -5.29375"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.633105 H 16.4828"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1523 c2 node n1267 p2" transform="translate(16.4828 1.83057)"><g class="a1267 c2 node n868 p2" transform="translate(9.09563 2.52393)"><g class="a868 i45 leaf node n91 p2 sample" transform="translate(-1.54 7.15002)"><path class="edge" d="M 0 0 V -7.15002 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a868 i55 leaf node n110 p2 sample" transform="translate(1.54 7.15002)"><path class="edge" d="M 0 0 V -7.15002 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -2.52393 H -9.09563"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1267 c2 node n1220 p2" transform="translate(-9.09562 0.312309)"><g class="a1220 i44 leaf node n88 p2 sample" transform="translate(-4.90875 9.36164)"><path class="edge" d="M 0 0 V -9.36164 H 4.90875"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1220 c2 node n1195 p2" transform="translate(4.90875 0.151063)"><g class="a1195 c2 node n1160 p2" transform="translate(5.1975 0.269876)"><g class="a1160 i52 leaf node n104 p2 sample" transform="translate(3.465 8.9407)"><path class="edge" d="M 0 0 V -8.9407 H -3.465"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1160 c2 node n1146 p2" transform="translate(-3.465 0.071288)"><g class="a1146 i46 leaf node n93 p2 sample" transform="translate(-2.31 8.86942)"><path class="edge" d="M 0 0 V -8.86942 H 2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1146 c2 node n920 p2" transform="translate(2.31 1.43764)"><g class="a920 i52 leaf node n105 p2 sample" transform="translate(-1.54 7.43177)"><path class="edge" d="M 0 0 V -7.43177 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a920 i56 leaf node n113 p2 sample" transform="translate(1.54 7.43177)"><path class="edge" d="M 0 0 V -7.43177 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -1.43764 H -2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.071288 H 3.465"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.269876 H -5.1975"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1195 c2 node n943 p2" transform="translate(-5.1975 1.59295)"><g class="a943 i45 leaf node n90 p2 sample" transform="translate(-1.54 7.61763)"><path class="edge" d="M 0 0 V -7.61763 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a943 i50 leaf node n101 p2 sample" transform="translate(1.54 7.61763)"><path class="edge" d="M 0 0 V -7.61763 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -1.59295 H 5.1975"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.151063 H -4.90875"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.312309 H 9.09562"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.83057 H -16.4828"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.627165 H 15.0992"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1605 i59 leaf node n118 p2 sample" transform="translate(15.0992 12.1317)"><path class="edge" d="M 0 0 V -12.1317 H -15.0992"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -273.321 H -34.3943"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a13063 c2 node n1452 p2" transform="translate(-34.3943 274.521)"><g class="a1452 c2 node n1339 p2" transform="translate(18.1371 0.726459)"><g class="a1339 i57 leaf node n115 p2 sample" transform="translate(4.15078 10.2052)"><path class="edge" d="M 0 0 V -10.2052 H -4.15078"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1339 c2 node n1262 p2" transform="translate(-4.15078 0.583883)"><g class="a1262 c2 node n1233 p2" transform="translate(-5.22156 0.207923)"><g class="a1233 c2 node n1135 p2" transform="translate(5.05313 0.621224)"><g class="a1135 i51 leaf node n103 p2 sample" transform="translate(2.31 8.79219)"><path class="edge" d="M 0 0 V -8.79219 H -2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1135 c2 node n1104 p2" transform="translate(-2.31 0.167187)"><g class="a1104 i43 leaf node n86 p2 sample" transform="translate(-1.54 8.625)"><path class="edge" d="M 0 0 V -8.625 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1104 i47 leaf node n95 p2 sample" transform="translate(1.54 8.625)"><path class="edge" d="M 0 0 V -8.625 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.167187 H 2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.621224 H -5.05313"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1233 c2 node n1232 p2" transform="translate(-5.05312 0.000848667)"><g class="a1232 i48 leaf node n97 p2 sample" transform="translate(3.17625 9.41256)"><path class="edge" d="M 0 0 V -9.41256 H -3.17625"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1232 c2 node n1164 p2" transform="translate(-3.17625 0.449793)"><g class="a1164 c2 node n1145 p2" transform="translate(-3.2725 0.0975967)"><g class="a1145 i59 leaf node n119 p2 sample" transform="translate(3.465 8.86517)"><path class="edge" d="M 0 0 V -8.86517 H -3.465"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1145 c2 node n1085 p2" transform="translate(-3.465 0.398873)"><g class="a1085 i40 leaf node n81 p2 sample" transform="translate(-2.31 8.4663)"><path class="edge" d="M 0 0 V -8.4663 H 2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1085 c2 node n1038 p2" transform="translate(2.31 0.21641)"><g class="a1038 i46 leaf node n92 p2 sample" transform="translate(-1.54 8.24989)"><path class="edge" d="M 0 0 V -8.24989 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1038 i56 leaf node n112 p2 sample" transform="translate(1.54 8.24989)"><path class="edge" d="M 0 0 V -8.24989 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.21641 H -2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.398873 H 3.465"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.0975967 H 3.2725"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1164 i51 leaf node n102 p2 sample" transform="translate(3.2725 8.96277)"><path class="edge" d="M 0 0 V -8.96277 H -3.2725"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.449793 H 3.17625"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.000848667 H 5.05312"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.207923 H 5.22156"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1262 i50 leaf node n100 p2 sample" transform="translate(5.22156 9.62133)"><path class="edge" d="M 0 0 V -9.62133 H -5.22156"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.583883 H 4.15078"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.726459 H -18.1371"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1452 c2 node n1302 p2" transform="translate(-18.1371 0.99294)"><g class="a1302 c2 node n1197 p2" transform="translate(-6.545 0.727307)"><g class="a1197 c2 node n977 p2" transform="translate(7.7 1.34174)"><g class="a977 i58 leaf node n116 p2 sample" transform="translate(2.31 7.86969)"><path class="edge" d="M 0 0 V -7.86969 H -2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a977 c2 node n180 p2" transform="translate(-2.31 6.29796)"><g class="a180 i42 leaf node n84 p2 sample" transform="translate(-1.54 1.57173)"><path class="edge" d="M 0 0 V -1.57173 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a180 i54 leaf node n108 p2 sample" transform="translate(1.54 1.57173)"><path class="edge" d="M 0 0 V -1.57173 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -6.29796 H 2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.34174 H -7.7"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1197 c2 node n1139 p2" transform="translate(-7.7 0.375959)"><g class="a1139 i40 leaf node n80 p2 sample" transform="translate(-3.85 8.83547)"><path class="edge" d="M 0 0 V -8.83547 H 3.85"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1139 c2 node n1014 p2" transform="translate(3.85 0.729005)"><g class="a1014 c2 node n628 p2" transform="translate(3.08 2.79466)"><g class="a628 i41 leaf node n83 p2 sample" transform="translate(-1.54 5.3118)"><path class="edge" d="M 0 0 V -5.3118 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a628 i48 leaf node n96 p2 sample" transform="translate(1.54 5.3118)"><path class="edge" d="M 0 0 V -5.3118 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -2.79466 H -3.08"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1014 c2 node n664 p2" transform="translate(-3.08 2.50781)"><g class="a664 i41 leaf node n82 p2 sample" transform="translate(-1.54 5.59865)"><path class="edge" d="M 0 0 V -5.59865 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a664 i53 leaf node n106 p2 sample" transform="translate(1.54 5.59865)"><path class="edge" d="M 0 0 V -5.59865 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -2.50781 H 3.08"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.729005 H -3.85"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.375959 H 7.7"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.727307 H 6.545"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1302 i44 leaf node n89 p2 sample" transform="translate(6.545 9.93874)"><path class="edge" d="M 0 0 V -9.93874 H -6.545"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.99294 H 18.1371"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -274.521 H 34.3943"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab" transform="translate(0 -13.5)"></text></g></g></g></svg><svg baseprofile="full" height="350" style="display: inline-block" version="1.1" width="200" xmlns="http://www.w3.org/2000/svg" xmlns:ev="http://www.w3.org/2001/xml-events" xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css">.background path {fill: #808080; fill-opacity: 0}.background path:nth-child(odd) {fill-opacity: .1}.x-regions rect {fill: yellow; stroke: black; opacity: 0.5}.axes {font-size: 14px}.x-axis .tick .lab {font-weight: bold; dominant-baseline: hanging}.axes, .tree {font-size: 14px; text-anchor: middle}.axes line, .edge {stroke: black; fill: none}.axes .ax-skip {stroke-dasharray: 4}.y-axis .grid {stroke: #FAFAFA}.node > .sym {fill: black; stroke: none}.site > .sym {stroke: black}.mut text {fill: red; font-style: italic}.mut.extra text {fill: hotpink}.mut line {fill: none; stroke: none}.mut .sym {fill: none; stroke: red}.mut.extra .sym {stroke: hotpink}.node .mut .sym {stroke-width: 1.5px}.tree text, .tree-sequence text {dominant-baseline: central}.plotbox .lab.lft {text-anchor: end}.plotbox .lab.rgt {text-anchor: start}.polytomy line {stroke: black; stroke-dasharray: 1px, 1px}.polytomy text {paint-order:stroke;stroke-width:0.3em;stroke:white}.node.p0 > .sym {fill: #d62728} .node.p1 > .sym {fill: #2ca02c} .node.p2 > .sym {fill: #ff7f0e}</style></defs><g class="tree t3461"><g class="axes"><g class="x-axis"><g class="title" transform="translate(118.4 350)"><text class="lab" text-anchor="middle" transform="translate(0 -11)">Genome position</text></g><line class="ax-line" x1="56.8" x2="180" y1="313.2" y2="313.2"></line><g class="ticks"><g class="tick" transform="translate(56.8 313.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">3332448</text></g></g><g class="tick" transform="translate(180 313.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">3340826</text></g></g></g></g><g class="y-axis"><g class="title" transform="translate(0 145.7)"><text class="lab" text-anchor="middle" transform="translate(11) rotate(-90)">Time ago (generations)</text></g><line class="ax-line" x1="56.8" x2="56.8" y1="281.4" y2="10"></line><g class="ticks"><g class="tick" transform="translate(56.8 281.4)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">0k</text></g></g><g class="tick" transform="translate(56.8 230.48)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">3k</text></g></g><g class="tick" transform="translate(56.8 179.56)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">6k</text></g></g><g class="tick" transform="translate(56.8 128.64)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">9k</text></g></g><g class="tick" transform="translate(56.8 77.72)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">12k</text></g></g><g class="tick" transform="translate(56.8 26.8)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">15k</text></g></g></g></g></g><g class="plotbox"><g class="c2 node n1640 p2 root" transform="translate(127.947 268.987)"><g class="a1640 c2 node n1452 p2" transform="translate(-34.9207 1.48092)"><g class="a1452 c2 node n1339 p2" transform="translate(16.5911 0.726459)"><g class="a1339 i57 leaf node n115 p2 sample" transform="translate(4.16281 10.2052)"><path class="edge" d="M 0 0 V -10.2052 H -4.16281"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1339 c2 node n1262 p2" transform="translate(-4.16281 0.583883)"><g class="a1262 c2 node n1233 p2" transform="translate(-5.24562 0.207923)"><g class="a1233 c2 node n1135 p2" transform="translate(5.10125 0.621224)"><g class="a1135 i51 leaf node n103 p2 sample" transform="translate(2.31 8.79219)"><path class="edge" d="M 0 0 V -8.79219 H -2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1135 c2 node n1104 p2" transform="translate(-2.31 0.167187)"><g class="a1104 i43 leaf node n86 p2 sample" transform="translate(-1.54 8.625)"><path class="edge" d="M 0 0 V -8.625 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1104 i47 leaf node n95 p2 sample" transform="translate(1.54 8.625)"><path class="edge" d="M 0 0 V -8.625 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.167187 H 2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.621224 H -5.10125"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1233 c2 node n1232 p2" transform="translate(-5.10125 0.000848667)"><g class="a1232 i48 leaf node n97 p2 sample" transform="translate(3.2725 9.41256)"><path class="edge" d="M 0 0 V -9.41256 H -3.2725"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1232 c2 node n1164 p2" transform="translate(-3.2725 0.449793)"><g class="a1164 i51 leaf node n102 p2 sample" transform="translate(3.465 8.96277)"><path class="edge" d="M 0 0 V -8.96277 H -3.465"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1164 c2 node n1085 p2" transform="translate(-3.465 0.49647)"><g class="a1085 i40 leaf node n81 p2 sample" transform="translate(-2.31 8.4663)"><path class="edge" d="M 0 0 V -8.4663 H 2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1085 c2 node n1038 p2" transform="translate(2.31 0.21641)"><g class="a1038 i46 leaf node n92 p2 sample" transform="translate(-1.54 8.24989)"><path class="edge" d="M 0 0 V -8.24989 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1038 i56 leaf node n112 p2 sample" transform="translate(1.54 8.24989)"><path class="edge" d="M 0 0 V -8.24989 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.21641 H -2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.49647 H 3.465"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.449793 H 3.2725"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.000848667 H 5.10125"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.207923 H 5.24562"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1262 i50 leaf node n100 p2 sample" transform="translate(5.24562 9.62133)"><path class="edge" d="M 0 0 V -9.62133 H -5.24562"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.583883 H 4.16281"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.726459 H -16.5911"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1452 c2 node n1302 p2" transform="translate(-16.5911 0.99294)"><g class="a1302 c2 node n1197 p2" transform="translate(-6.545 0.727307)"><g class="a1197 c2 node n977 p2" transform="translate(7.7 1.34174)"><g class="a977 i58 leaf node n116 p2 sample" transform="translate(2.31 7.86969)"><path class="edge" d="M 0 0 V -7.86969 H -2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a977 c2 node n180 p2" transform="translate(-2.31 6.29796)"><g class="a180 i42 leaf node n84 p2 sample" transform="translate(-1.54 1.57173)"><path class="edge" d="M 0 0 V -1.57173 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a180 i54 leaf node n108 p2 sample" transform="translate(1.54 1.57173)"><path class="edge" d="M 0 0 V -1.57173 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -6.29796 H 2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.34174 H -7.7"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1197 c2 node n1139 p2" transform="translate(-7.7 0.375959)"><g class="a1139 i40 leaf node n80 p2 sample" transform="translate(-3.85 8.83547)"><path class="edge" d="M 0 0 V -8.83547 H 3.85"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1139 c2 node n1014 p2" transform="translate(3.85 0.729005)"><g class="a1014 c2 node n628 p2" transform="translate(3.08 2.79466)"><g class="a628 i41 leaf node n83 p2 sample" transform="translate(-1.54 5.3118)"><path class="edge" d="M 0 0 V -5.3118 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a628 i48 leaf node n96 p2 sample" transform="translate(1.54 5.3118)"><path class="edge" d="M 0 0 V -5.3118 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -2.79466 H -3.08"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1014 c2 node n664 p2" transform="translate(-3.08 2.50781)"><g class="a664 i41 leaf node n82 p2 sample" transform="translate(-1.54 5.59865)"><path class="edge" d="M 0 0 V -5.59865 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a664 i53 leaf node n106 p2 sample" transform="translate(1.54 5.59865)"><path class="edge" d="M 0 0 V -5.59865 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -2.50781 H 3.08"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.729005 H -3.85"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.375959 H 7.7"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.727307 H 6.545"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1302 i44 leaf node n89 p2 sample" transform="translate(6.545 9.93874)"><path class="edge" d="M 0 0 V -9.93874 H -6.545"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.99294 H 16.5911"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.48092 H 34.9207"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1640 c2 node n1605 p2" transform="translate(34.9207 0.280909)"><g class="a1605 c2 node n1523 p2" transform="translate(-15.5925 0.627165)"><g class="a1523 c2 node n1442 p2" transform="translate(-17.4694 0.633105)"><g class="a1442 c2 node n1436 p2" transform="translate(-6.40062 0.0424333)"><g class="a1436 i54 leaf node n109 p2 sample" transform="translate(2.695 10.829)"><path class="edge" d="M 0 0 V -10.829 H -2.695"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1436 c2 node n1225 p2" transform="translate(-2.695 1.44613)"><g class="a1225 i53 leaf node n107 p2 sample" transform="translate(2.31 9.38286)"><path class="edge" d="M 0 0 V -9.38286 H -2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1225 c2 node n758 p2" transform="translate(-2.31 2.96185)"><g class="a758 i42 leaf node n85 p2 sample" transform="translate(-1.54 6.42101)"><path class="edge" d="M 0 0 V -6.42101 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a758 i55 leaf node n111 p2 sample" transform="translate(1.54 6.42101)"><path class="edge" d="M 0 0 V -6.42101 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -2.96185 H 2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.44613 H 2.695"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.0424333 H 6.40062"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1442 c2 node n1272 p2" transform="translate(6.40063 1.15843)"><g class="a1272 i43 leaf node n87 p2 sample" transform="translate(-7.02625 9.71299)"><path class="edge" d="M 0 0 V -9.71299 H 7.02625"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1272 c2 node n1212 p2" transform="translate(7.02625 0.374262)"><g class="a1212 i59 leaf node n119 p2 sample" transform="translate(4.4275 9.33873)"><path class="edge" d="M 0 0 V -9.33873 H -4.4275"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1212 c2 node n1048 p2" transform="translate(-4.4275 1.04047)"><g class="a1048 c2 node n1001 p2" transform="translate(4.235 0.245265)"><g class="a1001 i49 leaf node n98 p2 sample" transform="translate(-1.54 8.053)"><path class="edge" d="M 0 0 V -8.053 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1001 i57 leaf node n114 p2 sample" transform="translate(1.54 8.053)"><path class="edge" d="M 0 0 V -8.053 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.245265 H -4.235"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1048 c2 node n948 p2" transform="translate(-4.235 0.664506)"><g class="a948 i47 leaf node n94 p2 sample" transform="translate(-2.31 7.63376)"><path class="edge" d="M 0 0 V -7.63376 H 2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a948 c2 node n131 p2" transform="translate(2.31 6.90051)"><g class="a131 i49 leaf node n99 p2 sample" transform="translate(-1.54 0.733248)"><path class="edge" d="M 0 0 V -0.733248 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a131 i58 leaf node n117 p2 sample" transform="translate(1.54 0.733248)"><path class="edge" d="M 0 0 V -0.733248 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -6.90051 H -2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.664506 H 4.235"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.04047 H 4.4275"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.374262 H -7.02625"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.15843 H -6.40063"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.633105 H 17.4694"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1523 c2 node n1267 p2" transform="translate(17.4694 1.83057)"><g class="a1267 c2 node n868 p2" transform="translate(9.09563 2.52393)"><g class="a868 i45 leaf node n91 p2 sample" transform="translate(-1.54 7.15002)"><path class="edge" d="M 0 0 V -7.15002 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a868 i55 leaf node n110 p2 sample" transform="translate(1.54 7.15002)"><path class="edge" d="M 0 0 V -7.15002 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -2.52393 H -9.09563"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1267 c2 node n1220 p2" transform="translate(-9.09562 0.312309)"><g class="a1220 i44 leaf node n88 p2 sample" transform="translate(-4.90875 9.36164)"><path class="edge" d="M 0 0 V -9.36164 H 4.90875"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1220 c2 node n1195 p2" transform="translate(4.90875 0.151063)"><g class="a1195 c2 node n1160 p2" transform="translate(5.1975 0.269876)"><g class="a1160 i52 leaf node n104 p2 sample" transform="translate(3.465 8.9407)"><path class="edge" d="M 0 0 V -8.9407 H -3.465"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1160 c2 node n1146 p2" transform="translate(-3.465 0.071288)"><g class="a1146 i46 leaf node n93 p2 sample" transform="translate(-2.31 8.86942)"><path class="edge" d="M 0 0 V -8.86942 H 2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1146 c2 node n920 p2" transform="translate(2.31 1.43764)"><g class="a920 i52 leaf node n105 p2 sample" transform="translate(-1.54 7.43177)"><path class="edge" d="M 0 0 V -7.43177 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a920 i56 leaf node n113 p2 sample" transform="translate(1.54 7.43177)"><path class="edge" d="M 0 0 V -7.43177 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -1.43764 H -2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.071288 H 3.465"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.269876 H -5.1975"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1195 c2 node n943 p2" transform="translate(-5.1975 1.59295)"><g class="a943 i45 leaf node n90 p2 sample" transform="translate(-1.54 7.61763)"><path class="edge" d="M 0 0 V -7.61763 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a943 i50 leaf node n101 p2 sample" transform="translate(1.54 7.61763)"><path class="edge" d="M 0 0 V -7.61763 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -1.59295 H 5.1975"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.151063 H -4.90875"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.312309 H 9.09562"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.83057 H -17.4694"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.627165 H 15.5925"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1605 i59 leaf node n118 p2 sample" transform="translate(15.5925 12.1317)"><path class="edge" d="M 0 0 V -12.1317 H -15.5925"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.280909 H -34.9207"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab" transform="translate(0 -13.5)"></text></g></g></g></svg><svg baseprofile="full" height="350" style="display: inline-block" version="1.1" width="200" xmlns="http://www.w3.org/2000/svg" xmlns:ev="http://www.w3.org/2001/xml-events" xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css">.background path {fill: #808080; fill-opacity: 0}.background path:nth-child(odd) {fill-opacity: .1}.x-regions rect {fill: yellow; stroke: black; opacity: 0.5}.axes {font-size: 14px}.x-axis .tick .lab {font-weight: bold; dominant-baseline: hanging}.axes, .tree {font-size: 14px; text-anchor: middle}.axes line, .edge {stroke: black; fill: none}.axes .ax-skip {stroke-dasharray: 4}.y-axis .grid {stroke: #FAFAFA}.node > .sym {fill: black; stroke: none}.site > .sym {stroke: black}.mut text {fill: red; font-style: italic}.mut.extra text {fill: hotpink}.mut line {fill: none; stroke: none}.mut .sym {fill: none; stroke: red}.mut.extra .sym {stroke: hotpink}.node .mut .sym {stroke-width: 1.5px}.tree text, .tree-sequence text {dominant-baseline: central}.plotbox .lab.lft {text-anchor: end}.plotbox .lab.rgt {text-anchor: start}.polytomy line {stroke: black; stroke-dasharray: 1px, 1px}.polytomy text {paint-order:stroke;stroke-width:0.3em;stroke:white}.node.p0 > .sym {fill: #d62728} .node.p1 > .sym {fill: #2ca02c} .node.p2 > .sym {fill: #ff7f0e}</style></defs><g class="tree t3462"><g class="axes"><g class="x-axis"><g class="title" transform="translate(118.4 350)"><text class="lab" text-anchor="middle" transform="translate(0 -11)">Genome position</text></g><line class="ax-line" x1="56.8" x2="180" y1="313.2" y2="313.2"></line><g class="ticks"><g class="tick" transform="translate(56.8 313.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">3340826</text></g></g><g class="tick" transform="translate(180 313.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">3357839</text></g></g></g></g><g class="y-axis"><g class="title" transform="translate(0 145.7)"><text class="lab" text-anchor="middle" transform="translate(11) rotate(-90)">Time ago (generations)</text></g><line class="ax-line" x1="56.8" x2="56.8" y1="281.4" y2="10"></line><g class="ticks"><g class="tick" transform="translate(56.8 281.4)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">0k</text></g></g><g class="tick" transform="translate(56.8 230.48)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">3k</text></g></g><g class="tick" transform="translate(56.8 179.56)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">6k</text></g></g><g class="tick" transform="translate(56.8 128.64)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">9k</text></g></g><g class="tick" transform="translate(56.8 77.72)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">12k</text></g></g><g class="tick" transform="translate(56.8 26.8)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">15k</text></g></g></g></g></g><g class="plotbox"><g class="c2 node n1640 p2 root" transform="translate(127.454 268.987)"><g class="a1640 c2 node n1452 p2" transform="translate(-34.4274 1.48092)"><g class="a1452 c2 node n1339 p2" transform="translate(16.5911 0.726459)"><g class="a1339 i57 leaf node n115 p2 sample" transform="translate(4.16281 10.2052)"><path class="edge" d="M 0 0 V -10.2052 H -4.16281"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1339 c2 node n1262 p2" transform="translate(-4.16281 0.583883)"><g class="a1262 c2 node n1233 p2" transform="translate(-5.24562 0.207923)"><g class="a1233 c2 node n1135 p2" transform="translate(5.10125 0.621224)"><g class="a1135 i51 leaf node n103 p2 sample" transform="translate(2.31 8.79219)"><path class="edge" d="M 0 0 V -8.79219 H -2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1135 c2 node n1104 p2" transform="translate(-2.31 0.167187)"><g class="a1104 i43 leaf node n86 p2 sample" transform="translate(-1.54 8.625)"><path class="edge" d="M 0 0 V -8.625 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1104 i47 leaf node n95 p2 sample" transform="translate(1.54 8.625)"><path class="edge" d="M 0 0 V -8.625 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.167187 H 2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.621224 H -5.10125"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1233 c2 node n1232 p2" transform="translate(-5.10125 0.000848667)"><g class="a1232 i48 leaf node n97 p2 sample" transform="translate(3.2725 9.41256)"><path class="edge" d="M 0 0 V -9.41256 H -3.2725"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1232 c2 node n1164 p2" transform="translate(-3.2725 0.449793)"><g class="a1164 i51 leaf node n102 p2 sample" transform="translate(3.465 8.96277)"><path class="edge" d="M 0 0 V -8.96277 H -3.465"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1164 c2 node n1085 p2" transform="translate(-3.465 0.49647)"><g class="a1085 i40 leaf node n81 p2 sample" transform="translate(-2.31 8.4663)"><path class="edge" d="M 0 0 V -8.4663 H 2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1085 c2 node n1038 p2" transform="translate(2.31 0.21641)"><g class="a1038 i46 leaf node n92 p2 sample" transform="translate(-1.54 8.24989)"><path class="edge" d="M 0 0 V -8.24989 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1038 i56 leaf node n112 p2 sample" transform="translate(1.54 8.24989)"><path class="edge" d="M 0 0 V -8.24989 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.21641 H -2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.49647 H 3.465"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.449793 H 3.2725"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.000848667 H 5.10125"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.207923 H 5.24562"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1262 i50 leaf node n100 p2 sample" transform="translate(5.24562 9.62133)"><path class="edge" d="M 0 0 V -9.62133 H -5.24562"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.583883 H 4.16281"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.726459 H -16.5911"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1452 c2 node n1302 p2" transform="translate(-16.5911 0.99294)"><g class="a1302 c2 node n1197 p2" transform="translate(-6.545 0.727307)"><g class="a1197 c2 node n977 p2" transform="translate(7.7 1.34174)"><g class="a977 i58 leaf node n116 p2 sample" transform="translate(2.31 7.86969)"><path class="edge" d="M 0 0 V -7.86969 H -2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a977 c2 node n180 p2" transform="translate(-2.31 6.29796)"><g class="a180 i42 leaf node n84 p2 sample" transform="translate(-1.54 1.57173)"><path class="edge" d="M 0 0 V -1.57173 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a180 i54 leaf node n108 p2 sample" transform="translate(1.54 1.57173)"><path class="edge" d="M 0 0 V -1.57173 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -6.29796 H 2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.34174 H -7.7"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1197 c2 node n1139 p2" transform="translate(-7.7 0.375959)"><g class="a1139 i40 leaf node n80 p2 sample" transform="translate(-3.85 8.83547)"><path class="edge" d="M 0 0 V -8.83547 H 3.85"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1139 c2 node n1014 p2" transform="translate(3.85 0.729005)"><g class="a1014 c2 node n628 p2" transform="translate(3.08 2.79466)"><g class="a628 i41 leaf node n83 p2 sample" transform="translate(-1.54 5.3118)"><path class="edge" d="M 0 0 V -5.3118 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a628 i48 leaf node n96 p2 sample" transform="translate(1.54 5.3118)"><path class="edge" d="M 0 0 V -5.3118 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -2.79466 H -3.08"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1014 c2 node n664 p2" transform="translate(-3.08 2.50781)"><g class="a664 i41 leaf node n82 p2 sample" transform="translate(-1.54 5.59865)"><path class="edge" d="M 0 0 V -5.59865 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a664 i53 leaf node n106 p2 sample" transform="translate(1.54 5.59865)"><path class="edge" d="M 0 0 V -5.59865 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -2.50781 H 3.08"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.729005 H -3.85"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.375959 H 7.7"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.727307 H 6.545"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1302 i44 leaf node n89 p2 sample" transform="translate(6.545 9.93874)"><path class="edge" d="M 0 0 V -9.93874 H -6.545"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.99294 H 16.5911"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.48092 H 34.4274"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1640 c2 node n1605 p2" transform="translate(34.4274 0.280909)"><g class="a1605 c2 node n1523 p2" transform="translate(-16.5791 0.627165)"><g class="a1523 c2 node n1442 p2" transform="translate(-18.3837 0.633105)"><g class="a1442 c2 node n1436 p2" transform="translate(-6.20812 0.0424333)"><g class="a1436 i54 leaf node n109 p2 sample" transform="translate(2.31 10.829)"><path class="edge" d="M 0 0 V -10.829 H -2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1436 c2 node n758 p2" transform="translate(-2.31 4.40797)"><g class="a758 i42 leaf node n85 p2 sample" transform="translate(-1.54 6.42101)"><path class="edge" d="M 0 0 V -6.42101 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a758 i55 leaf node n111 p2 sample" transform="translate(1.54 6.42101)"><path class="edge" d="M 0 0 V -6.42101 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -4.40797 H 2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.0424333 H 6.20812"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1442 c2 node n1272 p2" transform="translate(6.20812 1.15843)"><g class="a1272 i43 leaf node n87 p2 sample" transform="translate(-7.02625 9.71299)"><path class="edge" d="M 0 0 V -9.71299 H 7.02625"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1272 c2 node n1212 p2" transform="translate(7.02625 0.374262)"><g class="a1212 i59 leaf node n119 p2 sample" transform="translate(4.4275 9.33873)"><path class="edge" d="M 0 0 V -9.33873 H -4.4275"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1212 c2 node n1048 p2" transform="translate(-4.4275 1.04047)"><g class="a1048 c2 node n1001 p2" transform="translate(4.235 0.245265)"><g class="a1001 i49 leaf node n98 p2 sample" transform="translate(-1.54 8.053)"><path class="edge" d="M 0 0 V -8.053 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1001 i57 leaf node n114 p2 sample" transform="translate(1.54 8.053)"><path class="edge" d="M 0 0 V -8.053 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.245265 H -4.235"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1048 c2 node n948 p2" transform="translate(-4.235 0.664506)"><g class="a948 i47 leaf node n94 p2 sample" transform="translate(-2.31 7.63376)"><path class="edge" d="M 0 0 V -7.63376 H 2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a948 c2 node n131 p2" transform="translate(2.31 6.90051)"><g class="a131 i49 leaf node n99 p2 sample" transform="translate(-1.54 0.733248)"><path class="edge" d="M 0 0 V -0.733248 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a131 i58 leaf node n117 p2 sample" transform="translate(1.54 0.733248)"><path class="edge" d="M 0 0 V -0.733248 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -6.90051 H -2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.664506 H 4.235"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.04047 H 4.4275"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.374262 H -7.02625"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.15843 H -6.20812"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.633105 H 18.3837"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1523 c2 node n1267 p2" transform="translate(18.3837 1.83057)"><g class="a1267 c2 node n868 p2" transform="translate(10.1544 2.52393)"><g class="a868 i45 leaf node n91 p2 sample" transform="translate(-1.54 7.15002)"><path class="edge" d="M 0 0 V -7.15002 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a868 i55 leaf node n110 p2 sample" transform="translate(1.54 7.15002)"><path class="edge" d="M 0 0 V -7.15002 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -2.52393 H -10.1544"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1267 c2 node n1220 p2" transform="translate(-10.1544 0.312309)"><g class="a1220 i44 leaf node n88 p2 sample" transform="translate(-5.87125 9.36164)"><path class="edge" d="M 0 0 V -9.36164 H 5.87125"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1220 c2 node n1195 p2" transform="translate(5.87125 0.151063)"><g class="a1195 c2 node n1160 p2" transform="translate(6.3525 0.269876)"><g class="a1160 i52 leaf node n104 p2 sample" transform="translate(3.465 8.9407)"><path class="edge" d="M 0 0 V -8.9407 H -3.465"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1160 c2 node n1146 p2" transform="translate(-3.465 0.071288)"><g class="a1146 i46 leaf node n93 p2 sample" transform="translate(-2.31 8.86942)"><path class="edge" d="M 0 0 V -8.86942 H 2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1146 c2 node n920 p2" transform="translate(2.31 1.43764)"><g class="a920 i52 leaf node n105 p2 sample" transform="translate(-1.54 7.43177)"><path class="edge" d="M 0 0 V -7.43177 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a920 i56 leaf node n113 p2 sample" transform="translate(1.54 7.43177)"><path class="edge" d="M 0 0 V -7.43177 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -1.43764 H -2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.071288 H 3.465"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.269876 H -6.3525"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1195 c2 node n943 p2" transform="translate(-6.3525 1.59295)"><g class="a943 i45 leaf node n90 p2 sample" transform="translate(-2.31 7.61763)"><path class="edge" d="M 0 0 V -7.61763 H 2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a943 c2 node n395 p2" transform="translate(2.31 4.1033)"><g class="a395 i50 leaf node n101 p2 sample" transform="translate(-1.54 3.51433)"><path class="edge" d="M 0 0 V -3.51433 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a395 i53 leaf node n107 p2 sample" transform="translate(1.54 3.51433)"><path class="edge" d="M 0 0 V -3.51433 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -4.1033 H -2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.59295 H 6.3525"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.151063 H -5.87125"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.312309 H 10.1544"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.83057 H -18.3837"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.627165 H 16.5791"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1605 i59 leaf node n118 p2 sample" transform="translate(16.5791 12.1317)"><path class="edge" d="M 0 0 V -12.1317 H -16.5791"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.280909 H -34.4274"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab" transform="translate(0 -13.5)"></text></g></g></g></svg><svg baseprofile="full" height="350" style="display: inline-block" version="1.1" width="200" xmlns="http://www.w3.org/2000/svg" xmlns:ev="http://www.w3.org/2001/xml-events" xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css">.background path {fill: #808080; fill-opacity: 0}.background path:nth-child(odd) {fill-opacity: .1}.x-regions rect {fill: yellow; stroke: black; opacity: 0.5}.axes {font-size: 14px}.x-axis .tick .lab {font-weight: bold; dominant-baseline: hanging}.axes, .tree {font-size: 14px; text-anchor: middle}.axes line, .edge {stroke: black; fill: none}.axes .ax-skip {stroke-dasharray: 4}.y-axis .grid {stroke: #FAFAFA}.node > .sym {fill: black; stroke: none}.site > .sym {stroke: black}.mut text {fill: red; font-style: italic}.mut.extra text {fill: hotpink}.mut line {fill: none; stroke: none}.mut .sym {fill: none; stroke: red}.mut.extra .sym {stroke: hotpink}.node .mut .sym {stroke-width: 1.5px}.tree text, .tree-sequence text {dominant-baseline: central}.plotbox .lab.lft {text-anchor: end}.plotbox .lab.rgt {text-anchor: start}.polytomy line {stroke: black; stroke-dasharray: 1px, 1px}.polytomy text {paint-order:stroke;stroke-width:0.3em;stroke:white}.node.p0 > .sym {fill: #d62728} .node.p1 > .sym {fill: #2ca02c} .node.p2 > .sym {fill: #ff7f0e}</style></defs><g class="tree t3464"><g class="axes"><g class="x-axis"><g class="title" transform="translate(118.4 350)"><text class="lab" text-anchor="middle" transform="translate(0 -11)">Genome position</text></g><line class="ax-line" x1="56.8" x2="180" y1="313.2" y2="313.2"></line><g class="ticks"><g class="tick" transform="translate(56.8 313.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">3360585</text></g></g><g class="tick" transform="translate(180 313.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">3370648</text></g></g></g></g><g class="y-axis"><g class="title" transform="translate(0 145.7)"><text class="lab" text-anchor="middle" transform="translate(11) rotate(-90)">Time ago (generations)</text></g><line class="ax-line" x1="56.8" x2="56.8" y1="281.4" y2="10"></line><g class="ticks"><g class="tick" transform="translate(56.8 281.4)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">0k</text></g></g><g class="tick" transform="translate(56.8 230.48)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">3k</text></g></g><g class="tick" transform="translate(56.8 179.56)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">6k</text></g></g><g class="tick" transform="translate(56.8 128.64)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">9k</text></g></g><g class="tick" transform="translate(56.8 77.72)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">12k</text></g></g><g class="tick" transform="translate(56.8 26.8)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">15k</text></g></g></g></g></g><g class="plotbox"><g class="c2 node n1640 p2 root" transform="translate(126.641 268.987)"><g class="a1640 c2 node n1452 p2" transform="translate(-34.9147 1.48092)"><g class="a1452 c2 node n1339 p2" transform="translate(15.2917 0.726459)"><g class="a1339 i57 leaf node n115 p2 sample" transform="translate(3.68156 10.2052)"><path class="edge" d="M 0 0 V -10.2052 H -3.68156"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1339 c2 node n1262 p2" transform="translate(-3.68156 0.583883)"><g class="a1262 c2 node n1233 p2" transform="translate(-4.28312 0.207923)"><g class="a1233 c2 node n1135 p2" transform="translate(3.94625 0.621224)"><g class="a1135 i51 leaf node n103 p2 sample" transform="translate(1.54 8.79219)"><path class="edge" d="M 0 0 V -8.79219 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1135 i47 leaf node n95 p2 sample" transform="translate(-1.54 8.79219)"><path class="edge" d="M 0 0 V -8.79219 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.621224 H -3.94625"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1233 c2 node n1232 p2" transform="translate(-3.94625 0.000848667)"><g class="a1232 i48 leaf node n97 p2 sample" transform="translate(3.2725 9.41256)"><path class="edge" d="M 0 0 V -9.41256 H -3.2725"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1232 c2 node n1164 p2" transform="translate(-3.2725 0.449793)"><g class="a1164 i51 leaf node n102 p2 sample" transform="translate(3.465 8.96277)"><path class="edge" d="M 0 0 V -8.96277 H -3.465"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1164 c2 node n1085 p2" transform="translate(-3.465 0.49647)"><g class="a1085 i40 leaf node n81 p2 sample" transform="translate(-2.31 8.4663)"><path class="edge" d="M 0 0 V -8.4663 H 2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1085 c2 node n1038 p2" transform="translate(2.31 0.21641)"><g class="a1038 i46 leaf node n92 p2 sample" transform="translate(-1.54 8.24989)"><path class="edge" d="M 0 0 V -8.24989 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1038 i56 leaf node n112 p2 sample" transform="translate(1.54 8.24989)"><path class="edge" d="M 0 0 V -8.24989 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.21641 H -2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.49647 H 3.465"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.449793 H 3.2725"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.000848667 H 3.94625"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.207923 H 4.28312"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1262 i50 leaf node n100 p2 sample" transform="translate(4.28313 9.62133)"><path class="edge" d="M 0 0 V -9.62133 H -4.28313"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.583883 H 3.68156"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.726459 H -15.2917"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1452 c2 node n1302 p2" transform="translate(-15.2917 0.99294)"><g class="a1302 c2 node n1197 p2" transform="translate(-6.545 0.727307)"><g class="a1197 c2 node n977 p2" transform="translate(7.7 1.34174)"><g class="a977 i58 leaf node n116 p2 sample" transform="translate(2.31 7.86969)"><path class="edge" d="M 0 0 V -7.86969 H -2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a977 c2 node n180 p2" transform="translate(-2.31 6.29796)"><g class="a180 i42 leaf node n84 p2 sample" transform="translate(-1.54 1.57173)"><path class="edge" d="M 0 0 V -1.57173 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a180 i54 leaf node n108 p2 sample" transform="translate(1.54 1.57173)"><path class="edge" d="M 0 0 V -1.57173 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -6.29796 H 2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.34174 H -7.7"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1197 c2 node n1139 p2" transform="translate(-7.7 0.375959)"><g class="a1139 i40 leaf node n80 p2 sample" transform="translate(-3.85 8.83547)"><path class="edge" d="M 0 0 V -8.83547 H 3.85"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1139 c2 node n1014 p2" transform="translate(3.85 0.729005)"><g class="a1014 c2 node n628 p2" transform="translate(3.08 2.79466)"><g class="a628 i41 leaf node n83 p2 sample" transform="translate(-1.54 5.3118)"><path class="edge" d="M 0 0 V -5.3118 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a628 i48 leaf node n96 p2 sample" transform="translate(1.54 5.3118)"><path class="edge" d="M 0 0 V -5.3118 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -2.79466 H -3.08"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1014 c2 node n664 p2" transform="translate(-3.08 2.50781)"><g class="a664 i41 leaf node n82 p2 sample" transform="translate(-1.54 5.59865)"><path class="edge" d="M 0 0 V -5.59865 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a664 i53 leaf node n106 p2 sample" transform="translate(1.54 5.59865)"><path class="edge" d="M 0 0 V -5.59865 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -2.50781 H 3.08"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.729005 H -3.85"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.375959 H 7.7"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.727307 H 6.545"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1302 i44 leaf node n89 p2 sample" transform="translate(6.545 9.93874)"><path class="edge" d="M 0 0 V -9.93874 H -6.545"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.99294 H 15.2917"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.48092 H 34.9147"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1640 c2 node n1605 p2" transform="translate(34.9147 0.280909)"><g class="a1605 c2 node n1523 p2" transform="translate(-16.9039 0.627165)"><g class="a1523 c2 node n1442 p2" transform="translate(-18.8891 0.633105)"><g class="a1442 c2 node n1436 p2" transform="translate(-7.36312 0.0424333)"><g class="a1436 c2 node n758 p2" transform="translate(-3.08 4.40797)"><g class="a758 i42 leaf node n85 p2 sample" transform="translate(-1.54 6.42101)"><path class="edge" d="M 0 0 V -6.42101 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a758 i55 leaf node n111 p2 sample" transform="translate(1.54 6.42101)"><path class="edge" d="M 0 0 V -6.42101 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -4.40797 H 3.08"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1436 c2 node n1089 p2" transform="translate(3.08 2.34911)"><g class="a1089 i43 leaf node n86 p2 sample" transform="translate(-1.54 8.47988)"><path class="edge" d="M 0 0 V -8.47988 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1089 i54 leaf node n109 p2 sample" transform="translate(1.54 8.47988)"><path class="edge" d="M 0 0 V -8.47988 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -2.34911 H -3.08"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.0424333 H 7.36312"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1442 c2 node n1272 p2" transform="translate(7.36312 1.15843)"><g class="a1272 i43 leaf node n87 p2 sample" transform="translate(-7.02625 9.71299)"><path class="edge" d="M 0 0 V -9.71299 H 7.02625"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1272 c2 node n1212 p2" transform="translate(7.02625 0.374262)"><g class="a1212 i59 leaf node n119 p2 sample" transform="translate(4.4275 9.33873)"><path class="edge" d="M 0 0 V -9.33873 H -4.4275"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1212 c2 node n1048 p2" transform="translate(-4.4275 1.04047)"><g class="a1048 c2 node n1001 p2" transform="translate(4.235 0.245265)"><g class="a1001 i49 leaf node n98 p2 sample" transform="translate(-1.54 8.053)"><path class="edge" d="M 0 0 V -8.053 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1001 i57 leaf node n114 p2 sample" transform="translate(1.54 8.053)"><path class="edge" d="M 0 0 V -8.053 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.245265 H -4.235"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1048 c2 node n948 p2" transform="translate(-4.235 0.664506)"><g class="a948 i47 leaf node n94 p2 sample" transform="translate(-2.31 7.63376)"><path class="edge" d="M 0 0 V -7.63376 H 2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a948 c2 node n131 p2" transform="translate(2.31 6.90051)"><g class="a131 i49 leaf node n99 p2 sample" transform="translate(-1.54 0.733248)"><path class="edge" d="M 0 0 V -0.733248 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a131 i58 leaf node n117 p2 sample" transform="translate(1.54 0.733248)"><path class="edge" d="M 0 0 V -0.733248 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -6.90051 H -2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.664506 H 4.235"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.04047 H 4.4275"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.374262 H -7.02625"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.15843 H -7.36312"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.633105 H 18.8891"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1523 c2 node n1267 p2" transform="translate(18.8891 1.83057)"><g class="a1267 c2 node n868 p2" transform="translate(10.2988 2.52393)"><g class="a868 i45 leaf node n91 p2 sample" transform="translate(-1.54 7.15002)"><path class="edge" d="M 0 0 V -7.15002 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a868 i55 leaf node n110 p2 sample" transform="translate(1.54 7.15002)"><path class="edge" d="M 0 0 V -7.15002 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -2.52393 H -10.2988"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1267 c2 node n1220 p2" transform="translate(-10.2987 0.312309)"><g class="a1220 i44 leaf node n88 p2 sample" transform="translate(-5.5825 9.36164)"><path class="edge" d="M 0 0 V -9.36164 H 5.5825"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1220 c2 node n1195 p2" transform="translate(5.5825 0.151063)"><g class="a1195 c2 node n943 p2" transform="translate(-5.775 1.59295)"><g class="a943 i45 leaf node n90 p2 sample" transform="translate(-2.31 7.61763)"><path class="edge" d="M 0 0 V -7.61763 H 2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a943 c2 node n395 p2" transform="translate(2.31 4.1033)"><g class="a395 i50 leaf node n101 p2 sample" transform="translate(-1.54 3.51433)"><path class="edge" d="M 0 0 V -3.51433 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a395 i53 leaf node n107 p2 sample" transform="translate(1.54 3.51433)"><path class="edge" d="M 0 0 V -3.51433 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -4.1033 H -2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.59295 H 5.775"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1195 c2 node n1146 p2" transform="translate(5.775 0.341164)"><g class="a1146 c2 node n920 p2" transform="translate(3.08 1.43764)"><g class="a920 i52 leaf node n105 p2 sample" transform="translate(-1.54 7.43177)"><path class="edge" d="M 0 0 V -7.43177 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a920 i56 leaf node n113 p2 sample" transform="translate(1.54 7.43177)"><path class="edge" d="M 0 0 V -7.43177 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -1.43764 H -3.08"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1146 c2 node n1079 p2" transform="translate(-3.08 0.427728)"><g class="a1079 i46 leaf node n93 p2 sample" transform="translate(-1.54 8.44169)"><path class="edge" d="M 0 0 V -8.44169 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1079 i52 leaf node n104 p2 sample" transform="translate(1.54 8.44169)"><path class="edge" d="M 0 0 V -8.44169 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.427728 H 3.08"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.341164 H -5.775"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.151063 H -5.5825"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.312309 H 10.2987"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.83057 H -18.8891"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.627165 H 16.9039"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1605 i59 leaf node n118 p2 sample" transform="translate(16.9039 12.1317)"><path class="edge" d="M 0 0 V -12.1317 H -16.9039"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.280909 H -34.9147"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab" transform="translate(0 -13.5)"></text></g></g></g></svg><svg baseprofile="full" height="350" style="display: inline-block" version="1.1" width="200" xmlns="http://www.w3.org/2000/svg" xmlns:ev="http://www.w3.org/2001/xml-events" xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css">.background path {fill: #808080; fill-opacity: 0}.background path:nth-child(odd) {fill-opacity: .1}.x-regions rect {fill: yellow; stroke: black; opacity: 0.5}.axes {font-size: 14px}.x-axis .tick .lab {font-weight: bold; dominant-baseline: hanging}.axes, .tree {font-size: 14px; text-anchor: middle}.axes line, .edge {stroke: black; fill: none}.axes .ax-skip {stroke-dasharray: 4}.y-axis .grid {stroke: #FAFAFA}.node > .sym {fill: black; stroke: none}.site > .sym {stroke: black}.mut text {fill: red; font-style: italic}.mut.extra text {fill: hotpink}.mut line {fill: none; stroke: none}.mut .sym {fill: none; stroke: red}.mut.extra .sym {stroke: hotpink}.node .mut .sym {stroke-width: 1.5px}.tree text, .tree-sequence text {dominant-baseline: central}.plotbox .lab.lft {text-anchor: end}.plotbox .lab.rgt {text-anchor: start}.polytomy line {stroke: black; stroke-dasharray: 1px, 1px}.polytomy text {paint-order:stroke;stroke-width:0.3em;stroke:white}.node.p0 > .sym {fill: #d62728} .node.p1 > .sym {fill: #2ca02c} .node.p2 > .sym {fill: #ff7f0e}</style></defs><g class="tree t3469"><g class="axes"><g class="x-axis"><g class="title" transform="translate(118.4 350)"><text class="lab" text-anchor="middle" transform="translate(0 -11)">Genome position</text></g><line class="ax-line" x1="56.8" x2="180" y1="313.2" y2="313.2"></line><g class="ticks"><g class="tick" transform="translate(56.8 313.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">3380994</text></g></g><g class="tick" transform="translate(180 313.2)"><line x1="0" x2="0" y1="0" y2="5"></line><g transform="translate(0 6)"><text class="lab">3397305</text></g></g></g></g><g class="y-axis"><g class="title" transform="translate(0 145.7)"><text class="lab" text-anchor="middle" transform="translate(11) rotate(-90)">Time ago (generations)</text></g><line class="ax-line" x1="56.8" x2="56.8" y1="281.4" y2="10"></line><g class="ticks"><g class="tick" transform="translate(56.8 281.4)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">0k</text></g></g><g class="tick" transform="translate(56.8 230.48)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">3k</text></g></g><g class="tick" transform="translate(56.8 179.56)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">6k</text></g></g><g class="tick" transform="translate(56.8 128.64)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">9k</text></g></g><g class="tick" transform="translate(56.8 77.72)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">12k</text></g></g><g class="tick" transform="translate(56.8 26.8)"><line x1="0" x2="-5" y1="0" y2="0"></line><g transform="translate(-6 0)"><text class="lab" text-anchor="end">15k</text></g></g></g></g></g><g class="plotbox"><g class="c2 node n13082 p2 root" transform="translate(143.248 -234.056)"><g class="a13082 i57 leaf node n114 p2 sample" transform="translate(35.2125 515.456)"><path class="edge" d="M 0 0 V -515.456 H -35.2125"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a13082 c2 node n1640 p2" transform="translate(-35.2125 503.044)"><g class="a1640 c2 node n1452 p2" transform="translate(-20.8923 1.48092)"><g class="a1452 c2 node n1339 p2" transform="translate(13.1141 0.726459)"><g class="a1339 i57 leaf node n115 p2 sample" transform="translate(4.28312 10.2052)"><path class="edge" d="M 0 0 V -10.2052 H -4.28312"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1339 c2 node n1233 p2" transform="translate(-4.28313 0.791806)"><g class="a1233 c2 node n1135 p2" transform="translate(3.94625 0.621224)"><g class="a1135 i51 leaf node n103 p2 sample" transform="translate(1.54 8.79219)"><path class="edge" d="M 0 0 V -8.79219 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1135 i47 leaf node n95 p2 sample" transform="translate(-1.54 8.79219)"><path class="edge" d="M 0 0 V -8.79219 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.621224 H -3.94625"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1233 c2 node n1232 p2" transform="translate(-3.94625 0.000848667)"><g class="a1232 i48 leaf node n97 p2 sample" transform="translate(3.2725 9.41256)"><path class="edge" d="M 0 0 V -9.41256 H -3.2725"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1232 c2 node n1164 p2" transform="translate(-3.2725 0.449793)"><g class="a1164 i51 leaf node n102 p2 sample" transform="translate(3.465 8.96277)"><path class="edge" d="M 0 0 V -8.96277 H -3.465"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1164 c2 node n1085 p2" transform="translate(-3.465 0.49647)"><g class="a1085 i40 leaf node n81 p2 sample" transform="translate(-2.31 8.4663)"><path class="edge" d="M 0 0 V -8.4663 H 2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1085 c2 node n1038 p2" transform="translate(2.31 0.21641)"><g class="a1038 i46 leaf node n92 p2 sample" transform="translate(-1.54 8.24989)"><path class="edge" d="M 0 0 V -8.24989 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1038 i56 leaf node n112 p2 sample" transform="translate(1.54 8.24989)"><path class="edge" d="M 0 0 V -8.24989 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.21641 H -2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.49647 H 3.465"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.449793 H 3.2725"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.000848667 H 3.94625"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.791806 H 4.28313"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.726459 H -13.1141"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1452 c2 node n1302 p2" transform="translate(-13.1141 0.99294)"><g class="a1302 c2 node n1197 p2" transform="translate(-5.87125 0.727307)"><g class="a1197 c2 node n977 p2" transform="translate(6.3525 1.34174)"><g class="a977 i58 leaf node n116 p2 sample" transform="translate(2.31 7.86969)"><path class="edge" d="M 0 0 V -7.86969 H -2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a977 c2 node n180 p2" transform="translate(-2.31 6.29796)"><g class="a180 i42 leaf node n84 p2 sample" transform="translate(-1.54 1.57173)"><path class="edge" d="M 0 0 V -1.57173 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a180 i54 leaf node n108 p2 sample" transform="translate(1.54 1.57173)"><path class="edge" d="M 0 0 V -1.57173 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -6.29796 H 2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.34174 H -6.3525"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1197 c2 node n1139 p2" transform="translate(-6.3525 0.375959)"><g class="a1139 i40 leaf node n80 p2 sample" transform="translate(-3.465 8.83547)"><path class="edge" d="M 0 0 V -8.83547 H 3.465"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1139 c2 node n1014 p2" transform="translate(3.465 0.729005)"><g class="a1014 c2 node n628 p2" transform="translate(-2.31 2.79466)"><g class="a628 i41 leaf node n83 p2 sample" transform="translate(-1.54 5.3118)"><path class="edge" d="M 0 0 V -5.3118 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a628 i48 leaf node n96 p2 sample" transform="translate(1.54 5.3118)"><path class="edge" d="M 0 0 V -5.3118 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -2.79466 H 2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1014 i53 leaf node n106 p2 sample" transform="translate(2.31 8.10646)"><path class="edge" d="M 0 0 V -8.10646 H -2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.729005 H -3.465"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.375959 H 6.3525"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.727307 H 5.87125"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1302 i44 leaf node n89 p2 sample" transform="translate(5.87125 9.93874)"><path class="edge" d="M 0 0 V -9.93874 H -5.87125"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.99294 H 13.1141"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.48092 H 20.8923"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1640 c2 node n1605 p2" transform="translate(20.8923 0.280909)"><g class="a1605 c2 node n1523 p2" transform="translate(18.9973 0.627165)"><g class="a1523 c2 node n1442 p2" transform="translate(-17.4453 0.633105)"><g class="a1442 c2 node n1436 p2" transform="translate(-7.84438 0.0424333)"><g class="a1436 c2 node n758 p2" transform="translate(-4.235 4.40797)"><g class="a758 i42 leaf node n85 p2 sample" transform="translate(-1.54 6.42101)"><path class="edge" d="M 0 0 V -6.42101 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a758 i55 leaf node n111 p2 sample" transform="translate(1.54 6.42101)"><path class="edge" d="M 0 0 V -6.42101 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -4.40797 H 4.235"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1436 c2 node n1191 p2" transform="translate(4.235 1.64981)"><g class="a1191 i45 leaf node n90 p2 sample" transform="translate(2.31 9.17918)"><path class="edge" d="M 0 0 V -9.17918 H -2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1191 c2 node n1089 p2" transform="translate(-2.31 0.699301)"><g class="a1089 i43 leaf node n86 p2 sample" transform="translate(-1.54 8.47988)"><path class="edge" d="M 0 0 V -8.47988 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1089 i54 leaf node n109 p2 sample" transform="translate(1.54 8.47988)"><path class="edge" d="M 0 0 V -8.47988 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.699301 H 2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.64981 H -4.235"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.0424333 H 7.84438"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1442 c2 node n1272 p2" transform="translate(7.84437 1.15843)"><g class="a1272 i43 leaf node n87 p2 sample" transform="translate(-6.06375 9.71299)"><path class="edge" d="M 0 0 V -9.71299 H 6.06375"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1272 c2 node n1212 p2" transform="translate(6.06375 0.374262)"><g class="a1212 i59 leaf node n119 p2 sample" transform="translate(3.2725 9.33873)"><path class="edge" d="M 0 0 V -9.33873 H -3.2725"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1212 c2 node n1048 p2" transform="translate(-3.2725 1.04047)"><g class="a1048 c2 node n948 p2" transform="translate(-3.465 0.664506)"><g class="a948 i47 leaf node n94 p2 sample" transform="translate(-2.31 7.63376)"><path class="edge" d="M 0 0 V -7.63376 H 2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a948 c2 node n131 p2" transform="translate(2.31 6.90051)"><g class="a131 i49 leaf node n99 p2 sample" transform="translate(-1.54 0.733248)"><path class="edge" d="M 0 0 V -0.733248 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a131 i58 leaf node n117 p2 sample" transform="translate(1.54 0.733248)"><path class="edge" d="M 0 0 V -0.733248 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -6.90051 H -2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.664506 H 3.465"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1048 i49 leaf node n98 p2 sample" transform="translate(3.465 8.29826)"><path class="edge" d="M 0 0 V -8.29826 H -3.465"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -1.04047 H 3.2725"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.374262 H -6.06375"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.15843 H -7.84437"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.633105 H 17.4453"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1523 c2 node n1267 p2" transform="translate(17.4453 1.83057)"><g class="a1267 c2 node n868 p2" transform="translate(8.47 2.52393)"><g class="a868 i45 leaf node n91 p2 sample" transform="translate(-1.54 7.15002)"><path class="edge" d="M 0 0 V -7.15002 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a868 i55 leaf node n110 p2 sample" transform="translate(1.54 7.15002)"><path class="edge" d="M 0 0 V -7.15002 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -2.52393 H -8.47"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1267 c2 node n1220 p2" transform="translate(-8.47 0.312309)"><g class="a1220 i44 leaf node n88 p2 sample" transform="translate(-6.16 9.36164)"><path class="edge" d="M 0 0 V -9.36164 H 6.16"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1220 c2 node n1195 p2" transform="translate(6.16 0.151063)"><g class="a1195 c2 node n1146 p2" transform="translate(-4.62 0.341164)"><g class="a1146 c2 node n920 p2" transform="translate(3.08 1.43764)"><g class="a920 i52 leaf node n105 p2 sample" transform="translate(-1.54 7.43177)"><path class="edge" d="M 0 0 V -7.43177 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a920 i56 leaf node n113 p2 sample" transform="translate(1.54 7.43177)"><path class="edge" d="M 0 0 V -7.43177 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -1.43764 H -3.08"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1146 c2 node n1079 p2" transform="translate(-3.08 0.427728)"><g class="a1079 i46 leaf node n93 p2 sample" transform="translate(-1.54 8.44169)"><path class="edge" d="M 0 0 V -8.44169 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1079 i52 leaf node n104 p2 sample" transform="translate(1.54 8.44169)"><path class="edge" d="M 0 0 V -8.44169 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -0.427728 H 3.08"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.341164 H 4.62"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><g class="a1195 c2 node n395 p2" transform="translate(4.62 5.69625)"><g class="a395 i50 leaf node n101 p2 sample" transform="translate(-1.54 3.51433)"><path class="edge" d="M 0 0 V -3.51433 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a395 i53 leaf node n107 p2 sample" transform="translate(1.54 3.51433)"><path class="edge" d="M 0 0 V -3.51433 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -5.69625 H -4.62"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.151063 H -6.16"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.312309 H 8.47"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -1.83057 H -17.4453"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.627165 H -18.9973"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><g class="a1605 c2 node n1268 p2" transform="translate(-18.9973 2.44331)"><g class="a1268 i41 leaf node n82 p2 sample" transform="translate(-2.31 9.68838)"><path class="edge" d="M 0 0 V -9.68838 H 2.31"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a1268 c2 node n976 p2" transform="translate(2.31 1.81954)"><g class="a976 i50 leaf node n100 p2 sample" transform="translate(-1.54 7.86884)"><path class="edge" d="M 0 0 V -7.86884 H 1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><g class="a976 i59 leaf node n118 p2 sample" transform="translate(1.54 7.86884)"><path class="edge" d="M 0 0 V -7.86884 H -1.54"></path><rect class="sym" height="1" width="1" x="-0.5" y="-0.5"></rect><text class="lab" transform="translate(0 13.5)"></text></g><path class="edge" d="M 0 0 V -1.81954 H -2.31"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -2.44331 H 18.9973"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><path class="edge" d="M 0 0 V -0.280909 H -20.8923"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab rgt" transform="translate(0.5 -7)"></text></g><path class="edge" d="M 0 0 V -503.044 H 35.2125"></path><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab lft" transform="translate(-0.5 -7)"></text></g><circle class="sym" cx="0" cy="0" r="0.5"></circle><text class="lab" transform="translate(0 -13.5)"></text></g></g></g></svg>
</div>
</div>
<p>There are still a lot of short terminal branches, but clearly the height of the tree increases as we move away from the sweep locus.</p>
</div></section>
<section id="haplotype-gnns" class="level2">
<h2 class="anchored" data-anchor-id="haplotype-gnns">Haplotype GNNs</h2>
<p>We conclude this session by showing how one can <a href="https://www.nature.com/articles/s41588-019-0483-y/figures/4">plot GNN proportions for individuals or .across chromosomes</a>. This visualization can be useful to highlight cases of introgression or admixture, in which case chromosomes show up having segments with vastly different GNN proportions and therefore coloring composition.</p>
<p>We begin with calculating GNN proportions across all individuals. This is trivial. We simply need to list samples grouped by population, which then constitutes our samples set to pass to <code>ts.genealogical_nearest_neighbours</code>.</p>
<div id="6870fa2b" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>samples_listed_by_group <span class="op">=</span> [ts.samples(population<span class="op">=</span>pop_id) <span class="cf">for</span> pop_id <span class="kw">in</span> <span class="bu">range</span>(ts.num_populations)]</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>gnn <span class="op">=</span> ts.genealogical_nearest_neighbours(ts.samples(), samples_listed_by_group)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We plot the GNN proportions as stacked bar charts.</p>
<div id="c9130132" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">2</span>))</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>nhap <span class="op">=</span> gnn.shape[<span class="dv">0</span>]</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>xlab <span class="op">=</span> np.arange(nhap).astype(np.float64)  <span class="co"># Define x labels</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>bottom <span class="op">=</span> np.zeros(nhap)  <span class="co"># Keep track of the "bottom" coordinate</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> popid <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> gnn[:, popid]</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> ax.bar(x<span class="op">=</span>xlab, height<span class="op">=</span>y, label<span class="op">=</span>popmd[popid][<span class="st">"name"</span>], bottom<span class="op">=</span>bottom, color<span class="op">=</span>popmd[popid][<span class="st">"mpl_color"</span>])</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    bottom <span class="op">+=</span> y</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"Sample id (haplotype)"</span>)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"GNN proportion"</span>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"GNN proportions for all sample haplotypes"</span>)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>ax.legend(loc<span class="op">=</span><span class="st">"upper right"</span>)</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="stdpopsim_lab_II_files/figure-html/cell-28-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="stdpopsim_lab_II_files/figure-html/cell-28-output-1.png" width="1184" height="228" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>Take some time to look at the figure to make sure you understand what each bar represents and how the relate to the different populations.</p>
<p>Next, we plot the haplotypes of an individual (recall that the x axis above refers to <em>haplotypes</em>). The GNN proportions will be calculated in windows, so we decide on a the width of chromosome segments to plot; increase the number of windows for higher resolution.</p>
<div id="72fb0c1e" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Setup windows</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">500</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>windows <span class="op">=</span> np.linspace(start<span class="op">=</span><span class="fl">0.0</span>, stop<span class="op">=</span>ts.sequence_length, num<span class="op">=</span>n)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>window_size <span class="op">=</span> windows[<span class="dv">1</span>] <span class="op">-</span> windows[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Thereafter, we pick a focal individual, arbitrarily choosing <code>id=3</code>:</p>
<p>Individual 3 has two chromosomes encoded by nodes 6 and 7. The <code>workshop.haplotype_gnn</code> is a function that traverses the tree sequence along the genome and calculates the GNN proportions for each tree, binning the results in our pre-defined windows, for both chromosomes, returning the result as a Pandas DataFrame.</p>
<div id="cac3feef" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>focal_ind <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> workshop.haplotype_gnn(ts, focal_ind, windows, sample_sets[<span class="dv">0</span>:<span class="dv">3</span>])</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>df.columns <span class="op">=</span> [popmd[i][<span class="st">"name"</span>] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>)]</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>df.head() <span class="co"># Print the first lines of the table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">western</th>
<th data-quarto-table-cell-role="th">central</th>
<th data-quarto-table-cell-role="th">bonobo</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">haplotype</th>
<th data-quarto-table-cell-role="th">start</th>
<th data-quarto-table-cell-role="th">end</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="5" data-quarto-table-cell-role="th" data-valign="top">0</td>
<td data-quarto-table-cell-role="th">0.000000</td>
<td data-quarto-table-cell-role="th">20040.080160</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">20040.080160</td>
<td data-quarto-table-cell-role="th">40080.160321</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">40080.160321</td>
<td data-quarto-table-cell-role="th">60120.240481</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">60120.240481</td>
<td data-quarto-table-cell-role="th">80160.320641</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">80160.320641</td>
<td data-quarto-table-cell-role="th">100200.400802</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The <code>haplotype</code> index is either <code>0</code> or <code>1</code>, indicating the two haplotypes. We plot the haplotypes:</p>
<div id="27b0a5e6" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">2</span>), sharex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> hap, index <span class="kw">in</span> <span class="bu">zip</span>([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">211</span>, <span class="dv">212</span>]):</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> plt.subplot(index)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> df[df.index.get_level_values(<span class="st">"haplotype"</span>) <span class="op">==</span> hap]</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    bottom <span class="op">=</span> np.zeros(data.shape[<span class="dv">0</span>])</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(data.columns)):</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>        p <span class="op">=</span> ax.bar(data.index.get_level_values(<span class="st">"start"</span>),</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>                   data[popmd[i][<span class="st">"name"</span>]], width<span class="op">=</span>window_size,</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>                   label<span class="op">=</span>popmd[i][<span class="st">"name"</span>], bottom<span class="op">=</span>bottom,</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>                   color<span class="op">=</span>popmd[i][<span class="st">"mpl_color"</span>])</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>        bottom <span class="op">+=</span> data[popmd[i][<span class="st">"name"</span>]]</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    ax2 <span class="op">=</span> ax.twinx()</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    ax2.set_ylabel(<span class="ss">f"Hap </span><span class="sc">{</span>hap<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>    plt.suptitle(</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"GNN plot for focal individual </span><span class="sc">{</span>focal_ind<span class="sc">}</span><span class="ss">, "</span> <span class="op">+</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"</span><span class="sc">{</span>ts<span class="sc">.</span>population(ts.individuals_population[focal_ind])<span class="sc">.</span>metadata[<span class="st">'name'</span>]<span class="sc">}</span><span class="ss">"</span> <span class="op">+</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">"population"</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Genome position (bp)"</span>)</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="stdpopsim_lab_II_files/figure-html/cell-31-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="stdpopsim_lab_II_files/figure-html/cell-31-output-1.png" width="1215" height="226" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<dl class="exercise">
<dt>
Exercise 3.
</dt>
<dd>
Plot some haplotype GNNs from other individuals and populations..
</dd>
</dl>
<div id="3b406230" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the focal individual and rerun</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>focal_ind <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> workshop.haplotype_gnn(ts, focal_ind, windows, sample_sets[<span class="dv">0</span>:<span class="dv">3</span>])</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>df.columns <span class="op">=</span> [popmd[i][<span class="st">"name"</span>] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>)]</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">2</span>), sharex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> hap, index <span class="kw">in</span> <span class="bu">zip</span>([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">211</span>, <span class="dv">212</span>]):</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> plt.subplot(index)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> df[df.index.get_level_values(<span class="st">"haplotype"</span>) <span class="op">==</span> hap]</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    bottom <span class="op">=</span> np.zeros(data.shape[<span class="dv">0</span>])</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(data.columns)):</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>        p <span class="op">=</span> ax.bar(data.index.get_level_values(<span class="st">"start"</span>),</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>                   data[popmd[i][<span class="st">"name"</span>]], width<span class="op">=</span>window_size,</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>                   label<span class="op">=</span>popmd[i][<span class="st">"name"</span>], bottom<span class="op">=</span>bottom,</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>                   color<span class="op">=</span>popmd[i][<span class="st">"mpl_color"</span>])</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>        bottom <span class="op">+=</span> data[popmd[i][<span class="st">"name"</span>]]</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>    ax2 <span class="op">=</span> ax.twinx()</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>    ax2.set_ylabel(<span class="ss">f"Hap </span><span class="sc">{</span>hap<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>plt.suptitle(</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"GNN plot for focal individual </span><span class="sc">{</span>focal_ind<span class="sc">}</span><span class="ss">, "</span> <span class="op">+</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"{ts.population(ts.individuals_population[focal_ind]).metadata['name']} "</span> <span class="op">+</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"population"</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Genome position (bp)"</span>)</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="stdpopsim_lab_II_files/figure-html/cell-32-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="stdpopsim_lab_II_files/figure-html/cell-32-output-1.png" width="1215" height="226" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/NBISweden\.github\.io\/workshop-pgip-H25\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>2025 <a href="https://nbis.se">NBIS</a> | <a href="https://choosealicense.com/licenses/gpl-3.0/">GPL-3 License</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Published with <a href="https://quarto.org/">Quarto</a> v<!--?quarto.version?--></p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>